[{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\prisma\\seed.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\LandingPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":5,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[122,139],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Github' is defined but never used.","line":6,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":53,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Github"},"fix":{"range":[209,217],"text":""},"desc":"Remove unused variable \"Github\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Info' is defined but never used.","line":6,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":59,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Info"},"fix":{"range":[217,223],"text":""},"desc":"Remove unused variable \"Info\"."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":174,"column":36,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[8013,8070],"text":"\r\n                                Don&apos;t have an account? "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[8013,8070],"text":"\r\n                                Don&lsquo;t have an account? "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[8013,8070],"text":"\r\n                                Don&#39;t have an account? "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[8013,8070],"text":"\r\n                                Don&rsquo;t have an account? "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport styles from './LandingPage.module.css';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { Smartphone, ShieldCheck, Zap, Globe, Github, Info } from 'lucide-react';\r\n\r\ninterface LandingPageProps {\r\n    onLogin: () => void;\r\n}\r\n\r\nconst LandingPage: React.FC<LandingPageProps> = ({ onLogin }) => {\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    const handleLogin = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setIsLoading(true);\r\n        // Simulate loading\r\n        setTimeout(() => {\r\n            onLogin();\r\n            setIsLoading(false);\r\n        }, 1200);\r\n    };\r\n\r\n    const features = [\r\n        { icon: Smartphone, text: 'Mobile Ready' },\r\n        { icon: ShieldCheck, text: 'Secure Access' },\r\n        { icon: Zap, text: 'Ultra Fast' },\r\n        { icon: Globe, text: 'Global Reach' },\r\n    ];\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <div className={styles.background}>\r\n                <motion.div\r\n                    className={styles.blob}\r\n                    animate={{\r\n                        scale: [1, 1.2, 1],\r\n                        x: [0, 50, 0],\r\n                        y: [0, 30, 0],\r\n                    }}\r\n                    transition={{ duration: 15, repeat: Infinity, ease: \"linear\" }}\r\n                />\r\n                <motion.div\r\n                    className={`${styles.blob} ${styles.blob2}`}\r\n                    animate={{\r\n                        scale: [1.2, 1, 1.2],\r\n                        x: [0, -70, 0],\r\n                        y: [0, -50, 0],\r\n                    }}\r\n                    transition={{ duration: 20, repeat: Infinity, ease: \"linear\" }}\r\n                />\r\n                <motion.div\r\n                    className={`${styles.blob} ${styles.blob3}`}\r\n                    animate={{\r\n                        scale: [1, 1.5, 1],\r\n                        x: [0, 100, 0],\r\n                        y: [0, 100, 0],\r\n                    }}\r\n                    transition={{ duration: 25, repeat: Infinity, ease: \"linear\" }}\r\n                />\r\n            </div>\r\n\r\n            <motion.div\r\n                className={styles.content}\r\n                initial={{ opacity: 0, scale: 0.9 }}\r\n                animate={{ opacity: 1, scale: 1 }}\r\n                transition={{ duration: 0.8, ease: [0.16, 1, 0.3, 1] }}\r\n            >\r\n                <div className={styles.gridContainer}>\r\n                    {/* Left Side: Info */}\r\n                    <div className={styles.infoSection}>\r\n                        <div className={styles.logoArea}>\r\n                            <motion.div\r\n                                className={styles.logoSquare}\r\n                                whileHover={{ scale: 1.05, rotate: 5 }}\r\n                                whileTap={{ scale: 0.95 }}\r\n                            >\r\n                                V\r\n                            </motion.div>\r\n                            <h1 className={styles.appName}>Viewer</h1>\r\n                        </div>\r\n\r\n                        <h2 className={styles.heroTitle}>\r\n                            Experience social media like <span className={styles.gradientText}>never before</span>.\r\n                        </h2>\r\n                        <p className={styles.heroSubtitle}>\r\n                            A premium platform for creators, explorers, and visionaries. Join a community that values quality and connection.\r\n                        </p>\r\n\r\n                        <div className={styles.featureGrid}>\r\n                            {features.map((f, i) => (\r\n                                <motion.div\r\n                                    key={i}\r\n                                    className={styles.featureItem}\r\n                                    initial={{ opacity: 0, x: -20 }}\r\n                                    animate={{ opacity: 1, x: 0 }}\r\n                                    transition={{ delay: 0.4 + (i * 0.1) }}\r\n                                >\r\n                                    <f.icon size={20} className={styles.featureIcon} />\r\n                                    <span>{f.text}</span>\r\n                                </motion.div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Right Side: Login Card */}\r\n                    <div className={styles.loginSection}>\r\n                        <div className={styles.loginCard}>\r\n                            <div className={styles.cardHeader}>\r\n                                <h3 className={styles.title}>Welcome Back</h3>\r\n                                <p className={styles.subtitle}>Enter your details to access your account</p>\r\n                            </div>\r\n\r\n                            <form className={styles.loginForm} onSubmit={handleLogin}>\r\n                                <div className={styles.inputGroup}>\r\n                                    <label className={styles.label}>Email Address</label>\r\n                                    <input\r\n                                        type=\"email\"\r\n                                        className={styles.input}\r\n                                        placeholder=\"name@example.com\"\r\n                                        value={email}\r\n                                        onChange={(e) => setEmail(e.target.value)}\r\n                                        required\r\n                                    />\r\n                                </div>\r\n\r\n                                <div className={styles.inputGroup}>\r\n                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n                                        <label className={styles.label}>Password</label>\r\n                                        <a href=\"#\" className={styles.forgotLink}>Forgot?</a>\r\n                                    </div>\r\n                                    <input\r\n                                        type=\"password\"\r\n                                        className={styles.input}\r\n                                        placeholder=\"ΓÇóΓÇóΓÇóΓÇóΓÇóΓÇóΓÇóΓÇó\"\r\n                                        value={password}\r\n                                        onChange={(e) => setPassword(e.target.value)}\r\n                                        required\r\n                                    />\r\n                                </div>\r\n\r\n                                <button\r\n                                    type=\"submit\"\r\n                                    className={`${styles.loginBtn} ${isLoading ? styles.loading : ''}`}\r\n                                    disabled={isLoading}\r\n                                >\r\n                                    {isLoading ? (\r\n                                        <div className={styles.spinner}></div>\r\n                                    ) : 'Sign In'}\r\n                                </button>\r\n                            </form>\r\n\r\n                            <div className={styles.divider}>\r\n                                <span>OR</span>\r\n                            </div>\r\n\r\n                            <div className={styles.alternativeActions}>\r\n                                <button\r\n                                    className={styles.guestBtn}\r\n                                    onClick={() => {\r\n                                        setIsLoading(true);\r\n                                        setTimeout(onLogin, 1000);\r\n                                    }}\r\n                                    disabled={isLoading}\r\n                                >\r\n                                    Login as Guest\r\n                                </button>\r\n                            </div>\r\n\r\n                            <p className={styles.signupText}>\r\n                                Don't have an account? <a href=\"#\" className={styles.link}>Sign Up</a>\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={styles.footer}>\r\n                    <div className={styles.footerLinks}>\r\n                        <a href=\"#\">About</a>\r\n                        <a href=\"#\">Privacy</a>\r\n                        <a href=\"#\">Terms</a>\r\n                        <a href=\"#\">Help</a>\r\n                    </div>\r\n                    <p className={styles.copyright}>&copy; 2026 Viewer by ASTER. <a href=\"/LICENSE\" className={styles.licenseLink}>MIT Licensed</a>. Designed for the future.</p>\r\n                </div>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default LandingPage;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\actions.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'fs' is defined but never used.","line":6,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":10,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"fs"},"fix":{"range":[200,222],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'path' is defined but never used.","line":7,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"path"},"fix":{"range":[222,248],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'uploadToS3' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":20,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"uploadToS3"},"fix":{"range":[296,336],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"prefer-const","severity":2,"message":"'imageString' is never reassigned. Use 'const' instead.","line":15,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":15,"endColumn":20,"fix":{"range":[567,607],"text":"const imageString = media0 || directImage;"}},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'filter' is assigned a value but never used.","line":17,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":1,"fixableWarningCount":0,"source":"'use server';\r\n\r\nimport prisma from '@/lib/prisma';\r\nimport { revalidatePath } from 'next/cache'; import { MediaService } from '@/lib/media-service';\r\nimport { sendNotification } from '@/lib/queue';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { invalidateCache } from '@/lib/redis';\r\nimport { uploadToS3 } from '@/lib/s3';\r\n\r\nexport async function createPost(formData: FormData) {\r\n    const caption = formData.get('caption') as string;\r\n    const media0 = formData.get('media-0') as string;\r\n    const directImage = formData.get('image') as string;\r\n    let imageString = media0 || directImage;\r\n    const location = formData.get('location') as string || '';\r\n    const filter = formData.get('filter') as string || 'none';\r\n\r\n    if (!imageString) {\r\n        throw new Error('At least one image is required');\r\n    }\r\n\r\n    try {\r\n        // Find existing user (ideally this should be from auth)\r\n        // We prioritize 'antigravity_dev' if it exists, otherwise any user\r\n        let user = await prisma.user.findFirst({\r\n            where: { username: 'antigravity_dev' }\r\n        });\r\n\r\n        if (!user) {\r\n            user = await prisma.user.findFirst();\r\n        }\r\n\r\n        if (!user) {\r\n            // Fallback to create if no user at all (first run scenario)\r\n            user = await prisma.user.create({\r\n                data: {\r\n                    username: 'demo_user',\r\n                    fullName: 'Demo User',\r\n                    avatar: 'https://i.pravatar.cc/150?u=demo',\r\n                    email: 'demo@example.com',\r\n                    password: 'password123'\r\n                }\r\n            });\r\n        }\r\n\r\n\r\n\r\n        // ... (keep surrounding code)\r\n\r\n        let finalMediaUrl = imageString;\r\n        let isVideo = false;\r\n\r\n        // Process Upload (S3 or Local) via Media Service\r\n        if (imageString.startsWith('data:')) {\r\n            try {\r\n                const uploadResult = await MediaService.processAndUpload(imageString);\r\n                finalMediaUrl = uploadResult.url;\r\n                isVideo = uploadResult.type === 'video';\r\n            } catch (err) {\r\n                console.error('Media upload failed:', err);\r\n                // Fallback: keep original base64 if upload fails (though MediaService errs on invalid base64)\r\n                isVideo = imageString.startsWith('data:video/');\r\n            }\r\n        } else {\r\n            // Handle case where it might be a direct URL already\r\n            isVideo = imageString.endsWith('.mp4') || imageString.endsWith('.webm');\r\n        }\r\n\r\n        if (isVideo) {\r\n            await prisma.shot.create({\r\n                data: {\r\n                    video: finalMediaUrl,\r\n                    caption: caption + (location ? ` ΓÇó ${location}` : ''),\r\n                    userId: user.id,\r\n                    music: 'Original Audio',\r\n                    location: location || undefined\r\n                }\r\n            });\r\n            revalidatePath('/shots');\r\n        } else {\r\n            await prisma.post.create({\r\n                data: {\r\n                    caption: caption + (location ? ` ΓÇó ${location}` : ''),\r\n                    image: finalMediaUrl,\r\n                    userId: user.id,\r\n                    location: location || undefined\r\n                },\r\n            });\r\n            await invalidateCache('feed:suggested_pool*');\r\n            revalidatePath('/');\r\n        }\r\n\r\n        revalidatePath('/profile');\r\n    } catch (error) {\r\n        console.error('Server Action Error:', error);\r\n        throw new Error('Failed to create content: ' + (error as Error).message);\r\n    }\r\n}\r\n\r\nexport async function toggleLike(postId: string) {\r\n    const user = await prisma.user.findFirst();\r\n    if (!user) throw new Error('No user found');\r\n\r\n    const existingLike = await prisma.like.findUnique({\r\n        where: {\r\n            userId_postId: {\r\n                userId: user.id,\r\n                postId: postId,\r\n            },\r\n        },\r\n    });\r\n\r\n    if (existingLike) {\r\n        await prisma.like.delete({\r\n            where: { id: existingLike.id },\r\n        });\r\n    } else {\r\n        await prisma.like.create({\r\n            data: {\r\n                userId: user.id,\r\n                postId: postId,\r\n            },\r\n        });\r\n\r\n        // Notify Author\r\n        const post = await prisma.post.findUnique({\r\n            where: { id: postId },\r\n            select: { userId: true }\r\n        });\r\n\r\n        if (post && post.userId !== user.id) {\r\n            await sendNotification(post.userId, 'like', {\r\n                postId,\r\n                actorId: user.id,\r\n                actorName: user.username || 'User'\r\n            });\r\n        }\r\n    }\r\n\r\n    await invalidateCache('feed:suggested_pool*');\r\n    revalidatePath('/');\r\n}\r\n\r\nexport async function toggleShotLike(shotId: string) {\r\n    const user = await prisma.user.findFirst();\r\n    if (!user) throw new Error('No user found');\r\n\r\n    const existingLike = await prisma.shotLike.findUnique({\r\n        where: {\r\n            userId_shotId: {\r\n                userId: user.id,\r\n                shotId: shotId,\r\n            },\r\n        },\r\n    });\r\n\r\n    if (existingLike) {\r\n        await prisma.shotLike.delete({\r\n            where: { id: existingLike.id },\r\n        });\r\n    } else {\r\n        await prisma.shotLike.create({\r\n            data: {\r\n                userId: user.id,\r\n                shotId: shotId,\r\n            },\r\n        });\r\n    }\r\n\r\n    revalidatePath('/shots');\r\n}\r\n\r\nexport async function addComment(postId: string, text: string) {\r\n    const user = await prisma.user.findFirst();\r\n    if (!user) throw new Error('No user found');\r\n\r\n    await prisma.comment.create({\r\n        data: {\r\n            text,\r\n            userId: user.id,\r\n            postId\r\n        }\r\n    });\r\n\r\n    await invalidateCache('feed:suggested_pool*');\r\n    revalidatePath('/');\r\n}\r\n\r\nexport async function addShotComment(shotId: string, text: string) {\r\n    const user = await prisma.user.findFirst();\r\n    if (!user) throw new Error('No user found');\r\n\r\n    await prisma.shotComment.create({\r\n        data: {\r\n            text,\r\n            userId: user.id,\r\n            shotId\r\n        }\r\n    });\r\n\r\n    revalidatePath('/shots');\r\n}\r\n\r\nexport async function toggleSavedPost(postId: string) {\r\n    const user = await prisma.user.findFirst();\r\n    if (!user) throw new Error('No user found');\r\n\r\n    const existingSave = await prisma.savedPost.findUnique({\r\n        where: {\r\n            userId_postId: {\r\n                userId: user.id,\r\n                postId\r\n            }\r\n        }\r\n    });\r\n\r\n    if (existingSave) {\r\n        await prisma.savedPost.delete({\r\n            where: { id: existingSave.id }\r\n        });\r\n    } else {\r\n        await prisma.savedPost.create({\r\n            data: {\r\n                userId: user.id,\r\n                postId\r\n            }\r\n        });\r\n    }\r\n\r\n    // Not strictly necessary for suggested feed rank, but good practice\r\n    revalidatePath('/');\r\n    revalidatePath('/saved');\r\n}\r\n\r\nexport async function toggleSavedShot(shotId: string) {\r\n    const user = await prisma.user.findFirst();\r\n    if (!user) throw new Error('No user found');\r\n\r\n    const existingSave = await prisma.savedShot.findUnique({\r\n        where: {\r\n            userId_shotId: {\r\n                userId: user.id,\r\n                shotId\r\n            }\r\n        }\r\n    });\r\n\r\n    if (existingSave) {\r\n        await prisma.savedShot.delete({\r\n            where: { id: existingSave.id }\r\n        });\r\n    } else {\r\n        await prisma.savedShot.create({\r\n            data: {\r\n                userId: user.id,\r\n                shotId\r\n            }\r\n        });\r\n    }\r\n\r\n    revalidatePath('/shots');\r\n    revalidatePath('/saved');\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\api\\auth\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":38,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport prisma from '@/lib/prisma';\r\nimport { cookies } from 'next/headers';\r\n\r\n// Mock Authentication - In a real app, use NextAuth or similar\r\n// This simulates logging in as the main dev user or creating it if missing\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const { username } = await req.json();\r\n\r\n        // Find or Create user\r\n        let user = await prisma.user.findUnique({\r\n            where: { username }\r\n        });\r\n\r\n        if (!user && username === 'antigravity_dev') {\r\n            user = await prisma.user.create({\r\n                data: {\r\n                    username: 'antigravity_dev',\r\n                    email: 'dev@antigravity.com',\r\n                    password: 'mock_password_hash', // In real app, hash this!\r\n                    fullName: 'Antigravity Developer',\r\n                    avatar: 'https://i.pravatar.cc/150?u=antigravity',\r\n                    bio: 'Building the next gen social app.',\r\n                    isVerified: true\r\n                }\r\n            });\r\n        }\r\n\r\n        if (!user) {\r\n            return NextResponse.json({ error: 'User not found' }, { status: 404 });\r\n        }\r\n\r\n        // Set a simple cookie session (Insecure for prod, fine for MVP demo)\r\n        (await cookies()).set('userId', user.id, { httpOnly: true });\r\n\r\n        return NextResponse.json({ success: true, user });\r\n    } catch (error) {\r\n        return NextResponse.json({ error: 'Login failed' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function GET() {\r\n    const cookieStore = await cookies();\r\n    const userId = cookieStore.get('userId')?.value;\r\n\r\n    if (!userId) {\r\n        return NextResponse.json({ authenticated: false }, { status: 401 });\r\n    }\r\n\r\n    const user = await prisma.user.findUnique({\r\n        where: { id: userId },\r\n        select: {\r\n            id: true,\r\n            username: true,\r\n            avatar: true,\r\n            fullName: true,\r\n            email: true\r\n        }\r\n    });\r\n\r\n    if (!user) {\r\n        return NextResponse.json({ authenticated: false }, { status: 401 });\r\n    }\r\n\r\n    return NextResponse.json({ authenticated: true, user });\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\api\\cron\\feed-precompute\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'authHeader' is assigned a value but never used.","line":10,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport prisma from '@/lib/prisma';\r\nimport { FeedService } from '@/lib/feed-service';\r\n\r\nexport const dynamic = 'force-dynamic';\r\n\r\nexport async function GET(request: Request) {\r\n    try {\r\n        // Authenticate the cron request (in prod using a secret key)\r\n        const authHeader = request.headers.get('Authorization');\r\n        // Simple check: if needed, compare with CRON_SECRET env\r\n        // if (authHeader !== `Bearer ${process.env.CRON_SECRET}`) ...\r\n\r\n        // 1. Identify \"Active Users\"\r\n        // Algorithm: Users who have logged in recently, or posted recently.\r\n        // For simplicity: Users who have posted or liked in the last 24 hours.\r\n        // OR just all users for this demo if small user base.\r\n\r\n        const oneDayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);\r\n\r\n        const activeUsers = await prisma.user.findMany({\r\n            where: {\r\n                OR: [\r\n                    { posts: { some: { createdAt: { gte: oneDayAgo } } } },\r\n                    { likes: { some: { createdAt: { gte: oneDayAgo } } } },\r\n                    // Or simply recent logins if tracked\r\n                    { username: 'antigravity_dev' } // Always include the dev\r\n                ]\r\n            },\r\n            select: { id: true, username: true }\r\n        });\r\n\r\n        // 2. Pre-compute feeds\r\n        // Run in parallel but limited concurrency if large\r\n        const results = await Promise.all(\r\n            activeUsers.map(async (user) => {\r\n                try {\r\n                    await FeedService.precomputeFeed(user.id);\r\n                    return { userId: user.id, status: 'success' };\r\n                } catch (e) {\r\n                    return { userId: user.id, status: 'failed', error: String(e) };\r\n                }\r\n            })\r\n        );\r\n\r\n        return NextResponse.json({\r\n            message: 'Feed pre-computation complete',\r\n            processed: results.length,\r\n            details: results\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('Cron Job Failed:', error);\r\n        return NextResponse.json({ error: 'Internal Server Error' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\api\\explore\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1806,1809],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1806,1809],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":57,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2107,2110],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2107,2110],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport prisma from '@/lib/prisma';\r\n\r\nexport async function GET() {\r\n    try {\r\n        // 1. Identify current user (Simulated)\r\n        const currentUser = await prisma.user.findFirst({\r\n            include: { following: true }\r\n        });\r\n\r\n        let excludeUserIds: string[] = [];\r\n        if (currentUser) {\r\n            excludeUserIds = [currentUser.id, ...currentUser.following.map(f => f.followingId)];\r\n        }\r\n\r\n        // 2. Fetch Explore Content (Posts from people you don't follow)\r\n        // Order by raw engagement (likes count)\r\n        const posts = await prisma.post.findMany({\r\n            where: {\r\n                userId: { notIn: excludeUserIds }\r\n            },\r\n            include: {\r\n                user: {\r\n                    select: {\r\n                        username: true,\r\n                        avatar: true,\r\n                        fullName: true,\r\n                    }\r\n                },\r\n                likes: true,\r\n                comments: {\r\n                    include: {\r\n                        user: {\r\n                            select: {\r\n                                username: true,\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n            },\r\n            // In a real scenario with thousands of posts, we'd use raw SQL for efficient sorting by relation count.\r\n            // For now, we fetch a larger set and sort in memory.\r\n            take: 100,\r\n            orderBy: {\r\n                createdAt: 'desc' // Only as a primary filter to get recent-ish content\r\n            }\r\n        });\r\n\r\n        // 3. Ranking Algorithm for Explore\r\n        // Focus on pure engagement velocity (Viral content)\r\n        const scoreContent = (post: any) => {\r\n            const now = new Date().getTime();\r\n            const created = new Date(post.createdAt).getTime();\r\n            const hoursAgo = Math.max(0.1, (now - created) / (1000 * 60 * 60));\r\n\r\n            // Engagement Score\r\n            const distinctLikers = new Set(post.likes.map((l: any) => l.userId)).size;\r\n            const engagement = (distinctLikers * 1) + (post.comments.length * 2);\r\n\r\n            // Explore favors highly engaging content regardless of age significantly more than Feed\r\n            // But we still want fresh content.\r\n            // Formula: Engagement^1.2 / (Time + 1)^1.0\r\n            return Math.pow(engagement + 1, 1.2) / Math.pow(hoursAgo + 1, 1.0);\r\n        };\r\n\r\n        // Sort and select top items\r\n        const rankedPosts = posts\r\n            .map(p => ({ ...p, score: scoreContent(p) }))\r\n            .sort((a, b) => b.score - a.score);\r\n\r\n        return NextResponse.json(rankedPosts);\r\n    } catch (error) {\r\n        console.error('API Error (GET /api/explore):', error);\r\n        return NextResponse.json({ error: 'Failed to fetch explore content' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\api\\posts\\[id]\\like\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\api\\posts\\[id]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\api\\posts\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\api\\profile\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\api\\shots\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":38,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":68,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":68,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server';\r\nimport prisma from '@/lib/prisma';\r\n\r\nexport async function GET(request: Request) {\r\n    try {\r\n        const { searchParams } = new URL(request.url);\r\n        const page = parseInt(searchParams.get('page') || '1');\r\n        const limit = parseInt(searchParams.get('limit') || '10');\r\n        const skip = (page - 1) * limit;\r\n\r\n        const shots = await prisma.shot.findMany({\r\n            include: {\r\n                user: {\r\n                    select: {\r\n                        username: true,\r\n                        avatar: true,\r\n                    }\r\n                },\r\n                likes: true,\r\n                comments: {\r\n                    include: {\r\n                        user: {\r\n                            select: {\r\n                                username: true,\r\n                                avatar: true,\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n            },\r\n            orderBy: {\r\n                createdAt: 'desc',\r\n            },\r\n            skip,\r\n            take: limit\r\n        });\r\n        return NextResponse.json(shots);\r\n    } catch (error) {\r\n        return NextResponse.json({ error: 'Failed to fetch shots' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const body = await request.json();\r\n        const { video, caption, userId } = body;\r\n\r\n        if (!video) {\r\n            return NextResponse.json({ error: 'Video URL is required' }, { status: 400 });\r\n        }\r\n\r\n        let targetUserId = userId;\r\n        if (!targetUserId) {\r\n            const user = await prisma.user.findFirst();\r\n            if (!user) return NextResponse.json({ error: 'User required' }, { status: 400 });\r\n            targetUserId = user.id;\r\n        }\r\n\r\n        const shot = await prisma.shot.create({\r\n            data: {\r\n                video,\r\n                caption,\r\n                userId: targetUserId,\r\n            }\r\n        });\r\n\r\n        return NextResponse.json(shot, { status: 201 });\r\n    } catch (error) {\r\n        return NextResponse.json({ error: 'Failed to create shot' }, { status: 500 });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\api\\status\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\api\\stories\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\api\\users\\me\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\api\\users\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\create\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ImageIcon' is defined but never used.","line":4,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":28,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ImageIcon"},"fix":{"range":[96,115],"text":""},"desc":"Remove unused variable \"ImageIcon\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1523,1526],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1523,1526],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":189,"column":41,"nodeType":"JSXOpeningElement","endLine":194,"endColumn":43},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":242,"column":41,"nodeType":"JSXOpeningElement","endLine":242,"endColumn":139},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":317,"column":57,"nodeType":"JSXOpeningElement","endLine":321,"endColumn":59}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useTransition, useCallback } from 'react';\r\nimport { Image as ImageIcon, X, Upload, Sparkles, MapPin, Smile, ChevronDown, ChevronLeft } from 'lucide-react';\r\nimport styles from './create.module.css';\r\nimport { useRouter } from 'next/navigation';\r\nimport { createPost } from '@/app/actions';\r\n// import { MOCK_USERS } from '@/lib/mockData';\r\n\r\nconst FILTERS = [\r\n    { name: 'Normal', value: 'none' },\r\n    { name: 'Clarendon', value: 'contrast(1.2) saturate(1.3)' },\r\n    { name: 'Gingham', value: 'brightness(1.1) contrast(0.9)' },\r\n    { name: 'Moon', value: 'grayscale(1) contrast(1.1)' },\r\n    { name: 'Lark', value: 'brightness(1.1) contrast(1.1) saturate(1.1)' },\r\n    { name: 'Reyes', value: 'sepia(0.2) brightness(1.1) contrast(0.8)' },\r\n];\r\n\r\nconst CreatePostPage = () => {\r\n    const [mediaItems, setMediaItems] = useState<{ url: string; type: 'image' | 'video' }[]>([]);\r\n    const [currentMediaIndex, setCurrentMediaIndex] = useState(0);\r\n    const [caption, setCaption] = useState('');\r\n    const [activeFilter, setActiveFilter] = useState(FILTERS[0]);\r\n    const [location, setLocation] = useState('');\r\n    const [isPending, startTransition] = useTransition();\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [isGeneratingCaption, setIsGeneratingCaption] = useState(false);\r\n    const [isEnhancing, setIsEnhancing] = useState(false);\r\n    const [isEnhanced, setIsEnhanced] = useState(false);\r\n    const [currentUser, setCurrentUser] = useState<any>(null);\r\n    const router = useRouter();\r\n\r\n    React.useEffect(() => {\r\n        const fetchMe = async () => {\r\n            try {\r\n                const res = await fetch('/api/users/me');\r\n                if (res.ok) {\r\n                    const data = await res.json();\r\n                    setCurrentUser(data);\r\n                }\r\n            } catch (err) {\r\n                console.error('Failed to fetch user', err);\r\n            }\r\n        };\r\n        fetchMe();\r\n    }, []);\r\n\r\n    // ... existing handlers ...\r\n\r\n    const handleAIEnhance = () => {\r\n        setIsEnhancing(true);\r\n        // Simulate AI processing\r\n        setTimeout(() => {\r\n            setIsEnhancing(false);\r\n            setIsEnhanced(!isEnhanced); // Toggle enhance\r\n        }, 2000);\r\n    };\r\n\r\n    const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const files = Array.from(e.target.files || []);\r\n        if (files.length > 0) {\r\n            files.forEach(file => {\r\n                const reader = new FileReader();\r\n                const type: 'image' | 'video' = file.type.startsWith('video/') ? 'video' : 'image';\r\n                reader.onload = (e) => {\r\n                    setMediaItems(prev => [...prev, { url: e.target?.result as string, type }]);\r\n                };\r\n                reader.readAsDataURL(file);\r\n            });\r\n        }\r\n    };\r\n\r\n    const handleDrop = useCallback((e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        setIsDragging(false);\r\n        const files = Array.from(e.dataTransfer.files || []);\r\n        if (files.length > 0) {\r\n            files.forEach(file => {\r\n                if (file.type.startsWith('image/') || file.type.startsWith('video/')) {\r\n                    const type: 'image' | 'video' = file.type.startsWith('video/') ? 'video' : 'image';\r\n                    const reader = new FileReader();\r\n                    reader.onload = (e) => {\r\n                        setMediaItems(prev => [...prev, { url: e.target?.result as string, type }]);\r\n                    };\r\n                    reader.readAsDataURL(file);\r\n                }\r\n            });\r\n        }\r\n    }, []);\r\n\r\n    const handleDragOver = useCallback((e: React.DragEvent) => {\r\n        e.preventDefault();\r\n        setIsDragging(true);\r\n    }, []);\r\n\r\n    const handleDragLeave = useCallback(() => {\r\n        setIsDragging(false);\r\n    }, []);\r\n\r\n    const handleShare = async () => {\r\n        if (mediaItems.length === 0) return;\r\n\r\n        startTransition(async () => {\r\n            const formData = new FormData();\r\n            formData.append('caption', caption);\r\n            mediaItems.forEach((item, i) => formData.append(`media-${i}`, item.url));\r\n            formData.append('filter', activeFilter.value);\r\n            formData.append('location', location);\r\n\r\n            try {\r\n                await createPost(formData);\r\n                router.push('/');\r\n            } catch (error) {\r\n                console.error('Failed to share post:', error);\r\n                alert('Failed to share post. See console for details.');\r\n            }\r\n        });\r\n    };\r\n\r\n    const generateAICaption = () => {\r\n        setIsGeneratingCaption(true);\r\n        // Simulate AI generation\r\n        setTimeout(() => {\r\n            const mocks = [\r\n                \"Chasing sunsets and good vibes ≡ƒîàΓ£¿\",\r\n                \"Wanderlust and city dust. #TravelDiaries\",\r\n                \"POV: You're exactly where you need to be. ≡ƒÆ½\",\r\n                \"Life is better when you're laughing. ≡ƒÿé≡ƒÆû\",\r\n                \"Art in every corner. ≡ƒÄ¿≡ƒûî∩╕Å\"\r\n            ];\r\n            setCaption(mocks[Math.floor(Math.random() * mocks.length)]);\r\n            setIsGeneratingCaption(false);\r\n        }, 1500);\r\n    };\r\n\r\n    const handleLocationClick = () => {\r\n        const places = ['New York, USA', 'Tokyo, Japan', 'Paris, France', 'London, UK'];\r\n        setLocation(places[Math.floor(Math.random() * places.length)]);\r\n    };\r\n\r\n    return (\r\n        <div className={styles.createPage}>\r\n            <div className={`${styles.modal} fade-in`}>\r\n                {/* Header */}\r\n                <div className={styles.header}>\r\n                    {mediaItems.length > 0 ? (\r\n                        <button className={styles.backBtn} onClick={() => setMediaItems([])} disabled={isPending}>\r\n                            <ChevronLeft size={22} />\r\n                        </button>\r\n                    ) : (\r\n                        <button className={styles.closeBtn} onClick={() => router.back()} disabled={isPending}>\r\n                            <X size={22} />\r\n                        </button>\r\n                    )}\r\n\r\n                    <div className={styles.title}>\r\n                        Create new post\r\n                    </div>\r\n\r\n                    {mediaItems.length > 0 ? (\r\n                        <button\r\n                            className={styles.shareButton}\r\n                            onClick={handleShare}\r\n                            disabled={isPending}\r\n                        >\r\n                            {isPending ? (\r\n                                <div className={styles.spinner} />\r\n                            ) : 'Share'}\r\n                        </button>\r\n                    ) : (\r\n                        <div style={{ width: 40 }} /> // Spacer to balance header\r\n                    )}\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div\r\n                    className={`${styles.content} ${isDragging ? styles.dragging : ''}`}\r\n                    onDrop={handleDrop}\r\n                    onDragOver={handleDragOver}\r\n                    onDragLeave={handleDragLeave}\r\n                >\r\n                    {mediaItems.length > 0 ? (\r\n                        <div className={styles.editorContainer}>\r\n                            {/* Media Preview Side */}\r\n                            {/* Media Preview Side */}\r\n                            <div className={styles.imagePreviewSection}>\r\n                                <div className={styles.mainPreviewWrapper}>\r\n                                    {mediaItems[currentMediaIndex].type === 'image' ? (\r\n                                        <img\r\n                                            src={mediaItems[currentMediaIndex].url}\r\n                                            alt=\"Preview\"\r\n                                            className={`${styles.previewImage} ${isEnhancing ? styles.enhancingScan : ''}`}\r\n                                            style={{ filter: isEnhanced ? 'contrast(1.1) saturate(1.2) brightness(1.05)' : activeFilter.value }}\r\n                                        />\r\n                                    ) : (\r\n                                        <video\r\n                                            src={mediaItems[currentMediaIndex].url}\r\n                                            className={styles.previewImage}\r\n                                            style={{ filter: isEnhanced ? 'contrast(1.1) saturate(1.2)' : activeFilter.value }}\r\n                                            autoPlay\r\n                                            muted\r\n                                            loop\r\n                                        />\r\n                                    )}\r\n\r\n                                    {/* AI Enhance Button */}\r\n                                    <button\r\n                                        className={`${styles.aiEnhanceBtn} ${isEnhanced ? styles.aiActive : ''}`}\r\n                                        onClick={handleAIEnhance}\r\n                                        disabled={isEnhancing}\r\n                                    >\r\n                                        <Sparkles size={16} className={isEnhancing ? styles.spin : ''} />\r\n                                        <span>{isEnhancing ? 'Enhancing...' : isEnhanced ? 'AI Enhanced' : 'AI Enhance'}</span>\r\n                                    </button>\r\n                                </div>\r\n\r\n                                {mediaItems.length > 1 && (\r\n                                    <div className={styles.carouselControls}>\r\n                                        {currentMediaIndex > 0 && (\r\n                                            <button className={styles.navBtnPrev} onClick={() => setCurrentMediaIndex(i => i - 1)}>\r\n                                                <ChevronLeft size={20} />\r\n                                            </button>\r\n                                        )}\r\n                                        {currentMediaIndex < mediaItems.length - 1 && (\r\n                                            <button className={styles.navBtnNext} onClick={() => setCurrentMediaIndex(i => i + 1)}>\r\n                                                <ChevronLeft size={20} style={{ transform: 'rotate(180deg)' }} />\r\n                                            </button>\r\n                                        )}\r\n                                        <div className={styles.carouselDots}>\r\n                                            {mediaItems.map((_, i) => (\r\n                                                <div key={i} className={`${styles.dot} ${i === currentMediaIndex ? styles.activeDot : ''}`} />\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Sidebar Details Side */}\r\n                            <div className={styles.detailsSidebar}>\r\n                                {currentUser ? (\r\n                                    <div className={styles.userInfo}>\r\n                                        <img src={currentUser.avatar || \"https://i.pravatar.cc/150\"} alt=\"Me\" className={styles.avatar} />\r\n                                        <span className={styles.username}>{currentUser.username}</span>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div className={styles.userInfo}>\r\n                                        <div className={styles.avatar} style={{ background: '#333' }} />\r\n                                        <div style={{ height: 14, width: 80, background: '#333', borderRadius: 4 }} />\r\n                                    </div>\r\n                                )}\r\n\r\n                                <div className={styles.captionArea}>\r\n                                    <textarea\r\n                                        className={styles.captionInput}\r\n                                        placeholder=\"Write a caption...\"\r\n                                        value={caption}\r\n                                        onChange={(e) => setCaption(e.target.value)}\r\n                                        disabled={isPending}\r\n                                        maxLength={2200}\r\n                                    />\r\n                                    <div className={styles.toolsRow}>\r\n                                        <div style={{ display: 'flex', gap: 12 }}>\r\n                                            <button className={styles.toolBtn} title=\"Add emoji\">\r\n                                                <Smile size={20} />\r\n                                            </button>\r\n                                            <button\r\n                                                className={`${styles.toolBtn} ${isGeneratingCaption ? styles.sparkleLoading : ''}`}\r\n                                                title=\"AI Magic Caption\"\r\n                                                onClick={generateAICaption}\r\n                                                disabled={isGeneratingCaption}\r\n                                            >\r\n                                                <Sparkles size={20} color={isGeneratingCaption ? \"#0095f6\" : \"currentColor\"} />\r\n                                            </button>\r\n                                        </div>\r\n                                        <div className={styles.charCount}>{caption.length}/2,200</div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className={styles.optionsList}>\r\n                                    <div className={styles.optionItem} onClick={handleLocationClick}>\r\n                                        <span className={styles.optionLabel}>Add Location</span>\r\n                                        {location ? (\r\n                                            <div style={{ display: 'flex', alignItems: 'center', gap: 4 }}>\r\n                                                <MapPin size={14} color=\"#0095f6\" />\r\n                                                <span className={styles.optionValue}>{location}</span>\r\n                                            </div>\r\n                                        ) : (\r\n                                            <MapPin size={20} color=\"white\" />\r\n                                        )}\r\n                                    </div>\r\n                                    <div className={styles.optionItem}>\r\n                                        <span className={styles.optionLabel}>Tag People</span>\r\n                                        <ChevronDown size={20} color=\"white\" />\r\n                                    </div>\r\n                                    <div className={styles.optionItem}>\r\n                                        <span className={styles.optionLabel}>Add Music</span>\r\n                                        <ChevronDown size={20} color=\"white\" />\r\n                                    </div>\r\n                                    <div className={styles.optionItem}>\r\n                                        <span className={styles.optionLabel}>Advanced settings</span>\r\n                                        <ChevronDown size={20} color=\"white\" />\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Filters */}\r\n                                <div className={styles.filtersSection}>\r\n                                    <div className={styles.filtersTitle}>Filters</div>\r\n                                    <div className={styles.filtersGrid}>\r\n                                        {FILTERS.map((filter) => (\r\n                                            <div\r\n                                                key={filter.name}\r\n                                                className={`${styles.filterItem} ${activeFilter.name === filter.name ? styles.active : ''}`}\r\n                                                onClick={() => setActiveFilter(filter)}\r\n                                            >\r\n                                                <div className={styles.filterPreview}>\r\n                                                    {mediaItems[currentMediaIndex].type === 'image' ? (\r\n                                                        <img\r\n                                                            src={mediaItems[currentMediaIndex].url}\r\n                                                            alt={filter.name}\r\n                                                            style={{ filter: filter.value }}\r\n                                                        />\r\n                                                    ) : (\r\n                                                        <div className={styles.videoFilterPlaceholder}>\r\n                                                            <Upload size={16} />\r\n                                                        </div>\r\n                                                    )}\r\n                                                </div>\r\n                                                <span className={styles.filterName}>{filter.name}</span>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        <div className={styles.uploadArea}>\r\n                            <div className={styles.uploadIconWrap}>\r\n                                <Upload size={40} color=\"white\" strokeWidth={1.5} />\r\n                            </div>\r\n                            <div className={styles.uploadText}>Drag photos and videos here</div>\r\n                            <label className={styles.selectButton}>\r\n                                Select from computer\r\n                                <input type=\"file\" hidden onChange={handleFileChange} accept=\"image/*,video/*\" multiple />\r\n                            </label>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CreatePostPage;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\explore\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[343,346],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[343,346],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[409,412],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[409,412],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[968,971],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[968,971],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":51,"column":25,"nodeType":"JSXOpeningElement","endLine":51,"endColumn":85}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { Heart, MessageCircle } from 'lucide-react';\r\nimport styles from './explore.module.css';\r\n// import { MOCK_POSTS, Post } from '@/lib/mockData';\r\nimport PostDetailModal from '@/components/PostDetailModal';\r\n\r\nconst ExplorePage = () => {\r\n    const [posts, setPosts] = useState<any[]>([]);\r\n    const [selectedPost, setSelectedPost] = useState<any | null>(null);\r\n\r\n    React.useEffect(() => {\r\n        const fetchPosts = async () => {\r\n            try {\r\n                const res = await fetch('/api/explore');\r\n                const data = await res.json();\r\n                if (Array.isArray(data)) {\r\n                    // Map API data to component structure if needed, or use directly\r\n                    // MOCK_POSTS structure: { id, user, image, likes, comments }\r\n                    // API returns: { ..., likes: [...], comments: [...] }\r\n                    const formatted = data.map((p: any) => ({\r\n                        ...p,\r\n                        likes: p.likes.length,\r\n                        comments: p.comments.length\r\n                    }));\r\n                    setPosts(formatted);\r\n                }\r\n            } catch (err) {\r\n                console.error('Failed to fetch explore posts:', err);\r\n            }\r\n        };\r\n        fetchPosts();\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"container\" style={{ maxWidth: '935px' }}>\r\n            <div className={`${styles.exploreHeader} fade-in`}>\r\n                <h1 className={styles.title}>Explore</h1>\r\n                <p className={styles.subtitle}>Discover new content from the community</p>\r\n            </div>\r\n\r\n            <div className={styles.grid}>\r\n                {posts.map((post, index) => (\r\n                    <div\r\n                        key={post.id}\r\n                        className={styles.gridItem}\r\n                        style={{ animationDelay: `${index * 0.04}s` }}\r\n                        onClick={() => setSelectedPost(post)}\r\n                    >\r\n                        <img src={post.image} alt=\"\" className={styles.gridImage} />\r\n                        <div className={styles.overlay}>\r\n                            <div className={styles.overlayContent}>\r\n                                <div className={styles.overlayStats}>\r\n                                    <span className={styles.stat}>\r\n                                        <Heart size={18} fill=\"white\" color=\"white\" />\r\n                                        {post.likes}\r\n                                    </span>\r\n                                    <span className={styles.stat}>\r\n                                        <MessageCircle size={18} fill=\"white\" color=\"white\" />\r\n                                        {post.comments}\r\n                                    </span>\r\n                                </div>\r\n                                <div className={styles.overlayUser}>@{post.user.username}</div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {posts.length === 0 && (\r\n                <div className={styles.empty}>\r\n                    <div className={styles.emptyIcon}>≡ƒöì</div>\r\n                    <h3>Nothing to explore yet</h3>\r\n                    <p>Posts from the community will show up here.</p>\r\n                </div>\r\n            )}\r\n\r\n            {selectedPost && (\r\n                <PostDetailModal\r\n                    post={selectedPost}\r\n                    isOpen={!!selectedPost}\r\n                    onClose={() => setSelectedPost(null)}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ExplorePage;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\messages\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MoreHorizontal' is defined but never used.","line":4,"column":63,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":77,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MoreHorizontal"},"fix":{"range":[138,154],"text":""},"desc":"Remove unused variable \"MoreHorizontal\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CONVERSATIONS' is assigned a value but never used.","line":27,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'INITIAL_MESSAGES' is assigned a value but never used.","line":80,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":80,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setConversations' is assigned a value but never used.","line":116,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":116,"endColumn":43},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setIsTyping' is assigned a value but never used.","line":117,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":117,"endColumn":33},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\messages\\page.tsx:132:13\n  130 |         // On desktop, select first conversation if none selected\n  131 |         if (window.innerWidth > 768 && !selectedConversation && conversations.length > 0) {\n> 132 |             setSelectedConversation(conversations[0].id);\n      |             ^^^^^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  133 |         }\n  134 |     }, [conversations, selectedConversation]);\n  135 |","line":132,"column":13,"nodeType":null,"endLine":132,"endColumn":36},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":202,"column":37,"nodeType":"JSXOpeningElement","endLine":202,"endColumn":104},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":239,"column":33,"nodeType":"JSXOpeningElement","endLine":239,"endColumn":118},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":274,"column":37,"nodeType":"JSXOpeningElement","endLine":274,"endColumn":135},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":292,"column":33,"nodeType":"JSXOpeningElement","endLine":292,"endColumn":113},{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"Image elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":308,"column":29,"nodeType":"JSXOpeningElement","endLine":308,"endColumn":48}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport { Search, Phone, Video, Info, Smile, Image, Mic, Send, MoreHorizontal, Edit } from 'lucide-react';\r\nimport styles from './messages.module.css';\r\n\r\ninterface Message {\r\n    id: number;\r\n    text: string;\r\n    sender: 'user' | 'other';\r\n    timestamp: string;\r\n    avatar?: string;\r\n    status?: 'sent' | 'delivered' | 'seen';\r\n}\r\n\r\ninterface Conversation {\r\n    id: number;\r\n    name: string;\r\n    username: string;\r\n    avatar: string;\r\n    lastMessage: string;\r\n    timestamp: string;\r\n    unread: number;\r\n    online: boolean;\r\n}\r\n\r\nconst CONVERSATIONS: Conversation[] = [\r\n    {\r\n        id: 1,\r\n        name: 'Sarah Johnson',\r\n        username: 'sarahjohnson',\r\n        avatar: 'https://i.pravatar.cc/150?u=1',\r\n        lastMessage: 'That sounds amazing! Can you show me more? ≡ƒñ⌐',\r\n        timestamp: '2m',\r\n        unread: 2,\r\n        online: true\r\n    },\r\n    {\r\n        id: 2,\r\n        name: 'Mike Chen',\r\n        username: 'mikechen',\r\n        avatar: 'https://i.pravatar.cc/150?u=12',\r\n        lastMessage: 'Thanks for the help!',\r\n        timestamp: '15m',\r\n        unread: 0,\r\n        online: true\r\n    },\r\n    {\r\n        id: 3,\r\n        name: 'Emily Davis',\r\n        username: 'emilydavis',\r\n        avatar: 'https://i.pravatar.cc/150?u=5',\r\n        lastMessage: 'See you tomorrow ≡ƒæï',\r\n        timestamp: '1h',\r\n        unread: 0,\r\n        online: false\r\n    },\r\n    {\r\n        id: 4,\r\n        name: 'Alex Turner',\r\n        username: 'alexturner',\r\n        avatar: 'https://i.pravatar.cc/150?u=8',\r\n        lastMessage: 'That sounds great!',\r\n        timestamp: '3h',\r\n        unread: 1,\r\n        online: false\r\n    },\r\n    {\r\n        id: 5,\r\n        name: 'Jessica Lee',\r\n        username: 'jessicalee',\r\n        avatar: 'https://i.pravatar.cc/150?u=9',\r\n        lastMessage: 'Let me know when you\\'re free',\r\n        timestamp: '5h',\r\n        unread: 0,\r\n        online: true\r\n    }\r\n];\r\n\r\nconst INITIAL_MESSAGES: Message[] = [\r\n    {\r\n        id: 1,\r\n        text: 'Hey! How are you doing?',\r\n        sender: 'other',\r\n        timestamp: '10:30 AM',\r\n        status: 'seen'\r\n    },\r\n    {\r\n        id: 2,\r\n        text: 'I\\'m doing great! Just working on some new designs.',\r\n        sender: 'user',\r\n        timestamp: '10:32 AM',\r\n        status: 'seen'\r\n    },\r\n    {\r\n        id: 3,\r\n        text: 'That\\'s awesome! Can\\'t wait to see them.',\r\n        sender: 'other',\r\n        timestamp: '10:33 AM',\r\n        status: 'seen'\r\n    },\r\n    {\r\n        id: 4,\r\n        text: 'I\\'ll share them with you soon! ≡ƒÄ¿',\r\n        sender: 'user',\r\n        timestamp: '10:35 AM',\r\n        status: 'seen'\r\n    }\r\n];\r\n\r\nconst MessagesPage = () => {\r\n    const [selectedConversation, setSelectedConversation] = useState<number | null>(null);\r\n    const [messageText, setMessageText] = useState('');\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [messages, setMessages] = useState<Message[]>([]);\r\n    const [conversations, setConversations] = useState<Conversation[]>([]);\r\n    const [isTyping, setIsTyping] = useState(false);\r\n    const messagesEndRef = useRef<HTMLDivElement>(null);\r\n\r\n    // Use empty for now until backend is ready\r\n    // const conversations = CONVERSATIONS; \r\n\r\n    // Scroll to bottom on new message\r\n    useEffect(() => {\r\n        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n    }, [messages, isTyping, selectedConversation]);\r\n\r\n    // Initial load selection (optional)\r\n    useEffect(() => {\r\n        // On desktop, select first conversation if none selected\r\n        if (window.innerWidth > 768 && !selectedConversation && conversations.length > 0) {\r\n            setSelectedConversation(conversations[0].id);\r\n        }\r\n    }, [conversations, selectedConversation]);\r\n\r\n    const selectedConv = conversations.find(c => c.id === selectedConversation);\r\n\r\n    const handleSendMessage = () => {\r\n        if (!messageText.trim()) return;\r\n\r\n        const newMessage: Message = {\r\n            id: messages.length + 1,\r\n            text: messageText,\r\n            sender: 'user',\r\n            timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),\r\n            status: 'sent'\r\n        };\r\n\r\n        setMessages(prev => [...prev, newMessage]);\r\n        setMessageText('');\r\n\r\n        // No automatic reply since no backend logic\r\n    };\r\n\r\n    const handleKeyPress = (e: React.KeyboardEvent) => {\r\n        if (e.key === 'Enter' && !e.shiftKey) {\r\n            e.preventDefault();\r\n            handleSendMessage();\r\n        }\r\n    };\r\n\r\n    const handleBack = () => {\r\n        setSelectedConversation(null);\r\n    };\r\n\r\n    return (\r\n        <div className={styles.messagesContainer}>\r\n            {/* Conversations List - Hidden on mobile if chat is open */}\r\n            <div className={`${styles.conversationsList} ${selectedConversation ? styles.hiddenOnMobile : ''}`}>\r\n                <div className={styles.conversationsHeader}>\r\n                    <h1 className={styles.headerTitle}>Chat</h1>\r\n                    <button className={styles.newMessageBtn}>\r\n                        <Edit size={20} />\r\n                    </button>\r\n                </div>\r\n\r\n                <div className={styles.searchContainer}>\r\n                    <Search size={18} className={styles.searchIcon} />\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder=\"Search chats...\"\r\n                        className={styles.searchInput}\r\n                        value={searchQuery}\r\n                        onChange={(e) => setSearchQuery(e.target.value)}\r\n                    />\r\n                </div>\r\n\r\n                <div className={styles.conversationsScroll}>\r\n                    {conversations.length === 0 ? (\r\n                        <div style={{ padding: '20px', textAlign: 'center', color: '#888' }}>\r\n                            <p>No conversations yet.</p>\r\n                            <p>Start a new chat to connect!</p>\r\n                        </div>\r\n                    ) : (\r\n                        conversations.map((conv) => (\r\n                            <div\r\n                                key={conv.id}\r\n                                className={`${styles.conversationItem} ${selectedConversation === conv.id ? styles.active : ''}`}\r\n                                onClick={() => setSelectedConversation(conv.id)}\r\n                            >\r\n                                <div className={styles.avatarContainer}>\r\n                                    <img src={conv.avatar} alt={conv.name} className={styles.avatar} />\r\n                                    {conv.online && <div className={styles.onlineIndicator} />}\r\n                                </div>\r\n                                <div className={styles.conversationInfo}>\r\n                                    <div className={styles.conversationTop}>\r\n                                        <span className={styles.conversationName}>{conv.name}</span>\r\n                                        <span className={styles.timestamp}>{conv.timestamp}</span>\r\n                                    </div>\r\n                                    <div className={styles.conversationBottom}>\r\n                                        <span className={styles.lastMessage}>\r\n                                            {conv.id === selectedConversation && messages.length > 0\r\n                                                ? messages[messages.length - 1].text\r\n                                                : conv.lastMessage}\r\n                                        </span>\r\n                                        {conv.unread > 0 && (\r\n                                            <span className={styles.unreadBadge}>{conv.unread}</span>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        ))\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* Chat Area - Shows empty state or active chat */}\r\n            {selectedConversation ? (\r\n                <div className={`${styles.chatArea} ${selectedConversation ? styles.visibleOnMobile : ''}`}>\r\n                    {/* Chat Header */}\r\n                    <div className={styles.chatHeader}>\r\n                        <div className={styles.chatHeaderLeft}>\r\n                            <button className={styles.backBtn} onClick={handleBack}>\r\n                                <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                    <path d=\"M19 12H5M12 19l-7-7 7-7\" />\r\n                                </svg>\r\n                            </button>\r\n                            <div className={styles.avatarContainer}>\r\n                                <img src={selectedConv?.avatar} alt={selectedConv?.name} className={styles.avatar} />\r\n                                {selectedConv?.online && <div className={styles.onlineIndicator} />}\r\n                            </div>\r\n                            <div className={styles.chatHeaderInfo}>\r\n                                <h2 className={styles.chatName}>{selectedConv?.name}</h2>\r\n                                <span className={styles.chatStatus}>\r\n                                    {selectedConv?.online ? 'Active now' : 'Offline'}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                        <div className={styles.chatHeaderActions}>\r\n                            <button className={styles.headerActionBtn}>\r\n                                <Phone size={20} />\r\n                            </button>\r\n                            <button className={styles.headerActionBtn}>\r\n                                <Video size={20} />\r\n                            </button>\r\n                            <button className={styles.headerActionBtn}>\r\n                                <Info size={20} />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Messages */}\r\n                    <div className={styles.messagesArea}>\r\n                        <div className={styles.dateSeparator}>\r\n                            <span>Today</span>\r\n                        </div>\r\n\r\n                        {messages.map((message) => (\r\n                            <div\r\n                                key={message.id}\r\n                                className={`${styles.messageWrapper} ${message.sender === 'user' ? styles.userMessage : styles.otherMessage}`}\r\n                            >\r\n                                {message.sender === 'other' && (\r\n                                    <img src={message.avatar || selectedConv?.avatar} alt=\"Avatar\" className={styles.messageAvatar} />\r\n                                )}\r\n                                <div className={styles.messageBubble}>\r\n                                    <p className={styles.messageText}>{message.text}</p>\r\n                                    <span className={styles.messageTime}>\r\n                                        {message.timestamp}\r\n                                        {message.sender === 'user' && (\r\n                                            <span className={styles.messageStatus}>\r\n                                                {message.status === 'seen' ? ' ΓÇó Seen' : ' ΓÇó Sent'}\r\n                                            </span>\r\n                                        )}\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n\r\n                        {isTyping && (\r\n                            <div className={`${styles.messageWrapper} ${styles.otherMessage}`}>\r\n                                <img src={selectedConv?.avatar} alt=\"Avatar\" className={styles.messageAvatar} />\r\n                                <div className={`${styles.messageBubble} ${styles.typingBubble}`}>\r\n                                    <div className={styles.typingIndicator}>\r\n                                        <span></span>\r\n                                        <span></span>\r\n                                        <span></span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                        <div ref={messagesEndRef} />\r\n                    </div>\r\n\r\n                    {/* Message Input */}\r\n                    <div className={styles.messageInput}>\r\n                        <button className={styles.inputActionBtn}>\r\n                            <Image size={22} />\r\n                        </button>\r\n                        <button className={styles.inputActionBtn}>\r\n                            <Smile size={22} />\r\n                        </button>\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Message...\"\r\n                            className={styles.textInput}\r\n                            value={messageText}\r\n                            onChange={(e) => setMessageText(e.target.value)}\r\n                            onKeyDown={handleKeyPress}\r\n                        />\r\n                        {messageText.trim() ? (\r\n                            <button className={styles.sendBtn} onClick={handleSendMessage}>\r\n                                <Send size={20} />\r\n                            </button>\r\n                        ) : (\r\n                            <button className={styles.inputActionBtn}>\r\n                                <Mic size={22} />\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            ) : (\r\n                <div className={`${styles.emptyState} ${styles.hiddenOnMobile}`} style={{ display: selectedConversation ? 'none' : 'flex' }}>\r\n                    <div className={styles.emptyStateContent}>\r\n                        <div className={styles.emptyIcon}>\r\n                            <Send size={64} />\r\n                        </div>\r\n                        <h2 className={styles.emptyTitle}>Your Chats</h2>\r\n                        <p className={styles.emptyDescription}>\r\n                            Send private photos and chat with a friend or group\r\n                        </p>\r\n                        <button className={styles.sendMessageBtn}>Send Chat</button>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MessagesPage;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\monetization\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Lock' is defined but never used.","line":15,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":9,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Lock"},"fix":{"range":[223,234],"text":""},"desc":"Remove unused variable \"Lock\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport {\r\n    LayoutDashboard,\r\n    DollarSign,\r\n    TrendingUp,\r\n    CreditCard,\r\n    Gift,\r\n    Star,\r\n    Video,\r\n    ChevronRight,\r\n    Clock,\r\n    CheckCircle2,\r\n    Lock,\r\n    Plus,\r\n    Wallet,\r\n    X,\r\n    ArrowUpRight\r\n} from 'lucide-react';\r\nimport styles from './monetization.module.css';\r\n\r\nconst MonetizationPage = () => {\r\n    // State for Modals\r\n    const [showAddPayment, setShowAddPayment] = useState(false);\r\n    const [showWithdraw, setShowWithdraw] = useState(false);\r\n    const [withdrawAmount, setWithdrawAmount] = useState('');\r\n\r\n    // Mock data for earnings\r\n    const [balance, setBalance] = useState(12450.50);\r\n    const earnings = {\r\n        total: `$${balance.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`,\r\n        lastMonth: '$2,340.20',\r\n        payoutDate: 'Feb 21, 2026',\r\n        trend: '+15.4%'\r\n    };\r\n\r\n    // Mock data for payment methods\r\n    const [paymentMethods, setPaymentMethods] = useState([\r\n        { id: 1, type: 'Visa', last4: '4242', expiry: '12/28', icon: CreditCard, isDefault: true },\r\n        { id: 2, type: 'PayPal', email: 'user@example.com', icon: Wallet, isDefault: false }\r\n    ]);\r\n\r\n    // Mock data for tools\r\n    const tools = [\r\n        {\r\n            id: 1,\r\n            name: 'Ads on Shots',\r\n            status: 'Active',\r\n            icon: Video,\r\n            color: '#E1306C',\r\n            earnings: '$1,240.50'\r\n        },\r\n        {\r\n            id: 2,\r\n            name: 'Stars',\r\n            status: 'Eligible',\r\n            icon: Star,\r\n            color: '#FCAF45',\r\n            earnings: '$0.00'\r\n        },\r\n        {\r\n            id: 3,\r\n            name: 'Subscriptions',\r\n            status: 'Active',\r\n            icon: CreditCard,\r\n            color: '#833AB4',\r\n            earnings: '$850.00'\r\n        },\r\n        {\r\n            id: 4,\r\n            name: 'Gifts',\r\n            status: 'Locked',\r\n            icon: Gift,\r\n            color: '#C13584',\r\n            earnings: '$0.00'\r\n        }\r\n    ];\r\n\r\n    // Mock recent activity\r\n    const activities = [\r\n        { id: 1, title: 'Payout Processed', date: 'Jan 21, 2026', amount: '$2,100.00', status: 'Completed' },\r\n        { id: 2, title: 'Shots Revenue', date: 'Jan 20, 2026', amount: '+$450.20', status: 'Earnings' },\r\n        { id: 3, title: 'Subscription Revenue', date: 'Jan 19, 2026', amount: '+$120.00', status: 'Earnings' },\r\n        { id: 4, title: 'Stars Received', date: 'Jan 18, 2026', amount: '+$15.50', status: 'Earnings' },\r\n    ];\r\n\r\n    const handleAddPayment = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        // Simulate adding card\r\n        const newCard = {\r\n            id: Date.now(),\r\n            type: 'Mastercard',\r\n            last4: '8888',\r\n            expiry: '09/29',\r\n            icon: CreditCard,\r\n            isDefault: false\r\n        };\r\n        setPaymentMethods([...paymentMethods, newCard]);\r\n        setShowAddPayment(false);\r\n    };\r\n\r\n    const handleWithdraw = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        const amount = parseFloat(withdrawAmount);\r\n        if (amount > 0 && amount <= balance) {\r\n            setBalance(prev => prev - amount);\r\n            setShowWithdraw(false);\r\n            setWithdrawAmount('');\r\n            alert(`Withdrawal of $${amount} initiated successfully!`);\r\n        } else {\r\n            alert('Invalid amount or insufficient funds');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            {/* Header */}\r\n            <div className={styles.header}>\r\n                <h1 className={styles.title}>Professional Dashboard</h1>\r\n                <p className={styles.subtitle}>Manage your earnings and monetization tools.</p>\r\n            </div>\r\n\r\n            {/* Overview Grid */}\r\n            <div className={styles.overviewGrid}>\r\n                {/* Total Earnings Card */}\r\n                <div className={styles.overviewCard}>\r\n                    <div className={styles.cardHeader}>\r\n                        <div className={styles.cardIcon}>\r\n                            <DollarSign size={24} />\r\n                        </div>\r\n                        <button className={styles.withdrawBtn} onClick={() => setShowWithdraw(true)}>\r\n                            Withdraw\r\n                        </button>\r\n                    </div>\r\n                    <div>\r\n                        <div className={styles.cardValue}>{earnings.total}</div>\r\n                        <div className={styles.cardLabel}>Available Balance</div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Last Payout Card */}\r\n                <div className={styles.overviewCard}>\r\n                    <div className={styles.cardHeader}>\r\n                        <div className={styles.cardIcon}>\r\n                            <ArrowUpRight size={24} />\r\n                        </div>\r\n                        <span className={styles.cardChange}>{earnings.trend}</span>\r\n                    </div>\r\n                    <div>\r\n                        <div className={styles.cardValue}>{earnings.lastMonth}</div>\r\n                        <div className={styles.cardLabel}>Last Payout ({earnings.payoutDate})</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Payment Methods Section */}\r\n            <div className={styles.sectionHeader}>\r\n                <h2 className={styles.sectionTitle}>\r\n                    <Wallet size={20} />\r\n                    Payment Methods\r\n                </h2>\r\n                <button className={styles.addBtn} onClick={() => setShowAddPayment(true)}>\r\n                    <Plus size={16} /> Add New\r\n                </button>\r\n            </div>\r\n\r\n            <div className={styles.paymentMethodsGrid}>\r\n                {paymentMethods.map((method) => (\r\n                    <div key={method.id} className={`${styles.paymentCard} ${method.isDefault ? styles.defaultCard : ''}`}>\r\n                        <div className={styles.paymentIcon}>\r\n                            <method.icon size={24} />\r\n                        </div>\r\n                        <div className={styles.paymentInfo}>\r\n                            <div className={styles.paymentType}>{method.type}</div>\r\n                            <div className={styles.paymentDetail}>\r\n                                {method.type === 'PayPal' ? method.email : `**** **** **** ${method.last4}`}\r\n                            </div>\r\n                            {method.expiry && <div className={styles.paymentExpiry}>Expires {method.expiry}</div>}\r\n                        </div>\r\n                        {method.isDefault && <div className={styles.defaultBadge}>Default</div>}\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Monetization Tools */}\r\n            <h2 className={styles.sectionTitle} style={{ marginTop: '40px' }}>\r\n                <LayoutDashboard size={20} />\r\n                Your Tools\r\n            </h2>\r\n            <div className={styles.toolsGrid}>\r\n                {tools.map((tool) => (\r\n                    <div key={tool.id} className={styles.toolCard}>\r\n                        <div className={styles.toolIcon} style={{ color: tool.color, background: `${tool.color}15` }}>\r\n                            <tool.icon size={24} />\r\n                        </div>\r\n                        <div className={styles.toolInfo}>\r\n                            <div className={styles.toolName}>{tool.name}</div>\r\n                            <div className={`${styles.toolStatus} ${tool.status === 'Active' ? styles.statusActive :\r\n                                tool.status === 'Eligible' ? styles.statusEligible :\r\n                                    styles.statusLocked\r\n                                }`}>\r\n                                <span className={styles.statusDot}></span>\r\n                                {tool.status === 'Active' && 'Active ΓÇó ' + tool.earnings}\r\n                                {tool.status === 'Eligible' && 'Set up'}\r\n                                {tool.status === 'Locked' && 'Not eligible'}\r\n                            </div>\r\n                        </div>\r\n                        <ChevronRight size={20} className={styles.toolArrow} />\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Recent Activity */}\r\n            <h2 className={styles.sectionTitle}>\r\n                <TrendingUp size={20} />\r\n                Recent Activity\r\n            </h2>\r\n            <div className={styles.activityList}>\r\n                {activities.map((activity) => (\r\n                    <div key={activity.id} className={styles.activityItem}>\r\n                        <div className={styles.activityLeft}>\r\n                            <div className={styles.activityIcon}>\r\n                                {activity.status === 'Completed' ? <CheckCircle2 size={20} color=\"#4ade80\" /> : <Clock size={20} />}\r\n                            </div>\r\n                            <div className={styles.activityDetails}>\r\n                                <div className={styles.activityTitle}>{activity.title}</div>\r\n                                <div className={styles.activityDate}>{activity.date}</div>\r\n                            </div>\r\n                        </div>\r\n                        <div className={`${styles.activityAmount} ${activity.status !== 'Completed' ? styles.pending : ''}`}>\r\n                            {activity.amount}\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Add Payment Modal */}\r\n            {showAddPayment && (\r\n                <div className={styles.modalOverlay}>\r\n                    <div className={styles.modal}>\r\n                        <div className={styles.modalHeader}>\r\n                            <h3>Add Payment Method</h3>\r\n                            <button onClick={() => setShowAddPayment(false)} className={styles.closeBtn}><X size={20} /></button>\r\n                        </div>\r\n                        <form onSubmit={handleAddPayment} className={styles.modalForm}>\r\n                            <div className={styles.formGroup}>\r\n                                <label>Card Number</label>\r\n                                <input type=\"text\" placeholder=\"0000 0000 0000 0000\" className={styles.input} required />\r\n                            </div>\r\n                            <div className={styles.formRow}>\r\n                                <div className={styles.formGroup}>\r\n                                    <label>Expiry Date</label>\r\n                                    <input type=\"text\" placeholder=\"MM/YY\" className={styles.input} required />\r\n                                </div>\r\n                                <div className={styles.formGroup}>\r\n                                    <label>CVC</label>\r\n                                    <input type=\"text\" placeholder=\"123\" className={styles.input} required />\r\n                                </div>\r\n                            </div>\r\n                            <button type=\"submit\" className={styles.submitBtn}>Add Card</button>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Withdraw Modal */}\r\n            {showWithdraw && (\r\n                <div className={styles.modalOverlay}>\r\n                    <div className={styles.modal}>\r\n                        <div className={styles.modalHeader}>\r\n                            <h3>Withdraw Funds</h3>\r\n                            <button onClick={() => setShowWithdraw(false)} className={styles.closeBtn}><X size={20} /></button>\r\n                        </div>\r\n                        <form onSubmit={handleWithdraw} className={styles.modalForm}>\r\n                            <div className={styles.balanceDisplay}>\r\n                                <span>Available Balance</span>\r\n                                <h2>${balance.toFixed(2)}</h2>\r\n                            </div>\r\n                            <div className={styles.formGroup}>\r\n                                <label>Amount to Withdraw</label>\r\n                                <div className={styles.inputWrapper}>\r\n                                    <span className={styles.currencyPrefix}>$</span>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={withdrawAmount}\r\n                                        onChange={(e) => setWithdrawAmount(e.target.value)}\r\n                                        placeholder=\"0.00\"\r\n                                        className={styles.input}\r\n                                        required\r\n                                        max={balance}\r\n                                        min=\"1\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                            <div className={styles.formGroup}>\r\n                                <label>Withdraw to</label>\r\n                                <select className={styles.select}>\r\n                                    {paymentMethods.map(m => (\r\n                                        <option key={m.id} value={m.id}>\r\n                                            {m.type} ends in {m.last4 || m.email?.split('@')[0]}\r\n                                        </option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                            <button type=\"submit\" className={styles.submitBtn} disabled={!withdrawAmount}>\r\n                                Confirm Withdrawal\r\n                            </button>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MonetizationPage;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[504,507],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[504,507],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1514,1517],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1514,1517],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":52,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2008,2011],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2008,2011],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadMore` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\page.tsx:112:9\n  110 |     observer.current = new IntersectionObserver(entries => {\n  111 |       if (entries[0].isIntersecting && hasMore && !fetchingMore) {\n> 112 |         loadMore();\n      |         ^^^^^^^^ `loadMore` accessed before it is declared\n  113 |       }\n  114 |     }, { threshold: 0.5 });\n  115 |\n\nC:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\page.tsx:121:3\n  119 |   }, [loading, hasMore, fetchingMore]);\n  120 |\n> 121 |   const loadMore = async () => {\n      |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 122 |     if (fetchingMore || !hasMore) return;\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 123 |     setFetchingMore(true);\n      ΓÇª\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 134 |     setFetchingMore(false);\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 135 |   };\n      | ^^^^^ `loadMore` is declared here\n  136 |\n  137 |   const containerVariants = {\n  138 |     hidden: { opacity: 0 },","line":112,"column":9,"nodeType":null,"endLine":112,"endColumn":17},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadMore'. Either include it or remove the dependency array.","line":119,"column":6,"nodeType":"ArrayExpression","endLine":119,"endColumn":38,"suggestions":[{"desc":"Update the dependencies array to be: [loading, hasMore, fetchingMore, loadMore]","fix":{"range":[3962,3994],"text":"[loading, hasMore, fetchingMore, loadMore]"}}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport Post from '@/components/Post';\r\nimport styles from './home.module.css';\r\nimport StoryBar from '@/components/StoryBar';\r\nimport RightSidebar from '@/components/RightSidebar';\r\nimport Loader from '@/components/Loader';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { formatDistanceToNow } from 'date-fns';\r\n\r\nexport default function Home() {\r\n  const [feedItems, setFeedItems] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [page, setPage] = useState(1);\r\n  const [hasMore, setHasMore] = useState(true);\r\n  const [fetchingMore, setFetchingMore] = useState(false);\r\n  const observer = useRef<IntersectionObserver | null>(null);\r\n  const lastElementRef = useRef<HTMLDivElement>(null);\r\n\r\n  const fetchContent = useCallback(async (pageNum: number) => {\r\n    try {\r\n      // Fetch separate streams (8 posts + 2 shots per page approx)\r\n      const [postsRes, shotsRes] = await Promise.all([\r\n        fetch(`/api/posts?page=${pageNum}&limit=8`),\r\n        fetch(`/api/shots?page=${pageNum}&limit=2`)\r\n      ]);\r\n\r\n      const postsData = await postsRes.json();\r\n      const shotsData = await shotsRes.json();\r\n\r\n      if (!Array.isArray(postsData) || !Array.isArray(shotsData)) {\r\n        return [];\r\n      }\r\n\r\n      if (postsData.length === 0 && shotsData.length === 0) {\r\n        return []; // End of feed\r\n      }\r\n\r\n      const formattedPosts = postsData.map((post: any) => ({\r\n        id: post.id,\r\n        type: 'post',\r\n        user: post.user,\r\n        image: post.image,\r\n        caption: post.caption,\r\n        likes: post.likes ? (typeof post.likes === 'number' ? post.likes : post.likes.length) : 0,\r\n        isLiked: post.isLiked || false,\r\n        time: post.createdAt ? formatDistanceToNow(new Date(post.createdAt), { addSuffix: true }) : 'Just now',\r\n        comments: post.comments\r\n      }));\r\n\r\n      const formattedShots = shotsData.map((shot: any) => ({\r\n        id: shot.id,\r\n        type: 'shot',\r\n        user: shot.user,\r\n        image: undefined,\r\n        video: shot.video,\r\n        caption: shot.caption,\r\n        likes: shot.likes ? (typeof shot.likes === 'number' ? shot.likes : shot.likes.length) : 0,\r\n        isLiked: shot.isLiked || false,\r\n        time: shot.createdAt ? formatDistanceToNow(new Date(shot.createdAt), { addSuffix: true }) : 'Just now',\r\n        comments: shot.comments\r\n      }));\r\n\r\n      // Interleave: 4 Posts, 1 Shot\r\n      const combined = [];\r\n      let postIdx = 0;\r\n      let shotIdx = 0;\r\n\r\n      while (postIdx < formattedPosts.length || shotIdx < formattedShots.length) {\r\n        // Add up to 4 posts\r\n        for (let i = 0; i < 4 && postIdx < formattedPosts.length; i++) {\r\n          combined.push(formattedPosts[postIdx++]);\r\n        }\r\n        // Add 1 shot\r\n        if (shotIdx < formattedShots.length) {\r\n          combined.push(formattedShots[shotIdx++]);\r\n        }\r\n      }\r\n\r\n      return combined;\r\n    } catch (err) {\r\n      console.error('Failed to fetch content:', err);\r\n      return [];\r\n    }\r\n  }, []);\r\n\r\n  // Initial Load\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n    const init = async () => {\r\n      setLoading(true);\r\n      const data = await fetchContent(1);\r\n      if (isMounted) {\r\n        setFeedItems(data);\r\n        setLoading(false);\r\n        if (data.length === 0) setHasMore(false);\r\n      }\r\n    };\r\n    init();\r\n    return () => { isMounted = false; };\r\n  }, [fetchContent]);\r\n\r\n  // Infinite Scroll Observer\r\n  useEffect(() => {\r\n    if (loading) return;\r\n\r\n    if (observer.current) observer.current.disconnect();\r\n\r\n    observer.current = new IntersectionObserver(entries => {\r\n      if (entries[0].isIntersecting && hasMore && !fetchingMore) {\r\n        loadMore();\r\n      }\r\n    }, { threshold: 0.5 });\r\n\r\n    if (lastElementRef.current) {\r\n      observer.current.observe(lastElementRef.current);\r\n    }\r\n  }, [loading, hasMore, fetchingMore]);\r\n\r\n  const loadMore = async () => {\r\n    if (fetchingMore || !hasMore) return;\r\n    setFetchingMore(true);\r\n\r\n    const nextPage = page + 1;\r\n    const data = await fetchContent(nextPage);\r\n\r\n    if (data.length === 0) {\r\n      setHasMore(false);\r\n    } else {\r\n      setFeedItems(prev => [...prev, ...data]);\r\n      setPage(nextPage);\r\n    }\r\n    setFetchingMore(false);\r\n  };\r\n\r\n  const containerVariants = {\r\n    hidden: { opacity: 0 },\r\n    show: {\r\n      opacity: 1,\r\n      transition: {\r\n        staggerChildren: 0.1\r\n      }\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className={styles.container}>\r\n        <div className={styles.feedSection}>\r\n          <StoryBar />\r\n          <div className=\"skeleton\" style={{ height: '500px', width: '100%', borderRadius: '12px', marginTop: '24px' }}></div>\r\n          <div className=\"skeleton\" style={{ height: '500px', width: '100%', borderRadius: '12px', marginTop: '24px' }}></div>\r\n        </div>\r\n        <div className={styles.sidebarSection}>\r\n          {/* Sidebar Skeleton */}\r\n          <div className=\"skeleton\" style={{ height: '300px', width: '100%', borderRadius: '12px' }}></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={styles.container}>\r\n      <div className={styles.feedSection}>\r\n        <StoryBar />\r\n\r\n        <motion.div\r\n          className={styles.feedItemsList}\r\n          variants={containerVariants}\r\n          initial=\"hidden\"\r\n          animate=\"show\"\r\n        >\r\n          <AnimatePresence mode=\"popLayout\">\r\n            {feedItems.map((item, index) => (\r\n              <Post\r\n                key={`${item.id}-${index}`}\r\n                {...item}\r\n              />\r\n            ))}\r\n          </AnimatePresence>\r\n        </motion.div>\r\n\r\n        {/* Infinite Scroll Trigger */}\r\n        <div ref={lastElementRef} className={styles.loaderContainer}>\r\n          {fetchingMore && <Loader size=\"medium\" />}\r\n          {!hasMore && feedItems.length > 0 && (\r\n            <div className={styles.endMessage}>You&apos;re all caught up! ≡ƒÜÇ</div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className={styles.sidebarSection}>\r\n        <RightSidebar />\r\n      </div>\r\n\r\n\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\profile\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Link' is defined but never used.","line":7,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Link"},"fix":{"range":[236,267],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":84,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2992,2995],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2992,2995],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":87,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3152,3155],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3152,3155],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":99,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3703,3706],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3703,3706],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":133,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5005,5008],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5005,5008],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'totalLikes' is assigned a value but never used.","line":181,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":181,"endColumn":21},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":190,"column":29,"nodeType":"JSXOpeningElement","endLine":194,"endColumn":31},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":266,"column":33,"nodeType":"JSXOpeningElement","endLine":266,"endColumn":103},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":321,"column":33,"nodeType":"JSXOpeningElement","endLine":321,"endColumn":93}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Settings, Grid, Bookmark, UserSquare2, BadgeCheck, LayoutDashboard, Clapperboard, Play } from 'lucide-react';\r\nimport styles from './profile.module.css';\r\n\r\nimport Link from 'next/link';\r\nimport Footer from '@/components/Footer';\r\nimport EditProfileModal from '@/components/EditProfileModal';\r\nimport ArchiveModal from '@/components/ArchiveModal';\r\nimport SettingsModal from '@/components/SettingsModal';\r\nimport PostDetailModal from '@/components/PostDetailModal';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface Post {\r\n    id: string;\r\n    image: string;\r\n    likes: number;\r\n    comments: number;\r\n    userId: string;\r\n    caption: string;\r\n    createdAt: Date;\r\n    isLiked: boolean;\r\n    isSaved: boolean;\r\n    user: {\r\n        id: string;\r\n        username: string;\r\n        name: string;\r\n        avatar: string;\r\n    };\r\n}\r\n\r\ninterface Shot {\r\n    id: string;\r\n    video: string;\r\n    likes: number;\r\n    comments: number;\r\n    userId: string;\r\n}\r\n\r\ninterface User {\r\n    id: string;\r\n    username: string;\r\n    avatar: string;\r\n    bio: string | null;\r\n    followers: number;\r\n    posts: Post[];\r\n    shots: Shot[];\r\n    website?: string;\r\n    category?: string;\r\n    isPrivate?: boolean;\r\n    fullName?: string;\r\n}\r\n\r\nconst ProfilePage = () => {\r\n    const [activeTab, setActiveTab] = useState<'posts' | 'shots' | 'saved' | 'tagged'>('posts');\r\n    const [loading, setLoading] = useState(true);\r\n    const [isEditProfileOpen, setIsEditProfileOpen] = useState(false);\r\n    const [isArchiveOpen, setIsArchiveOpen] = useState(false);\r\n    const [isSettingsOpen, setIsSettingsOpen] = useState(false);\r\n    const [selectedPost, setSelectedPost] = useState<Post | null>(null);\r\n\r\n    // User state (initialized from mock)\r\n    const [user, setUser] = useState<User | null>(null);\r\n\r\n    const router = useRouter();\r\n\r\n    useEffect(() => {\r\n        const fetchProfile = async () => {\r\n            try {\r\n                setLoading(true);\r\n                // 1. Fetch User (Me)\r\n                const meRes = await fetch('/api/users/me');\r\n                if (!meRes.ok) throw new Error('Failed to fetch user');\r\n                const meData = await meRes.json();\r\n\r\n                // 2. Fetch User's Posts (Filtering all posts by userId for now, since we don't have a dedicated user posts endpoint in the list earlier)\r\n                // Ideally: /api/users/me/posts\r\n                // Fallback: /api/posts?userId=...\r\n                // Let's assume we can get all posts and filter (not efficient but works for small app) OR we use the /api/posts structure if it supports filtering.\r\n                // Looking at api/posts/route.ts, it doesn't seem to have ?userId filter yet.\r\n                // But let's check if we can add it or just fetch all and filter client side for now to be safe.\r\n                const postsRes = await fetch('/api/posts?limit=100');\r\n                let myPosts: any[] = [];\r\n                if (postsRes.ok) {\r\n                    const allPosts = await postsRes.json();\r\n                    myPosts = allPosts.filter((p: any) => p.userId === meData.id);\r\n                }\r\n\r\n                setUser({\r\n                    id: meData.id,\r\n                    username: meData.username,\r\n                    avatar: meData.avatar,\r\n                    bio: meData.bio || null,\r\n                    followers: meData._count?.followedBy || 0, // Using _count from API\r\n                    website: meData.website || '',\r\n                    category: meData.category || 'Digital Creator',\r\n                    isPrivate: false,\r\n                    posts: myPosts.map((post: any) => ({\r\n                        id: post.id,\r\n                        image: post.image,\r\n                        likes: post.likes ? post.likes.length : 0,\r\n                        comments: post.comments ? post.comments.length : 0,\r\n                        userId: post.userId || '',\r\n                        caption: post.caption || '',\r\n                        createdAt: post.createdAt ? new Date(post.createdAt) : new Date(),\r\n                        isLiked: false,\r\n                        isSaved: false,\r\n                        user: {\r\n                            id: post.user?.id || '',\r\n                            username: post.user?.username || meData.username,\r\n                            name: post.user?.name || '',\r\n                            avatar: post.user?.avatar || meData.avatar\r\n                        }\r\n                    })),\r\n                } as unknown as User); // Type assertion for cleaner code in this step\r\n            } catch (err) {\r\n                console.error('Profile fetch error', err);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchProfile();\r\n    }, []);\r\n\r\n\r\n\r\n    const handleEditProfile = () => {\r\n        setIsEditProfileOpen(true);\r\n    };\r\n\r\n    const handleSaveProfile = (data: any) => {\r\n        if (!user) return;\r\n        setUser({\r\n            ...user,\r\n            username: data.username,\r\n            bio: data.bio,\r\n            avatar: data.avatar,\r\n            website: data.website,\r\n            category: data.category,\r\n            isPrivate: data.isPrivate\r\n        });\r\n    };\r\n\r\n    const handleSettings = () => {\r\n        setIsSettingsOpen(true);\r\n    };\r\n\r\n    const formatFollowers = (count: number) => {\r\n        if (count >= 1000000) {\r\n            return (count / 1000000).toFixed(1) + 'M';\r\n        } else if (count >= 1000) {\r\n            return (count / 1000).toFixed(1) + 'K';\r\n        }\r\n        return count.toString();\r\n    };\r\n\r\n    const getVerificationBadge = (followers: number) => {\r\n        if (followers >= 100000000) {\r\n            return <BadgeCheck size={22} className={styles.goldTick} fill=\"#FFD700\" color=\"#fff\" />;\r\n        } else if (followers >= 1000000) {\r\n            return <BadgeCheck size={22} className={styles.silverTick} fill=\"#C0C0C0\" color=\"#fff\" />;\r\n        } else if (followers >= 100000) {\r\n            return <BadgeCheck size={22} className={styles.blueTick} fill=\"#0095F6\" color=\"#fff\" />;\r\n        }\r\n        return null; // No tick\r\n    };\r\n\r\n    if (loading || !user) {\r\n        return (\r\n            <div className=\"container\" style={{ maxWidth: '935px', padding: '60px 16px' }}>\r\n                <div className={styles.loading}>\r\n                    <div className={styles.spinner}></div>\r\n                    <p>Loading profile...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const totalLikes = user.posts.reduce((sum, post) => sum + post.likes, 0);\r\n\r\n    return (\r\n        <div className=\"container\" style={{ maxWidth: '935px' }}>\r\n            <div className={`${styles.profile} fade-in`}>\r\n                {/* Profile Header */}\r\n                <div className={styles.header}>\r\n                    <div className={styles.avatarSection}>\r\n                        <div className={styles.avatarRing}>\r\n                            <img\r\n                                src={user.avatar || 'https://i.pravatar.cc/150?u=' + user.username}\r\n                                alt={user.username}\r\n                                className={styles.avatar}\r\n                            />\r\n                            <div className={styles.addStoryBadge}>+</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className={styles.infoSection}>\r\n                        <div className={styles.topRow}>\r\n                            <h2 className={styles.username}>{user.username}</h2>\r\n                            {getVerificationBadge(user.followers)}\r\n\r\n                            <div className={styles.actionButtons}>\r\n                                <button className={styles.editButton} onClick={handleEditProfile}>\r\n                                    Edit Profile\r\n                                </button>\r\n                                <button className={styles.archiveBtn} onClick={() => setIsArchiveOpen(true)}>\r\n                                    View Archive\r\n                                </button>\r\n                                <button\r\n                                    className={styles.monetizationBtn}\r\n                                    onClick={() => router.push('/monetization')}\r\n                                    title=\"Professional Dashboard\"\r\n                                >\r\n                                    <LayoutDashboard size={18} />\r\n                                </button>\r\n                                <button className={styles.settingsBtn} onClick={handleSettings}>\r\n                                    <Settings size={22} />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className={styles.statsRow}>\r\n                            <div className={styles.statItem}>\r\n                                <span className={styles.statNumber}>{user.posts.length}</span>\r\n                                <span className={styles.statLabel}>posts</span>\r\n                            </div>\r\n                            <div className={styles.statItem} title={`${user.followers.toLocaleString()} followers`}>\r\n                                <span className={styles.statNumber}>{formatFollowers(user.followers)}</span>\r\n                                <span className={styles.statLabel}>followers</span>\r\n                            </div>\r\n                            <div className={styles.statItem}>\r\n                                <span className={styles.statNumber}>450</span>\r\n                                <span className={styles.statLabel}>following</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className={styles.bioSection}>\r\n                            <h1 className={styles.fullName}>{user.username}</h1>\r\n                            {user.category && user.category !== 'None' && <span className={styles.categoryLabel}>{user.category}</span>}\r\n                            <div className={styles.bioText}>\r\n                                {user.bio}\r\n                                {user.website && (\r\n                                    <>\r\n                                        <br />\r\n                                        ≡ƒöù <a href={`https://${user.website}`} target=\"_blank\" rel=\"noopener noreferrer\" className={styles.link}>{user.website}</a>\r\n                                    </>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Story Highlights */}\r\n                <div className={styles.highlightsSection}>\r\n                    {[\r\n                        { id: 1, name: 'Travel', img: 'https://picsum.photos/seed/travel/200' },\r\n                        { id: 2, name: 'Art', img: 'https://picsum.photos/seed/art/200' },\r\n                        { id: 3, name: 'Food', img: 'https://picsum.photos/seed/food/200' },\r\n                        { id: 4, name: 'Life', img: 'https://picsum.photos/seed/life/200' },\r\n                        { id: 5, name: 'Tech', img: 'https://picsum.photos/seed/tech/200' },\r\n                    ].map((item) => (\r\n                        <div key={item.id} className={styles.highlightItem}>\r\n                            <div className={styles.highlightCircle}>\r\n                                <img src={item.img} alt={item.name} className={styles.highlightImg} />\r\n                            </div>\r\n                            <span className={styles.highlightName}>{item.name}</span>\r\n                        </div>\r\n                    ))}\r\n                    <div className={styles.highlightItem}>\r\n                        <div className={`${styles.highlightCircle} ${styles.newHighlight}`}>\r\n                            <span>+</span>\r\n                        </div>\r\n                        <span className={styles.highlightName}>New</span>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Tabs */}\r\n                <div className={styles.tabs}>\r\n                    <button\r\n                        className={`${styles.tab} ${activeTab === 'posts' ? styles.activeTab : ''}`}\r\n                        onClick={() => setActiveTab('posts')}\r\n                    >\r\n                        <Grid size={12} strokeWidth={2.5} />\r\n                        <span>POSTS</span>\r\n                    </button>\r\n                    <button\r\n                        className={`${styles.tab} ${activeTab === 'saved' ? styles.activeTab : ''}`}\r\n                        onClick={() => setActiveTab('saved')}\r\n                    >\r\n                        <Bookmark size={12} strokeWidth={2.5} />\r\n                        <span>SAVED</span>\r\n                    </button>\r\n                    <button\r\n                        className={`${styles.tab} ${activeTab === 'shots' ? styles.activeTab : ''}`}\r\n                        onClick={() => setActiveTab('shots')}\r\n                    >\r\n                        <Clapperboard size={12} strokeWidth={2.5} />\r\n                        <span>SHOTS</span>\r\n                    </button>\r\n                    <button\r\n                        className={`${styles.tab} ${activeTab === 'tagged' ? styles.activeTab : ''}`}\r\n                        onClick={() => setActiveTab('tagged')}\r\n                    >\r\n                        <UserSquare2 size={12} strokeWidth={2.5} />\r\n                        <span>TAGGED</span>\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Grid */}\r\n                {activeTab === 'posts' && (\r\n                    <div className={styles.grid}>\r\n                        {user.posts.map((post, index) => (\r\n                            <div\r\n                                key={post.id}\r\n                                className={styles.gridItem}\r\n                                style={{ animationDelay: `${index * 0.05}s` }}\r\n                                onClick={() => setSelectedPost(post)}\r\n                            >\r\n                                <img src={post.image} alt=\"\" className={styles.gridImage} />\r\n                                <div className={styles.overlay}>\r\n                                    <div className={styles.overlayStats}>\r\n                                        <span>Γ¥ñ∩╕Å {post.likes}</span>\r\n                                        <span>≡ƒÆ¼ {post.comments}</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n\r\n                {activeTab === 'shots' && (\r\n                    <div className={styles.grid}>\r\n                        {user.shots && user.shots.length > 0 ? (\r\n                            user.shots.map((shot, index) => (\r\n                                <div\r\n                                    key={shot.id}\r\n                                    className={styles.gridItem}\r\n                                    style={{\r\n                                        animationDelay: `${index * 0.05}s`,\r\n                                        aspectRatio: '9/16'\r\n                                    }}\r\n                                >\r\n                                    <video\r\n                                        src={shot.video}\r\n                                        className={styles.gridImage}\r\n                                        style={{ objectFit: 'cover' }}\r\n                                        muted\r\n                                        loop\r\n                                        onMouseOver={e => e.currentTarget.play()}\r\n                                        onMouseOut={e => {\r\n                                            e.currentTarget.pause();\r\n                                            e.currentTarget.currentTime = 0;\r\n                                        }}\r\n                                    />\r\n                                    <div className={styles.overlay}>\r\n                                        <div className={styles.overlayStats}>\r\n                                            <span style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                                <Play size={14} fill=\"white\" /> {(shot.likes * 12).toLocaleString()}\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            ))\r\n                        ) : (\r\n                            <div className={styles.noPosts}>\r\n                                <div className={styles.noPostsIcon}>≡ƒÄ¼</div>\r\n                                <h3>No Shots Yet</h3>\r\n                                <p>Vertical videos you create will appear here.</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                )}\r\n\r\n                {activeTab === 'saved' && (\r\n                    <div className={styles.emptyTabState}>\r\n                        <Bookmark size={64} strokeWidth={1} />\r\n                        <h3>No Saved Posts</h3>\r\n                        <p>Save posts to see them here</p>\r\n                    </div>\r\n                )}\r\n\r\n                {activeTab === 'tagged' && (\r\n                    <div className={styles.emptyTabState}>\r\n                        <UserSquare2 size={64} strokeWidth={1} />\r\n                        <h3>No Tagged Posts</h3>\r\n                        <p>Posts you&apos;re tagged in will appear here</p>\r\n                    </div>\r\n                )}\r\n\r\n                {activeTab === 'posts' && user.posts.length === 0 && (\r\n                    <div className={styles.noPosts}>\r\n                        <div className={styles.noPostsIcon}>≡ƒô╖</div>\r\n                        <h3>No Posts Yet</h3>\r\n                        <p>When you share photos, they will appear here.</p>\r\n                    </div>\r\n                )}\r\n\r\n                <div style={{ marginTop: '48px', paddingBottom: '24px', borderTop: '1px solid rgba(255,255,255,0.1)' }}>\r\n                    <Footer />\r\n                </div>\r\n            </div>\r\n\r\n            {user && (\r\n                <EditProfileModal\r\n                    isOpen={isEditProfileOpen}\r\n                    onClose={() => setIsEditProfileOpen(false)}\r\n                    initialData={{\r\n                        username: user.username,\r\n                        fullName: 'Aster Viewer', // Using a default or adding fullName to User interface later\r\n                        bio: user.bio || '',\r\n                        avatar: user.avatar\r\n                    }}\r\n                    onSave={handleSaveProfile}\r\n                />\r\n            )}\r\n\r\n            {user && (\r\n                <ArchiveModal\r\n                    isOpen={isArchiveOpen}\r\n                    onClose={() => setIsArchiveOpen(false)}\r\n                    posts={user.posts}\r\n                />\r\n            )}\r\n\r\n            <SettingsModal\r\n                isOpen={isSettingsOpen}\r\n                onClose={() => setIsSettingsOpen(false)}\r\n                onProfileUpdate={handleSaveProfile}\r\n            />\r\n\r\n            {selectedPost && (\r\n                <PostDetailModal\r\n                    post={selectedPost}\r\n                    isOpen={!!selectedPost}\r\n                    onClose={() => setSelectedPost(null)}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ProfilePage;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\search\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[531,534],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[531,534],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[601,604],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[601,604],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1546,1549],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1546,1549],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":121,"column":41,"nodeType":"JSXOpeningElement","endLine":121,"endColumn":118},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":156,"column":41,"nodeType":"JSXOpeningElement","endLine":156,"endColumn":94},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":171,"column":45,"nodeType":"JSXOpeningElement","endLine":171,"endColumn":122}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { Search, X, TrendingUp } from 'lucide-react';\r\nimport styles from './search.module.css';\r\n\r\nconst SearchPage = () => {\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [activeTab, setActiveTab] = useState('Top');\r\n    const [isFocused, setIsFocused] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    const tabs = ['Top', 'Accounts', 'Audio', 'Tags', 'Places'];\r\n\r\n    const [recentUsers, setRecentUsers] = useState<any[]>([]);\r\n    const [discoveryPosts, setDiscoveryPosts] = useState<any[]>([]);\r\n\r\n    const trendingTags = [\r\n        { name: '#photography', posts: '1.2M' },\r\n        { name: '#travel', posts: '890K' },\r\n        { name: '#art', posts: '500K' },\r\n        { name: '#nature', posts: '2.5M' },\r\n    ];\r\n\r\n    React.useEffect(() => {\r\n        const fetchData = async () => {\r\n            try {\r\n                // Fetch recent users (simulate with all users for now)\r\n                const usersRes = await fetch('/api/users');\r\n                if (usersRes.ok) {\r\n                    const users = await usersRes.json();\r\n                    setRecentUsers(users.slice(0, 5));\r\n                }\r\n\r\n                // Fetch posts for explore\r\n                const postsRes = await fetch('/api/posts');\r\n                if (postsRes.ok) {\r\n                    const posts = await postsRes.json();\r\n                    // Transform posts to grid format if needed\r\n                    const gridPosts = posts.map((p: any, i: number) => ({\r\n                        id: p.id,\r\n                        image: p.image,\r\n                        span: i % 5 === 0 ? 'span 2' : 'span 1' // Simple grid logic\r\n                    }));\r\n                    setDiscoveryPosts(gridPosts);\r\n                }\r\n            } catch (err) {\r\n                console.error('Search page fetch error', err);\r\n            }\r\n        };\r\n        fetchData();\r\n    }, []);\r\n\r\n    // Simulate search\r\n    const handleSearch = (term: string) => {\r\n        setSearchTerm(term);\r\n        if (term) {\r\n            setIsLoading(true);\r\n            setTimeout(() => setIsLoading(false), 500);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <div className={`${styles.searchPage} fade-in`}>\r\n\r\n                {/* Sticky Header */}\r\n                <div className={styles.stickyHeader}>\r\n                    <div className={`${styles.searchBarWrapper} ${isFocused ? styles.focused : ''}`}>\r\n                        <Search size={20} className={styles.searchIcon} />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search\"\r\n                            className={styles.searchInput}\r\n                            value={searchTerm}\r\n                            onChange={(e) => handleSearch(e.target.value)}\r\n                            onFocus={() => setIsFocused(true)}\r\n                            onBlur={() => setIsFocused(false)}\r\n                        />\r\n                        {searchTerm && (\r\n                            <button className={styles.clearBtn} onClick={() => setSearchTerm('')}>\r\n                                <X size={16} />\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Filter Tabs (Only show when searching or always if preferred, let's show when items are present or searching) */}\r\n                {searchTerm && (\r\n                    <div className={styles.tabsContainer}>\r\n                        {tabs.map(tab => (\r\n                            <button\r\n                                key={tab}\r\n                                className={`${styles.tab} ${activeTab === tab ? styles.activeTab : ''}`}\r\n                                onClick={() => setActiveTab(tab)}\r\n                            >\r\n                                {tab}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Main Content */}\r\n                <div className={styles.contentArea}>\r\n\r\n                    {isLoading ? (\r\n                        <div className={styles.loadingState}>\r\n                            <div className={styles.spinner}></div>\r\n                        </div>\r\n                    ) : !searchTerm ? (\r\n                        /* Default / Discovery View */\r\n                        <div className=\"fade-in\">\r\n                            {/* Search History */}\r\n                            <div className={styles.sectionHeader}>\r\n                                <h2>Recent</h2>\r\n                                <button className={styles.seeAllBtn}>See All</button>\r\n                            </div>\r\n                            <div className={styles.recentList}>\r\n                                {recentUsers.map(user => (\r\n                                    <div key={user.id} className={styles.recentItem}>\r\n                                        <img src={user.avatar} alt={user.username} className={styles.recentAvatar} />\r\n                                        <div className={styles.recentInfo}>\r\n                                            <span className={styles.recentUsername}>{user.username}</span>\r\n                                            <span className={styles.recentSub}>{user.fullName}</span>\r\n                                        </div>\r\n                                        <X size={14} className={styles.removeRecent} />\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n\r\n                            {/* Trending Tags */}\r\n                            <div className={styles.sectionHeader} style={{ marginTop: '24px' }}>\r\n                                <h2>Trending</h2>\r\n                                <TrendingUp size={16} className={styles.trendingIcon} />\r\n                            </div>\r\n                            <div className={styles.trendingGrid}>\r\n                                {trendingTags.map((tag, i) => (\r\n                                    <div key={i} className={styles.trendingTag}>\r\n                                        <span className={styles.tagName}>{tag.name}</span>\r\n                                        <span className={styles.tagCount}>{tag.posts} posts</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n\r\n                            {/* Explore / For You Grid */}\r\n                            <div className={styles.sectionHeader} style={{ marginTop: '32px' }}>\r\n                                <h2>Explore</h2>\r\n                            </div>\r\n                            <div className={styles.masonryGrid}>\r\n                                {discoveryPosts.map((post, i) => (\r\n                                    <div\r\n                                        key={post.id}\r\n                                        className={styles.gridItem}\r\n                                        style={{ gridRow: post.span, animationDelay: `${i * 0.1}s` }}\r\n                                    >\r\n                                        <img src={post.image} alt=\"Explore\" loading=\"lazy\" />\r\n                                        <div className={styles.itemOverlay}>\r\n                                            <TrendingUp size={24} color=\"white\" />\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    ) : (\r\n                        /* Search Results View */\r\n                        <div className={`${styles.resultsContainer} fade-in`}>\r\n                            {activeTab === 'Top' || activeTab === 'Accounts' ? (\r\n                                <div className={styles.peopleList}>\r\n                                    {recentUsers.filter(u => u.username.includes(searchTerm.toLowerCase())).map(user => (\r\n                                        <div key={user.id} className={styles.resultUserItem}>\r\n                                            <img src={user.avatar} alt={user.username} className={styles.resultAvatar} />\r\n                                            <div className={styles.resultInfo}>\r\n                                                <div className={styles.nameRow}>\r\n                                                    <span className={styles.resultUsername}>{user.username}</span>\r\n                                                    {user.isVerified && <div className={styles.verifiedBadge}>Γ£ô</div>}\r\n                                                </div>\r\n                                                <span className={styles.resultSub}>{user.fullName} ΓÇó {user.followers} followers</span>\r\n                                            </div>\r\n                                            <button className={styles.followBtn}>Follow</button>\r\n                                        </div>\r\n                                    ))}\r\n                                    {recentUsers.filter(u => u.username.includes(searchTerm.toLowerCase())).length === 0 && (\r\n                                        <div className={styles.emptyState}>No results found.</div>\r\n                                    )}\r\n                                </div>\r\n                            ) : (\r\n                                <div className={styles.emptyState}>\r\n                                    No results for {activeTab} yet.\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SearchPage;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\app\\shots\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pause' is defined but never used.","line":4,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":39,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pause"},"fix":{"range":[109,116],"text":""},"desc":"Remove unused variable \"Pause\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[472,475],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[472,475],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isPending' is assigned a value but never used.","line":17,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1618,1621],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1618,1621],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1888,1891],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1888,1891],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":148,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5066,5069],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5066,5069],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":164,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5606,5609],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5606,5609],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":256,"column":37,"nodeType":"JSXOpeningElement","endLine":256,"endColumn":108}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport { Volume2, VolumeX, Play, Pause, Heart, MessageCircle, Send, Bookmark, MoreHorizontal } from 'lucide-react';\r\nimport styles from './shots.module.css';\r\nimport Loader from '@/components/Loader';\r\nimport { toggleShotLike, toggleSavedShot } from '@/app/actions';\r\n\r\nconst ShotsPage = () => {\r\n    const [currentIndex, setCurrentIndex] = useState(0);\r\n    const [shots, setShots] = useState<any[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [isMuted, setIsMuted] = useState(true);\r\n    const [isPlaying, setIsPlaying] = useState(true);\r\n    const [progress, setProgress] = useState(0);\r\n    const [showHeart, setShowHeart] = useState(false);\r\n    const [isPending, startTransition] = React.useTransition();\r\n\r\n    const videoRefs = useRef<(HTMLVideoElement | null)[]>([]);\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n    const fetchShots = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const res = await fetch('/api/shots');\r\n            if (!res.ok) {\r\n                const text = await res.text().catch(() => '');\r\n                console.warn('Shots API responded with error:', res.status, text);\r\n                setShots([]);\r\n                return;\r\n            }\r\n\r\n            const data = await res.json().catch(() => null);\r\n\r\n            if (!Array.isArray(data)) {\r\n                console.warn('Shots API returned non-array, using empty list instead.');\r\n                setShots([]);\r\n                return;\r\n            }\r\n            setShots(data.map((s: any) => ({\r\n                ...s,\r\n                username: s.user.username,\r\n                avatar: s.user.avatar,\r\n                likesCount: s.likes?.length || 0,\r\n                commentsCount: s.comments?.length || 0,\r\n                isLiked: s.likes?.some((l: any) => l.userId === 'demo_user'),\r\n                isSaved: false\r\n            })));\r\n        } catch (err) {\r\n            console.error('Failed to fetch shots:', err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchShots();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (loading || shots.length === 0) return;\r\n\r\n        const observerOptions = {\r\n            root: containerRef.current,\r\n            threshold: 0.6,\r\n        };\r\n\r\n        const handleIntersection = (entries: IntersectionObserverEntry[]) => {\r\n            entries.forEach((entry) => {\r\n                const video = entry.target as HTMLVideoElement;\r\n                const index = videoRefs.current.indexOf(video);\r\n\r\n                if (entry.isIntersecting) {\r\n                    setTimeout(() => {\r\n                        video.play().catch(err => console.log('Auto-play prevented:', err));\r\n                        setCurrentIndex(index);\r\n                    }, 300);\r\n                } else {\r\n                    video.pause();\r\n                    video.currentTime = 0;\r\n                }\r\n            });\r\n        };\r\n\r\n        const observer = new IntersectionObserver(handleIntersection, observerOptions);\r\n\r\n        videoRefs.current.forEach((video) => {\r\n            if (video) observer.observe(video);\r\n        });\r\n\r\n        return () => observer.disconnect();\r\n    }, [shots, loading]);\r\n\r\n    useEffect(() => {\r\n        const currentVideo = videoRefs.current[currentIndex];\r\n        if (!currentVideo) return;\r\n\r\n        const updateProgress = () => {\r\n            if (currentVideo.duration) {\r\n                setProgress((currentVideo.currentTime / currentVideo.duration) * 100);\r\n            }\r\n        };\r\n\r\n        currentVideo.addEventListener('timeupdate', updateProgress);\r\n        setIsPlaying(!currentVideo.paused);\r\n        currentVideo.muted = isMuted;\r\n\r\n        return () => {\r\n            currentVideo.removeEventListener('timeupdate', updateProgress);\r\n        };\r\n    }, [currentIndex, isMuted, loading]);\r\n\r\n    const togglePlayPause = () => {\r\n        const currentVideo = videoRefs.current[currentIndex];\r\n        if (currentVideo) {\r\n            if (currentVideo.paused) {\r\n                currentVideo.play();\r\n                setIsPlaying(true);\r\n            } else {\r\n                currentVideo.pause();\r\n                setIsPlaying(false);\r\n            }\r\n        }\r\n    };\r\n\r\n    const toggleMute = (e?: React.MouseEvent) => {\r\n        e?.stopPropagation();\r\n        const newMutedState = !isMuted;\r\n        setIsMuted(newMutedState);\r\n        videoRefs.current.forEach(video => {\r\n            if (video) video.muted = newMutedState;\r\n        });\r\n    };\r\n\r\n    const handleDoubleClick = (id: string) => {\r\n        handleLike(id, true);\r\n        setShowHeart(true);\r\n        setTimeout(() => setShowHeart(false), 1000);\r\n    };\r\n\r\n    const handleLike = (id: string, forceLike = false) => {\r\n        const shot = shots.find(s => s.id === id);\r\n        if (!shot) return;\r\n        if (forceLike && shot.isLiked) return;\r\n\r\n        const newIsLiked = !shot.isLiked;\r\n\r\n        setShots((prev: any[]) => prev.map(s => {\r\n            if (s.id === id) {\r\n                return {\r\n                    ...s,\r\n                    isLiked: newIsLiked,\r\n                    likesCount: newIsLiked ? s.likesCount + 1 : s.likesCount - 1\r\n                };\r\n            }\r\n            return s;\r\n        }));\r\n\r\n        startTransition(async () => {\r\n            try {\r\n                await toggleShotLike(id);\r\n            } catch (err) {\r\n                console.error('Failed to toggle shot like:', err);\r\n                setShots((prev: any[]) => prev.map(s => {\r\n                    if (s.id === id) {\r\n                        return {\r\n                            ...s,\r\n                            isLiked: !newIsLiked,\r\n                            likesCount: !newIsLiked ? s.likesCount + 1 : s.likesCount - 1\r\n                        };\r\n                    }\r\n                    return s;\r\n                }));\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n    const handleSave = (id: string) => {\r\n        setShots(prev => prev.map(s => {\r\n            if (s.id === id) {\r\n                return { ...s, isSaved: !s.isSaved };\r\n            }\r\n            return s;\r\n        }));\r\n\r\n        startTransition(async () => {\r\n            try {\r\n                await toggleSavedShot(id);\r\n            } catch (err) {\r\n                console.error('Failed to toggle saved shot:', err);\r\n                setShots(prev => prev.map(s => {\r\n                    if (s.id === id) {\r\n                        return { ...s, isSaved: !s.isSaved };\r\n                    }\r\n                    return s;\r\n                }));\r\n            }\r\n        });\r\n    };\r\n\r\n    const formatNumber = (num: number) => {\r\n        if (num >= 1000000) return `${(num / 1000000).toFixed(1)}M`;\r\n        if (num >= 1000) return `${(num / 1000).toFixed(1)}K`;\r\n        return num.toString();\r\n    };\r\n\r\n    return (\r\n        <div className={styles.shotsContainer}>\r\n            <div className={styles.header}>\r\n                <h1 className={styles.title}>Shots</h1>\r\n            </div>\r\n\r\n            {loading ? (\r\n                <div style={{ height: '100%', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>\r\n                    <Loader size=\"large\" />\r\n                </div>\r\n            ) : shots.length === 0 ? (\r\n                <div style={{ height: '100%', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', gap: '16px' }}>\r\n                    <Play size={48} color=\"var(--accent)\" />\r\n                    <p style={{ color: 'var(--accent)' }}>No shots found.</p>\r\n                </div>\r\n            ) : (\r\n                <div ref={containerRef} className={styles.shotsFeed}>\r\n                    {shots.map((shot, index) => (\r\n                        <div key={shot.id} className={styles.shotItem}>\r\n                            <div className={styles.videoWrapper} onDoubleClick={() => handleDoubleClick(shot.id)} onClick={togglePlayPause}>\r\n                                <video\r\n                                    ref={el => { videoRefs.current[index] = el; }}\r\n                                    className={styles.video}\r\n                                    src={shot.video}\r\n                                    loop\r\n                                    muted={isMuted}\r\n                                    playsInline\r\n                                />\r\n                                <div className={`${styles.bigHeart} ${showHeart && index === currentIndex ? styles.animateHeart : ''}`}>\r\n                                    <Heart size={100} fill=\"white\" color=\"white\" />\r\n                                </div>\r\n                                {!isPlaying && index === currentIndex && (\r\n                                    <div className={styles.playOverlay}><Play size={48} fill=\"white\" /></div>\r\n                                )}\r\n                            </div>\r\n                            <div className={styles.gradientOverlay} />\r\n                            <div className={styles.progressBarContainer}>\r\n                                <div className={styles.progressBar} style={{ width: `${index === currentIndex ? progress : 0}%` }} />\r\n                            </div>\r\n                            <div className={styles.topControls}>\r\n                                <div className={styles.topRight}>\r\n                                    <button className={styles.muteBtn} onClick={toggleMute}>\r\n                                        {isMuted ? <VolumeX size={20} /> : <Volume2 size={20} />}\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                            <div className={styles.bottomInfo}>\r\n                                <div className={styles.userInfo}>\r\n                                    <img src={shot.avatar} alt={shot.username} className={styles.avatar} />\r\n                                    <span className={styles.username}>{shot.username}</span>\r\n                                    <button className={styles.followBtn}>Follow</button>\r\n                                </div>\r\n                                <p className={styles.caption}>{shot.caption}</p>\r\n                                <div className={styles.musicInfo}>\r\n                                    <div className={styles.musicIcon}>≡ƒÄ╡</div>\r\n                                    <div className={styles.musicTicker}><span>{shot.music || 'Original Audio'}</span></div>\r\n                                </div>\r\n                            </div>\r\n                            <div className={styles.sideActions}>\r\n                                <button className={`${styles.actionBtn} ${shot.isLiked ? styles.liked : ''}`} onClick={() => handleLike(shot.id)}>\r\n                                    <Heart size={28} fill={shot.isLiked ? '#ff3b5c' : 'rgba(0,0,0,0.3)'} strokeWidth={shot.isLiked ? 0 : 2} />\r\n                                    <span>{formatNumber(shot.likesCount)}</span>\r\n                                </button>\r\n                                <button className={styles.actionBtn}><MessageCircle size={28} /><span>{formatNumber(shot.commentsCount)}</span></button>\r\n                                <button className={styles.actionBtn}><Send size={28} /></button>\r\n                                <button className={`${styles.actionBtn} ${shot.isSaved ? styles.saved : ''}`} onClick={() => handleSave(shot.id)}>\r\n                                    <Bookmark size={28} fill={shot.isSaved ? '#ffd700' : 'none'} color={shot.isSaved ? '#ffd700' : 'currentColor'} />\r\n                                </button>\r\n                                <button className={styles.actionBtn}><MoreHorizontal size={28} /></button>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ShotsPage;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\ArchiveModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":1,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":25,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useState"},"fix":{"range":[12,26],"text":""},"desc":"Remove unused variable \"useState\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":36,"column":33,"nodeType":"JSXOpeningElement","endLine":36,"endColumn":108}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { X, Calendar, Clock, Archive } from 'lucide-react';\r\nimport styles from './ArchiveModal.module.css';\r\nimport { Post } from '@/lib/mockData';\r\n\r\ninterface ArchiveModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    posts: Post[];\r\n}\r\n\r\nconst ArchiveModal: React.FC<ArchiveModalProps> = ({ isOpen, onClose, posts }) => {\r\n    // Mock archive (filter posts older than 30 days or randomly select some)\r\n    // For demo purposes, we'll just use a subset of posts\r\n    const archivedPosts = posts.length > 0 ? posts.slice(0, 3) : [];\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className={styles.overlay} onClick={onClose}>\r\n            <div className={styles.modal} onClick={e => e.stopPropagation()}>\r\n                <div className={styles.header}>\r\n                    <div className={styles.title}>\r\n                        <Archive size={20} />\r\n                        <h2>Archive</h2>\r\n                    </div>\r\n                    <button className={styles.closeBtn} onClick={onClose}>\r\n                        <X size={24} />\r\n                    </button>\r\n                </div>\r\n\r\n                <div className={styles.content}>\r\n                    {archivedPosts.length > 0 ? (\r\n                        archivedPosts.map(post => (\r\n                            <div key={post.id} className={styles.archiveItem}>\r\n                                <img src={post.image} alt={post.caption} className={styles.archiveImage} />\r\n                                <div className={styles.archiveDate}>\r\n                                    <Calendar size={12} style={{ marginRight: 4, display: 'inline' }} />\r\n                                    {new Date(post.createdAt).toLocaleDateString()}\r\n                                </div>\r\n                            </div>\r\n                        ))\r\n                    ) : (\r\n                        <div className={styles.emptyState}>\r\n                            <Clock size={48} />\r\n                            <p>No archived stories or posts.</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ArchiveModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\ChangePasswordModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'hasSpecialChar' is assigned a value but never used.","line":26,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { X, Key, Eye, EyeOff, Check } from 'lucide-react';\r\nimport styles from './ChangePasswordModal.module.css';\r\n\r\ninterface ChangePasswordModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nconst ChangePasswordModal: React.FC<ChangePasswordModalProps> = ({ isOpen, onClose }) => {\r\n    const [currentPassword, setCurrentPassword] = useState('');\r\n    const [newPassword, setNewPassword] = useState('');\r\n    const [confirmPassword, setConfirmPassword] = useState('');\r\n    const [showCurrentPassword, setShowCurrentPassword] = useState(false);\r\n    const [showNewPassword, setShowNewPassword] = useState(false);\r\n    const [showConfirmPassword, setShowConfirmPassword] = useState(false);\r\n    const [error, setError] = useState('');\r\n\r\n    if (!isOpen) return null;\r\n\r\n    // Password requirements\r\n    const hasMinLength = newPassword.length >= 8;\r\n    const hasUpperCase = /[A-Z]/.test(newPassword);\r\n    const hasLowerCase = /[a-z]/.test(newPassword);\r\n    const hasNumber = /[0-9]/.test(newPassword);\r\n    const hasSpecialChar = /[!@#$%^&*(),.?\":{}|<>]/.test(newPassword);\r\n\r\n    const isPasswordValid = hasMinLength && hasUpperCase && hasLowerCase && hasNumber;\r\n\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError('');\r\n\r\n        if (!currentPassword) {\r\n            setError('Please enter your current password');\r\n            return;\r\n        }\r\n\r\n        if (!isPasswordValid) {\r\n            setError('New password does not meet requirements');\r\n            return;\r\n        }\r\n\r\n        if (newPassword !== confirmPassword) {\r\n            setError('New passwords do not match');\r\n            return;\r\n        }\r\n\r\n        // In a real app, this would call an API\r\n        console.log('Password change submitted');\r\n        alert('Password changed successfully! ≡ƒöÆ');\r\n        onClose();\r\n\r\n        // Reset form\r\n        setCurrentPassword('');\r\n        setNewPassword('');\r\n        setConfirmPassword('');\r\n    };\r\n\r\n    return (\r\n        <div className={styles.overlay} onClick={onClose}>\r\n            <div className={styles.modal} onClick={e => e.stopPropagation()}>\r\n                <div className={styles.header}>\r\n                    <div className={styles.title}>\r\n                        <Key size={20} />\r\n                        <h2>Change Password</h2>\r\n                    </div>\r\n                    <button className={styles.closeBtn} onClick={onClose}>\r\n                        <X size={24} />\r\n                    </button>\r\n                </div>\r\n\r\n                <form className={styles.form} onSubmit={handleSubmit}>\r\n                    <div className={styles.inputGroup}>\r\n                        <label className={styles.label}>Current Password</label>\r\n                        <div className={styles.inputWrapper}>\r\n                            <input\r\n                                type={showCurrentPassword ? 'text' : 'password'}\r\n                                value={currentPassword}\r\n                                onChange={(e) => setCurrentPassword(e.target.value)}\r\n                                className={styles.input}\r\n                                placeholder=\"Enter current password\"\r\n                            />\r\n                            <button\r\n                                type=\"button\"\r\n                                className={styles.togglePassword}\r\n                                onClick={() => setShowCurrentPassword(!showCurrentPassword)}\r\n                            >\r\n                                {showCurrentPassword ? <EyeOff size={18} /> : <Eye size={18} />}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className={styles.inputGroup}>\r\n                        <label className={styles.label}>New Password</label>\r\n                        <div className={styles.inputWrapper}>\r\n                            <input\r\n                                type={showNewPassword ? 'text' : 'password'}\r\n                                value={newPassword}\r\n                                onChange={(e) => setNewPassword(e.target.value)}\r\n                                className={styles.input}\r\n                                placeholder=\"Enter new password\"\r\n                            />\r\n                            <button\r\n                                type=\"button\"\r\n                                className={styles.togglePassword}\r\n                                onClick={() => setShowNewPassword(!showNewPassword)}\r\n                            >\r\n                                {showNewPassword ? <EyeOff size={18} /> : <Eye size={18} />}\r\n                            </button>\r\n                        </div>\r\n                        {newPassword && (\r\n                            <div className={styles.requirements}>\r\n                                <div className={`${styles.requirement} ${hasMinLength ? styles.met : ''}`}>\r\n                                    {hasMinLength ? <Check size={14} /> : 'ΓÇó'} At least 8 characters\r\n                                </div>\r\n                                <div className={`${styles.requirement} ${hasUpperCase ? styles.met : ''}`}>\r\n                                    {hasUpperCase ? <Check size={14} /> : 'ΓÇó'} One uppercase letter\r\n                                </div>\r\n                                <div className={`${styles.requirement} ${hasLowerCase ? styles.met : ''}`}>\r\n                                    {hasLowerCase ? <Check size={14} /> : 'ΓÇó'} One lowercase letter\r\n                                </div>\r\n                                <div className={`${styles.requirement} ${hasNumber ? styles.met : ''}`}>\r\n                                    {hasNumber ? <Check size={14} /> : 'ΓÇó'} One number\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className={styles.inputGroup}>\r\n                        <label className={styles.label}>Confirm New Password</label>\r\n                        <div className={styles.inputWrapper}>\r\n                            <input\r\n                                type={showConfirmPassword ? 'text' : 'password'}\r\n                                value={confirmPassword}\r\n                                onChange={(e) => setConfirmPassword(e.target.value)}\r\n                                className={`${styles.input} ${confirmPassword && newPassword !== confirmPassword ? styles.error : ''}`}\r\n                                placeholder=\"Confirm new password\"\r\n                            />\r\n                            <button\r\n                                type=\"button\"\r\n                                className={styles.togglePassword}\r\n                                onClick={() => setShowConfirmPassword(!showConfirmPassword)}\r\n                            >\r\n                                {showConfirmPassword ? <EyeOff size={18} /> : <Eye size={18} />}\r\n                            </button>\r\n                        </div>\r\n                        {confirmPassword && newPassword !== confirmPassword && (\r\n                            <div className={styles.errorText}>Passwords do not match</div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {error && <div className={styles.errorText}>{error}</div>}\r\n\r\n                    <div className={styles.footer}>\r\n                        <button type=\"button\" className=\"btn-secondary\" onClick={onClose}>Cancel</button>\r\n                        <button type=\"submit\" className=\"btn-primary\" disabled={!isPasswordValid || newPassword !== confirmPassword}>\r\n                            Change Password\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ChangePasswordModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\EditProfileModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Lock' is defined but never used.","line":2,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":32,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Lock"},"fix":{"range":[67,73],"text":""},"desc":"Remove unused variable \"Lock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkles' is defined but never used.","line":2,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":55,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sparkles"},"fix":{"range":[86,96],"text":""},"desc":"Remove unused variable \"Sparkles\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[492,495],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[492,495],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":74,"column":33,"nodeType":"JSXOpeningElement","endLine":74,"endColumn":101}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { X, Camera, Globe, Lock, ShieldCheck, Sparkles } from 'lucide-react';\r\nimport styles from './EditProfileModal.module.css';\r\n\r\ninterface EditProfileModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    initialData: {\r\n        username: string;\r\n        fullName: string;\r\n        bio: string;\r\n        avatar: string;\r\n        website?: string;\r\n        category?: string;\r\n        isPrivate?: boolean;\r\n    };\r\n    onSave: (data: any) => void;\r\n}\r\n\r\nconst CATEGORIES = [\r\n    'None',\r\n    'Artist',\r\n    'Blogger',\r\n    'Digital Creator',\r\n    'Education',\r\n    'Entrepreneur',\r\n    'Health/Beauty',\r\n    'Editor',\r\n    'Writer',\r\n    'Personal Blog'\r\n];\r\n\r\nconst EditProfileModal: React.FC<EditProfileModalProps> = ({ isOpen, onClose, initialData, onSave }) => {\r\n    const [formData, setFormData] = useState({\r\n        ...initialData,\r\n        website: initialData.website || '',\r\n        category: initialData.category || 'Digital Creator',\r\n        isPrivate: initialData.isPrivate || false\r\n    });\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {\r\n        const { name, value, type } = e.target;\r\n        const val = type === 'checkbox' ? (e.target as HTMLInputElement).checked : value;\r\n\r\n        setFormData(prev => ({\r\n            ...prev,\r\n            [name]: val\r\n        }));\r\n    };\r\n\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        onSave(formData);\r\n        onClose();\r\n    };\r\n\r\n    return (\r\n        <div className={styles.overlay} onClick={onClose}>\r\n            <div className={styles.modal} onClick={e => e.stopPropagation()}>\r\n                <div className={styles.header}>\r\n                    <h2 className={styles.title}>Edit Profile</h2>\r\n                    <button className={styles.closeBtn} onClick={onClose}>\r\n                        <X size={20} />\r\n                    </button>\r\n                </div>\r\n\r\n                <form onSubmit={handleSubmit} style={{ display: 'contents' }}>\r\n                    <div className={styles.scrollArea}>\r\n                        {/* Avatar Section */}\r\n                        <div className={styles.avatarSection}>\r\n                            <div className={styles.avatarContainer} onClick={() => document.getElementById('avatar-input')?.click()}>\r\n                                <img src={formData.avatar} alt=\"Avatar\" className={styles.avatar} />\r\n                                <div className={styles.avatarOverlay}>\r\n                                    <Camera size={24} />\r\n                                </div>\r\n                            </div>\r\n                            <span className={styles.changePhotoText} onClick={() => document.getElementById('avatar-input')?.click()}>\r\n                                Change profile photo\r\n                            </span>\r\n                            <input\r\n                                id=\"avatar-input\"\r\n                                type=\"file\"\r\n                                hidden\r\n                                accept=\"image/*\"\r\n                                onChange={() => {\r\n                                    const url = prompt(\"Enter image URL:\", formData.avatar);\r\n                                    if (url) setFormData(p => ({ ...p, avatar: url }));\r\n                                }}\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Personal Info Section */}\r\n                        <div className={styles.section}>\r\n                            <div className={styles.sectionHeader}>\r\n                                <span className={styles.sectionTitle}>Profile Info</span>\r\n                            </div>\r\n\r\n                            <div className={styles.inputGroup}>\r\n                                <label className={styles.label}>Name</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    name=\"fullName\"\r\n                                    value={formData.fullName}\r\n                                    onChange={handleChange}\r\n                                    className={styles.input}\r\n                                    placeholder=\"Full Name\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div className={styles.inputGroup}>\r\n                                <label className={styles.label}>Username</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    name=\"username\"\r\n                                    value={formData.username}\r\n                                    onChange={handleChange}\r\n                                    className={styles.input}\r\n                                    placeholder=\"Username\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div className={styles.inputGroup}>\r\n                                <label className={styles.label}>Website</label>\r\n                                <div style={{ position: 'relative' }}>\r\n                                    <Globe size={16} style={{ position: 'absolute', left: '12px', top: '50%', transform: 'translateY(-50%)', color: 'var(--foreground-muted)' }} />\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        name=\"website\"\r\n                                        value={formData.website}\r\n                                        onChange={handleChange}\r\n                                        className={styles.input}\r\n                                        style={{ paddingLeft: '38px' }}\r\n                                        placeholder=\"https://example.com\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className={styles.inputGroup}>\r\n                                <label className={styles.label}>Bio</label>\r\n                                <textarea\r\n                                    name=\"bio\"\r\n                                    value={formData.bio}\r\n                                    onChange={handleChange}\r\n                                    className={styles.textarea}\r\n                                    placeholder=\"Write a bio...\"\r\n                                    maxLength={150}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Professional Section */}\r\n                        <div className={styles.section}>\r\n                            <div className={styles.sectionHeader}>\r\n                                <span className={styles.sectionTitle}>Professional Tools</span>\r\n                            </div>\r\n\r\n                            <div className={styles.inputGroup}>\r\n                                <label className={styles.label}>Category</label>\r\n                                <select\r\n                                    name=\"category\"\r\n                                    value={formData.category}\r\n                                    onChange={handleChange}\r\n                                    className={styles.select}\r\n                                >\r\n                                    {CATEGORIES.map(cat => (\r\n                                        <option key={cat} value={cat}>{cat}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Advanced/Privacy Section */}\r\n                        <div className={styles.section}>\r\n                            <div className={styles.sectionHeader}>\r\n                                <span className={styles.sectionTitle}>Privacy & Safety</span>\r\n                            </div>\r\n\r\n                            <div className={styles.toggleItem}>\r\n                                <div className={styles.toggleInfo}>\r\n                                    <span className={styles.toggleTitle}>Private Account</span>\r\n                                    <span className={styles.toggleDescription}>When your account is private, only people you approve can see your photos and videos.</span>\r\n                                </div>\r\n                                <label className={styles.switch}>\r\n                                    <input\r\n                                        type=\"checkbox\"\r\n                                        name=\"isPrivate\"\r\n                                        checked={formData.isPrivate}\r\n                                        onChange={handleChange}\r\n                                    />\r\n                                    <span className={styles.slider}></span>\r\n                                </label>\r\n                            </div>\r\n\r\n                            <div className={styles.toggleItem}>\r\n                                <div className={styles.toggleInfo}>\r\n                                    <span className={styles.toggleTitle}>Show Verification Badge</span>\r\n                                    <span className={styles.toggleDescription}>Display a silver or gold checkmark based on your influence score.</span>\r\n                                </div>\r\n                                <ShieldCheck size={24} color=\"var(--primary)\" />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className={styles.footer}>\r\n                        <button type=\"button\" className={styles.cancelBtn} onClick={onClose}>Cancel</button>\r\n                        <button type=\"submit\" className={styles.saveBtn}>Save Changes</button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default EditProfileModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\Footer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\Loader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\MainLayout.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\MainLayout.tsx:25:13\n  23 |         const session = localStorage.getItem('viewer_session');\n  24 |         if (session) {\n> 25 |             setIsLoggedIn(true);\n     |             ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  26 |         }\n  27 |         setIsInitialized(true);\n  28 |     }, []);","line":25,"column":13,"nodeType":null,"endLine":25,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport Sidebar from './Sidebar';\r\nimport styles from './MainLayout.module.css';\r\nimport { usePathname } from 'next/navigation';\r\nimport LandingPage from '@/app/LandingPage';\r\nimport Loader from './Loader';\r\nimport PageTransition from './PageTransition';\r\nimport TopHeader from './TopHeader';\r\n\r\ninterface MainLayoutProps {\r\n    children: React.ReactNode;\r\n}\r\n\r\nconst MainLayout: React.FC<MainLayoutProps> = ({ children }) => {\r\n    const [isLoggedIn, setIsLoggedIn] = useState<boolean>(false);\r\n    const [isInitialized, setIsInitialized] = useState<boolean>(false);\r\n    const pathname = usePathname();\r\n\r\n    useEffect(() => {\r\n        // Check local storage or cookie for session (mock)\r\n        const session = localStorage.getItem('viewer_session');\r\n        if (session) {\r\n            setIsLoggedIn(true);\r\n        }\r\n        setIsInitialized(true);\r\n    }, []);\r\n\r\n    const handleLogin = () => {\r\n        localStorage.setItem('viewer_session', 'true');\r\n        setIsLoggedIn(true);\r\n    };\r\n\r\n    if (!isInitialized) {\r\n        return (\r\n            <div className={styles.loaderContainer}>\r\n                <Loader size=\"large\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!isLoggedIn) {\r\n        return <LandingPage onLogin={handleLogin} />;\r\n    }\r\n\r\n    return (\r\n        <div className={styles.layout}>\r\n            <Sidebar />\r\n            <main className={styles.mainContent}>\r\n                <TopHeader />\r\n                <div\r\n                    className={styles.contentWrapper}\r\n                    style={{ paddingTop: pathname === '/shots' ? 0 : undefined }}\r\n                >\r\n                    <PageTransition>\r\n                        {children}\r\n                    </PageTransition>\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MainLayout;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\NotificationModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Video' is defined but never used.","line":4,"column":53,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":58,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Video"},"fix":{"range":[109,116],"text":""},"desc":"Remove unused variable \"Video\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":119,"column":41,"nodeType":"JSXOpeningElement","endLine":119,"endColumn":110},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":133,"column":41,"nodeType":"JSXOpeningElement","endLine":133,"endColumn":102}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { X, Heart, MessageCircle, UserPlus, AtSign, Video, Settings } from 'lucide-react';\r\nimport styles from './NotificationModal.module.css';\r\n\r\ninterface NotificationModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nconst MOCK_NOTIFICATIONS = [\r\n    { id: 1, type: 'like', user: 'sarah_j', name: 'Sarah Johnson', avatar: 'https://i.pravatar.cc/150?img=1', text: 'liked your photo', time: '2m ago', image: 'https://picsum.photos/seed/1/400', unread: true },\r\n    { id: 2, type: 'comment', user: 'mike_ross', name: 'Mike Ross', avatar: 'https://i.pravatar.cc/150?img=12', text: 'commented: \"Amazing shot! ≡ƒöÑ\"', time: '15m ago', image: 'https://picsum.photos/seed/2/400', unread: true },\r\n    { id: 3, type: 'follow', user: 'emma_w', name: 'Emma Wilson', avatar: 'https://i.pravatar.cc/150?img=5', text: 'started following you', time: '1h ago', unread: true },\r\n    { id: 4, type: 'mention', user: 'alex_dev', name: 'Alex Turner', avatar: 'https://i.pravatar.cc/150?img=8', text: 'mentioned you in a comment', time: '3h ago', image: 'https://picsum.photos/seed/3/400', unread: false },\r\n    { id: 5, type: 'like', user: 'lisa_m', name: 'Lisa Martinez', avatar: 'https://i.pravatar.cc/150?img=9', text: 'and 12 others liked your photo', time: '5h ago', image: 'https://picsum.photos/seed/4/400', unread: false },\r\n    { id: 6, type: 'comment', user: 'john_d', name: 'John Davis', avatar: 'https://i.pravatar.cc/150?img=13', text: 'replied to your comment', time: '6h ago', image: 'https://picsum.photos/seed/5/400', unread: false },\r\n    { id: 7, type: 'follow', user: 'kate_b', name: 'Kate Brown', avatar: 'https://i.pravatar.cc/150?img=10', text: 'started following you', time: '8h ago', unread: false },\r\n    { id: 8, type: 'like', user: 'ryan_c', name: 'Ryan Cooper', avatar: 'https://i.pravatar.cc/150?img=14', text: 'liked your shot', time: '12h ago', image: 'https://picsum.photos/seed/6/400', unread: false },\r\n];\r\n\r\nconst NotificationModal: React.FC<NotificationModalProps> = ({ isOpen, onClose }) => {\r\n    const [activeTab, setActiveTab] = useState<'all' | 'likes' | 'comments' | 'follows'>('all');\r\n    const [followingUsers, setFollowingUsers] = useState<Set<number>>(new Set());\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const getIcon = (type: string) => {\r\n        switch (type) {\r\n            case 'like': return <Heart size={18} fill=\"#ed4956\" color=\"#ed4956\" />;\r\n            case 'comment': return <MessageCircle size={18} color=\"var(--primary)\" />;\r\n            case 'follow': return <UserPlus size={18} color=\"#44b700\" />;\r\n            case 'mention': return <AtSign size={18} color=\"var(--primary)\" />;\r\n            default: return <Heart size={18} />;\r\n        }\r\n    };\r\n\r\n    const filteredNotifications = MOCK_NOTIFICATIONS.filter(notif => {\r\n        if (activeTab === 'all') return true;\r\n        if (activeTab === 'likes') return notif.type === 'like';\r\n        if (activeTab === 'comments') return notif.type === 'comment' || notif.type === 'mention';\r\n        if (activeTab === 'follows') return notif.type === 'follow';\r\n        return true;\r\n    });\r\n\r\n    const unreadCount = MOCK_NOTIFICATIONS.filter(n => n.unread).length;\r\n\r\n    const toggleFollow = (userId: number) => {\r\n        setFollowingUsers(prev => {\r\n            const newSet = new Set(prev);\r\n            if (newSet.has(userId)) {\r\n                newSet.delete(userId);\r\n            } else {\r\n                newSet.add(userId);\r\n            }\r\n            return newSet;\r\n        });\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <div className={styles.overlay} onClick={onClose} />\r\n            <div className={`${styles.modal} scale-in`}>\r\n                <div className={styles.header}>\r\n                    <div className={styles.headerLeft}>\r\n                        <h2 className={styles.title}>Notifications</h2>\r\n                        {unreadCount > 0 && (\r\n                            <span className={styles.unreadBadge}>{unreadCount}</span>\r\n                        )}\r\n                    </div>\r\n                    <div className={styles.headerRight}>\r\n                        <button className={styles.settingsBtn}>\r\n                            <Settings size={20} />\r\n                        </button>\r\n                        <button className={styles.closeBtn} onClick={onClose}>\r\n                            <X size={24} />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className={styles.tabs}>\r\n                    <button\r\n                        className={`${styles.tab} ${activeTab === 'all' ? styles.activeTab : ''}`}\r\n                        onClick={() => setActiveTab('all')}\r\n                    >\r\n                        All\r\n                    </button>\r\n                    <button\r\n                        className={`${styles.tab} ${activeTab === 'likes' ? styles.activeTab : ''}`}\r\n                        onClick={() => setActiveTab('likes')}\r\n                    >\r\n                        Likes\r\n                    </button>\r\n                    <button\r\n                        className={`${styles.tab} ${activeTab === 'comments' ? styles.activeTab : ''}`}\r\n                        onClick={() => setActiveTab('comments')}\r\n                    >\r\n                        Comments\r\n                    </button>\r\n                    <button\r\n                        className={`${styles.tab} ${activeTab === 'follows' ? styles.activeTab : ''}`}\r\n                        onClick={() => setActiveTab('follows')}\r\n                    >\r\n                        Follows\r\n                    </button>\r\n                </div>\r\n\r\n                <div className={styles.content}>\r\n                    {filteredNotifications.length > 0 ? (\r\n                        filteredNotifications.map((notif, index) => (\r\n                            <div\r\n                                key={notif.id}\r\n                                className={`${styles.notifItem} ${notif.unread ? styles.unread : ''}`}\r\n                                style={{ animationDelay: `${index * 0.05}s` }}\r\n                            >\r\n                                <div className={styles.notifLeft}>\r\n                                    <div className={styles.avatarWrapper}>\r\n                                        <img src={notif.avatar} alt={notif.user} className={styles.avatar} />\r\n                                        <div className={styles.iconBadge}>\r\n                                            {getIcon(notif.type)}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className={styles.notifContent}>\r\n                                        <p>\r\n                                            <span className={styles.username}>{notif.user}</span> {notif.text}\r\n                                        </p>\r\n                                        <span className={styles.time}>{notif.time}</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className={styles.notifRight}>\r\n                                    {notif.image && (\r\n                                        <img src={notif.image} alt=\"\" className={styles.postThumb} />\r\n                                    )}\r\n                                    {notif.type === 'follow' && (\r\n                                        <button\r\n                                            className={`${styles.followBtn} ${followingUsers.has(notif.id) ? styles.following : ''}`}\r\n                                            onClick={() => toggleFollow(notif.id)}\r\n                                        >\r\n                                            {followingUsers.has(notif.id) ? 'Following' : 'Follow'}\r\n                                        </button>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        ))\r\n                    ) : (\r\n                        <div className={styles.emptyState}>\r\n                            <div className={styles.emptyIcon}>\r\n                                <Heart size={48} />\r\n                            </div>\r\n                            <p className={styles.emptyText}>No notifications yet</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default NotificationModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\NotificationsModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\PageTransition.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[245,248],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[245,248],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { usePathname } from 'next/navigation';\r\nimport { ReactNode } from 'react';\r\n\r\ninterface PageTransitionProps {\r\n    children: ReactNode;\r\n}\r\n\r\nconst pageVariants: any = {\r\n    initial: {\r\n        opacity: 0,\r\n        y: 10,\r\n        scale: 0.99,\r\n    },\r\n    animate: {\r\n        opacity: 1,\r\n        y: 0,\r\n        scale: 1,\r\n        transition: {\r\n            duration: 0.6,\r\n            ease: [0.16, 1, 0.3, 1],\r\n            staggerChildren: 0.1,\r\n        },\r\n    },\r\n    exit: {\r\n        opacity: 0,\r\n        y: -10,\r\n        scale: 0.99,\r\n        transition: {\r\n            duration: 0.4,\r\n            ease: [0.16, 1, 0.3, 1],\r\n        },\r\n    },\r\n};\r\n\r\nexport default function PageTransition({ children }: PageTransitionProps) {\r\n    const pathname = usePathname();\r\n\r\n    return (\r\n        <AnimatePresence mode=\"wait\" initial={false}>\r\n            <motion.div\r\n                key={pathname}\r\n                variants={pageVariants}\r\n                initial=\"initial\"\r\n                animate=\"animate\"\r\n                exit=\"exit\"\r\n                style={{ width: '100%', height: '100%' }}\r\n            >\r\n                {children}\r\n            </motion.div>\r\n        </AnimatePresence>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\Post.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":159,"column":25,"nodeType":"JSXOpeningElement","endLine":159,"endColumn":127},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":191,"column":21,"nodeType":"JSXOpeningElement","endLine":198,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useTransition } from 'react';\r\nimport { Heart, MessageCircle, Send, Bookmark, MoreHorizontal } from 'lucide-react';\r\nimport styles from './Post.module.css';\r\nimport { toggleLike, toggleShotLike, toggleSavedPost, toggleSavedShot, addComment, addShotComment } from '@/app/actions';\r\nimport { formatDistanceToNow } from 'date-fns';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface PostProps {\r\n    id: string;\r\n    type?: 'post' | 'shot';\r\n    user: {\r\n        username: string;\r\n        avatar?: string | null;\r\n    };\r\n    image?: string;\r\n    video?: string;\r\n    likes: number;\r\n    isLiked?: boolean;\r\n    caption: string;\r\n    time: string;\r\n    comments?: Array<{\r\n        id: string;\r\n        text: string;\r\n        user: {\r\n            username: string;\r\n            avatar?: string;\r\n        };\r\n        createdAt: string;\r\n    }>;\r\n}\r\n\r\nconst Post: React.FC<PostProps> = ({ id, type = 'post', user, image, video, likes, isLiked: initialIsLiked, caption, time, comments = [] }) => {\r\n    const [isLiked, setIsLiked] = useState(initialIsLiked || false);\r\n    const [localLikes, setLocalLikes] = useState(likes);\r\n    const [isPending, startTransition] = useTransition();\r\n    const [showHeart, setShowHeart] = useState(false);\r\n    const [isSaved, setIsSaved] = useState(false);\r\n    const [imageLoaded, setImageLoaded] = useState(false);\r\n    const [showComments, setShowComments] = useState(false);\r\n    const [comment, setComment] = useState('');\r\n    const [localComments, setLocalComments] = useState(comments);\r\n    const [captionExpanded, setCaptionExpanded] = useState(false);\r\n    const videoRef = React.useRef<HTMLVideoElement>(null);\r\n\r\n    const handleLike = async () => {\r\n        const newIsLiked = !isLiked;\r\n        setIsLiked(newIsLiked);\r\n        setLocalLikes(prev => newIsLiked ? prev + 1 : prev - 1);\r\n\r\n        if (newIsLiked) {\r\n            setShowHeart(true);\r\n            setTimeout(() => setShowHeart(false), 1000);\r\n        }\r\n\r\n        startTransition(async () => {\r\n            try {\r\n                if (type === 'shot' || video) {\r\n                    await toggleShotLike(id);\r\n                } else {\r\n                    await toggleLike(id);\r\n                }\r\n            } catch (error) {\r\n                setIsLiked(!newIsLiked);\r\n                setLocalLikes(prev => !newIsLiked ? prev + 1 : prev - 1);\r\n                console.error('Failed to toggle like:', error);\r\n            }\r\n        });\r\n    };\r\n\r\n    // Auto-play video on intersect could be added here, but simple controls or autoplay loop is fine for now\r\n\r\n    // ... comment and share handlers ...\r\n\r\n    const handleComment = () => {\r\n        if (comment.trim()) {\r\n            const newComment = {\r\n                id: Date.now().toString(),\r\n                text: comment,\r\n                user: { username: 'You', avatar: '' }, // Optimistic user\r\n                createdAt: new Date().toISOString()\r\n            };\r\n            setLocalComments([...localComments, newComment]);\r\n            setComment('');\r\n\r\n            startTransition(async () => {\r\n                try {\r\n                    if (type === 'shot' || video) {\r\n                        await addShotComment(id, newComment.text);\r\n                    } else {\r\n                        await addComment(id, newComment.text);\r\n                    }\r\n                } catch (error) {\r\n                    console.error('Failed to post comment:', error);\r\n                    // Revert optimistic update\r\n                    setLocalComments(prev => prev.filter(c => c.id !== newComment.id));\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    const handleSave = () => {\r\n        const newIsSaved = !isSaved;\r\n        setIsSaved(newIsSaved);\r\n\r\n        startTransition(async () => {\r\n            try {\r\n                if (type === 'shot' || video) {\r\n                    await toggleSavedShot(id);\r\n                } else {\r\n                    await toggleSavedPost(id);\r\n                }\r\n            } catch (error) {\r\n                setIsSaved(!newIsSaved);\r\n                console.error('Failed to toggle save:', error);\r\n            }\r\n        });\r\n    };\r\n\r\n    const handleShare = () => {\r\n        if (navigator.share) {\r\n            navigator.share({\r\n                title: `Post by ${user.username}`,\r\n                text: caption,\r\n                url: window.location.href,\r\n            }).catch(() => {\r\n                navigator.clipboard.writeText(window.location.href);\r\n                alert('Link copied to clipboard!');\r\n            });\r\n        } else {\r\n            navigator.clipboard.writeText(window.location.href);\r\n            alert('Link copied to clipboard!');\r\n        }\r\n    };\r\n\r\n    const formatLikes = (count: number) => {\r\n        if (count >= 1000000) return `${(count / 1000000).toFixed(1)}M`;\r\n        if (count >= 1000) return `${(count / 1000).toFixed(1)}K`;\r\n        return count.toLocaleString();\r\n    };\r\n\r\n    return (\r\n        <motion.article\r\n            layout\r\n            className={styles.post}\r\n            variants={{\r\n                hidden: { opacity: 0, y: 20 },\r\n                show: { opacity: 1, y: 0, transition: { type: 'spring', stiffness: 300, damping: 24 } }\r\n            }}\r\n            initial=\"hidden\"\r\n            animate=\"show\"\r\n            exit={{ opacity: 0, scale: 0.95, transition: { duration: 0.2 } }}\r\n        >\r\n            {/* Header */}\r\n            <div className={styles.header}>\r\n                <div className={styles.userInfo}>\r\n                    <div className={styles.avatarRing}>\r\n                        <img src={user.avatar || 'https://i.pravatar.cc/150'} alt={user.username} className={styles.avatar} />\r\n                    </div>\r\n                    <div className={styles.userMeta}>\r\n                        <span className={styles.username}>{user.username}</span>\r\n                        <span className={styles.time}>{time}</span>\r\n                    </div>\r\n                </div>\r\n                <button className={styles.moreBtn}>\r\n                    <MoreHorizontal size={20} />\r\n                </button>\r\n            </div>\r\n\r\n            {/* Content (Image or Video) */}\r\n            <div className={styles.imageContainer} onDoubleClick={handleLike}>\r\n                {!imageLoaded && !video && (\r\n                    <div className={`${styles.imageSkeleton} skeleton`}></div>\r\n                )}\r\n\r\n                {video ? (\r\n                    <video\r\n                        ref={videoRef}\r\n                        src={video}\r\n                        className={styles.postImage} // Reusing image class for size\r\n                        controls={false} // Custom controls or double tap\r\n                        autoPlay\r\n                        muted\r\n                        loop\r\n                        playsInline\r\n                        onLoadedData={() => setImageLoaded(true)}\r\n                        style={{ opacity: imageLoaded ? 1 : 0, objectFit: 'cover' }}\r\n                    />\r\n                ) : (\r\n                    <img\r\n                        src={image}\r\n                        alt=\"Post content\"\r\n                        className={`${styles.postImage} ${imageLoaded ? styles.loaded : ''}`}\r\n                        loading=\"lazy\"\r\n                        onLoad={() => setImageLoaded(true)}\r\n                        style={{ opacity: imageLoaded ? 1 : 0 }}\r\n                    />\r\n                )}\r\n\r\n                <AnimatePresence>\r\n                    {showHeart && (\r\n                        <motion.div\r\n                            className={styles.largeHeart}\r\n                            initial={{ scale: 0, opacity: 0 }}\r\n                            animate={{ scale: 1.2, opacity: 1 }}\r\n                            exit={{ scale: 0, opacity: 0 }}\r\n                            transition={{ type: \"spring\", stiffness: 400, damping: 12 }}\r\n                        >\r\n                            <Heart size={80} fill=\"white\" color=\"white\" />\r\n                        </motion.div>\r\n                    )}\r\n                </AnimatePresence>\r\n            </div>\r\n\r\n            {/* Actions */}\r\n            <div className={styles.actions}>\r\n                <div className={styles.leftActions}>\r\n                    <motion.button\r\n                        whileTap={{ scale: 0.75 }}\r\n                        className={`${styles.actionButton} ${isLiked ? styles.liked : ''}`}\r\n                        onClick={handleLike}\r\n                        disabled={isPending}\r\n                    >\r\n                        <Heart size={24} fill={isLiked ? '#ed4956' : 'none'} color={isLiked ? '#ed4956' : 'currentColor'} />\r\n                    </motion.button>\r\n                    <motion.button\r\n                        whileTap={{ scale: 0.75 }}\r\n                        className={styles.actionButton}\r\n                        onClick={() => setShowComments(!showComments)}\r\n                    >\r\n                        <MessageCircle size={24} />\r\n                    </motion.button>\r\n                    <motion.button\r\n                        whileTap={{ scale: 0.75 }}\r\n                        className={styles.actionButton}\r\n                        onClick={handleShare}\r\n                    >\r\n                        <Send size={22} />\r\n                    </motion.button>\r\n                </div>\r\n                <motion.button\r\n                    whileTap={{ scale: 0.75 }}\r\n                    className={`${styles.actionButton} ${isSaved ? styles.saved : ''}`}\r\n                    onClick={handleSave}\r\n                >\r\n                    <Bookmark size={24} fill={isSaved ? 'currentColor' : 'none'} />\r\n                </motion.button>\r\n            </div>\r\n\r\n            {/* Engagement */}\r\n            <div className={styles.engagement}>\r\n                <div className={styles.likes}>{formatLikes(localLikes)} likes</div>\r\n                <div className={styles.caption}>\r\n                    <span className={styles.captionUser}>{user.username}</span>\r\n                    {caption.length > 100 && !captionExpanded ? (\r\n                        <>\r\n                            {caption.substring(0, 100)}...{' '}\r\n                            <button\r\n                                className={styles.moreBtn}\r\n                                onClick={() => setCaptionExpanded(true)}\r\n                            >\r\n                                more\r\n                            </button>\r\n                        </>\r\n                    ) : (\r\n                        caption\r\n                    )}\r\n                </div>\r\n                <button\r\n                    className={styles.viewComments}\r\n                    onClick={() => setShowComments(!showComments)}\r\n                >\r\n                    View all comments\r\n                </button>\r\n            </div>\r\n\r\n            {/* Comment Input */}\r\n            <AnimatePresence>\r\n                {showComments && (\r\n                    <motion.div\r\n                        className={styles.commentSection}\r\n                        initial={{ height: 0, opacity: 0 }}\r\n                        animate={{ height: 'auto', opacity: 1 }}\r\n                        exit={{ height: 0, opacity: 0 }}\r\n                        transition={{ duration: 0.3 }}\r\n                    >\r\n                        {localComments && localComments.length > 0 && (\r\n                            <div className={styles.commentList}>\r\n                                {localComments.map((c) => (\r\n                                    <div key={c.id} className={styles.comment}>\r\n                                        <div className={styles.commentContent}>\r\n                                            <div>\r\n                                                <span className={styles.commentUser}>{c.user.username}</span>\r\n                                                <span className={styles.commentText}>{c.text}</span>\r\n                                            </div>\r\n                                            <span className={styles.commentTime}>\r\n                                                {formatDistanceToNow(new Date(c.createdAt), { addSuffix: true })}\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                        <div className={styles.commentInput}>\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Add a comment...\"\r\n                                value={comment}\r\n                                onChange={(e) => setComment(e.target.value)}\r\n                                onKeyPress={(e) => e.key === 'Enter' && handleComment()}\r\n                                className={styles.input}\r\n                            />\r\n                            {comment.trim() && (\r\n                                <motion.button\r\n                                    initial={{ scale: 0 }}\r\n                                    animate={{ scale: 1 }}\r\n                                    className={styles.postBtn}\r\n                                    onClick={handleComment}\r\n                                >\r\n                                    Post\r\n                                </motion.button>\r\n                            )}\r\n                        </div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n        </motion.article>\r\n    );\r\n};\r\n\r\nexport default Post;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\PostDetailModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AnimatePresence' is defined but never used.","line":7,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AnimatePresence"},"fix":{"range":[262,279],"text":""},"desc":"Remove unused variable \"AnimatePresence\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":51,"column":21,"nodeType":"JSXOpeningElement","endLine":51,"endColumn":93},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":58,"column":29,"nodeType":"JSXOpeningElement","endLine":58,"endColumn":110},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":69,"column":29,"nodeType":"JSXOpeningElement","endLine":69,"endColumn":110},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":82,"column":29,"nodeType":"JSXOpeningElement","endLine":82,"endColumn":110},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":96,"column":29,"nodeType":"JSXOpeningElement","endLine":96,"endColumn":110}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { X, Heart, MessageCircle, Send, Bookmark, MoreHorizontal, Smile } from 'lucide-react';\r\nimport styles from './PostDetailModal.module.css';\r\nimport { Post } from '@/lib/mockData';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface PostDetailModalProps {\r\n    post: Post;\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nconst PostDetailModal: React.FC<PostDetailModalProps> = ({ post, isOpen, onClose }) => {\r\n    const [comment, setComment] = useState('');\r\n    const [isLiked, setIsLiked] = useState(post.isLiked);\r\n    const [likesCount, setLikesCount] = useState(post.likes);\r\n    const [isSaved, setIsSaved] = useState(post.isSaved);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const handleLike = () => {\r\n        setIsLiked(!isLiked);\r\n        setLikesCount(prev => !isLiked ? prev + 1 : prev - 1);\r\n    };\r\n\r\n    const handlePostComment = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!comment.trim()) return;\r\n        // In a real app, send to API\r\n        setComment('');\r\n    };\r\n\r\n    return (\r\n        <div className={styles.overlay} onClick={onClose}>\r\n            <button className={styles.closeBtn} onClick={onClose}>\r\n                <X size={32} />\r\n            </button>\r\n\r\n            <motion.div\r\n                className={styles.modal}\r\n                onClick={e => e.stopPropagation()}\r\n                initial={{ opacity: 0, scale: 0.9 }}\r\n                animate={{ opacity: 1, scale: 1 }}\r\n                exit={{ opacity: 0, scale: 0.9 }}\r\n                transition={{ type: \"spring\", stiffness: 300, damping: 25 }}\r\n            >\r\n                {/* Media Section */}\r\n                <div className={styles.mediaSection} onDoubleClick={handleLike}>\r\n                    <img src={post.image} alt={post.caption} className={styles.mainMedia} />\r\n                </div>\r\n\r\n                {/* Info Section */}\r\n                <div className={styles.infoSection}>\r\n                    <div className={styles.header}>\r\n                        <div className={styles.userInfo}>\r\n                            <img src={post.user.avatar} alt={post.user.username} className={styles.avatar} />\r\n                            <span className={styles.username}>{post.user.username}</span>\r\n                        </div>\r\n                        <button className={styles.actionBtn}>\r\n                            <MoreHorizontal size={20} />\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className={styles.commentsSection}>\r\n                        {/* Caption as first comment */}\r\n                        <div className={styles.commentItem}>\r\n                            <img src={post.user.avatar} alt={post.user.username} className={styles.avatar} />\r\n                            <div className={styles.commentContent}>\r\n                                <div className={styles.commentText}>\r\n                                    <span className={styles.username}>{post.user.username}</span> {post.caption}\r\n                                </div>\r\n                                <div className={styles.commentMeta}>\r\n                                    <span>{new Date(post.createdAt).toLocaleDateString()}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Mock comments */}\r\n                        <div className={styles.commentItem}>\r\n                            <img src=\"https://i.pravatar.cc/150?u=10\" className={styles.avatar} alt=\"User\" />\r\n                            <div className={styles.commentContent}>\r\n                                <div className={styles.commentText}>\r\n                                    <span className={styles.username}>awesome_user</span> This is such a cool shot! Love the colors. ≡ƒöÑ\r\n                                </div>\r\n                                <div className={styles.commentMeta}>\r\n                                    <span>2h</span>\r\n                                    <span>5 likes</span>\r\n                                    <span>Reply</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className={styles.commentItem}>\r\n                            <img src=\"https://i.pravatar.cc/150?u=11\" className={styles.avatar} alt=\"User\" />\r\n                            <div className={styles.commentContent}>\r\n                                <div className={styles.commentText}>\r\n                                    <span className={styles.username}>photography_fan</span> Which camera did you use for this?\r\n                                </div>\r\n                                <div className={styles.commentMeta}>\r\n                                    <span>1h</span>\r\n                                    <span>2 likes</span>\r\n                                    <span>Reply</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Actions Row */}\r\n                    <div className={styles.actions}>\r\n                        <div className={styles.actionRow}>\r\n                            <div className={styles.leftActions}>\r\n                                <button className={styles.actionBtn} onClick={handleLike}>\r\n                                    <Heart size={24} fill={isLiked ? \"#ed4956\" : \"none\"} color={isLiked ? \"#ed4956\" : \"currentColor\"} />\r\n                                </button>\r\n                                <button className={styles.actionBtn}>\r\n                                    <MessageCircle size={24} />\r\n                                </button>\r\n                                <button className={styles.actionBtn}>\r\n                                    <Send size={24} />\r\n                                </button>\r\n                            </div>\r\n                            <button className={styles.actionBtn} onClick={() => setIsSaved(!isSaved)}>\r\n                                <Bookmark size={24} fill={isSaved ? \"currentColor\" : \"none\"} />\r\n                            </button>\r\n                        </div>\r\n                        <div className={styles.likes}>\r\n                            {likesCount.toLocaleString()} likes\r\n                        </div>\r\n                        <div className={styles.time}>\r\n                            {new Date(post.createdAt).toDateString()}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Input Section */}\r\n                    <form className={styles.inputSection} onSubmit={handlePostComment}>\r\n                        <Smile size={24} className={styles.emojiBtn} />\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Add a comment...\"\r\n                            className={styles.input}\r\n                            value={comment}\r\n                            onChange={(e) => setComment(e.target.value)}\r\n                        />\r\n                        <button\r\n                            type=\"submit\"\r\n                            className={styles.postBtn}\r\n                            disabled={!comment.trim()}\r\n                        >\r\n                            Post\r\n                        </button>\r\n                    </form>\r\n                </div>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PostDetailModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\PrivacyModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Lock' is defined but never used.","line":2,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":25,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Lock"},"fix":{"range":[60,66],"text":""},"desc":"Remove unused variable \"Lock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used.","line":2,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":30,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Eye"},"fix":{"range":[66,71],"text":""},"desc":"Remove unused variable \"Eye\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EyeOff' is defined but never used.","line":2,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":38,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"EyeOff"},"fix":{"range":[71,79],"text":""},"desc":"Remove unused variable \"EyeOff\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MessageSquare' is defined but never used.","line":2,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":64,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"MessageSquare"},"fix":{"range":[90,105],"text":""},"desc":"Remove unused variable \"MessageSquare\"."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":58,"column":50,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[2800,2895],"text":"\r\n                                    Show when you&apos;re active\r\n                                "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[2800,2895],"text":"\r\n                                    Show when you&lsquo;re active\r\n                                "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[2800,2895],"text":"\r\n                                    Show when you&#39;re active\r\n                                "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[2800,2895],"text":"\r\n                                    Show when you&rsquo;re active\r\n                                "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { X, Shield, Lock, Eye, EyeOff, UserCheck, MessageSquare, Download, ChevronRight } from 'lucide-react';\r\nimport styles from './PrivacyModal.module.css';\r\n\r\ninterface PrivacyModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nconst PrivacyModal: React.FC<PrivacyModalProps> = ({ isOpen, onClose }) => {\r\n    const [privateAccount, setPrivateAccount] = useState(false);\r\n    const [activityStatus, setActivityStatus] = useState(true);\r\n    const [storySharing, setStorySharing] = useState(true);\r\n    const [allowMessages, setAllowMessages] = useState(true);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className={styles.overlay} onClick={onClose}>\r\n            <div className={styles.modal} onClick={e => e.stopPropagation()}>\r\n                <div className={styles.header}>\r\n                    <div className={styles.title}>\r\n                        <Shield size={20} />\r\n                        <h2>Privacy Settings</h2>\r\n                    </div>\r\n                    <button className={styles.closeBtn} onClick={onClose}>\r\n                        <X size={24} />\r\n                    </button>\r\n                </div>\r\n\r\n                <div className={styles.content}>\r\n                    <div className={styles.section}>\r\n                        <h3 className={styles.sectionTitle}>Account Privacy</h3>\r\n                        <div className={styles.settingItem}>\r\n                            <div className={styles.settingInfo}>\r\n                                <div className={styles.settingLabel}>Private Account</div>\r\n                                <div className={styles.settingDescription}>\r\n                                    When your account is private, only people you approve can see your photos and videos\r\n                                </div>\r\n                            </div>\r\n                            <div\r\n                                className={`${styles.toggle} ${privateAccount ? styles.active : ''}`}\r\n                                onClick={() => setPrivateAccount(!privateAccount)}\r\n                            >\r\n                                <div className={styles.toggleKnob}></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className={styles.separator} />\r\n\r\n                    <div className={styles.section}>\r\n                        <h3 className={styles.sectionTitle}>Activity</h3>\r\n                        <div className={styles.settingItem}>\r\n                            <div className={styles.settingInfo}>\r\n                                <div className={styles.settingLabel}>Activity Status</div>\r\n                                <div className={styles.settingDescription}>\r\n                                    Show when you're active\r\n                                </div>\r\n                            </div>\r\n                            <div\r\n                                className={`${styles.toggle} ${activityStatus ? styles.active : ''}`}\r\n                                onClick={() => setActivityStatus(!activityStatus)}\r\n                            >\r\n                                <div className={styles.toggleKnob}></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className={styles.separator} />\r\n\r\n                    <div className={styles.section}>\r\n                        <h3 className={styles.sectionTitle}>Sharing</h3>\r\n                        <div className={styles.settingItem}>\r\n                            <div className={styles.settingInfo}>\r\n                                <div className={styles.settingLabel}>Story Sharing</div>\r\n                                <div className={styles.settingDescription}>\r\n                                    Allow others to share your story as messages\r\n                                </div>\r\n                            </div>\r\n                            <div\r\n                                className={`${styles.toggle} ${storySharing ? styles.active : ''}`}\r\n                                onClick={() => setStorySharing(!storySharing)}\r\n                            >\r\n                                <div className={styles.toggleKnob}></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className={styles.separator} />\r\n\r\n                    <div className={styles.section}>\r\n                        <h3 className={styles.sectionTitle}>Messages</h3>\r\n                        <div className={styles.settingItem}>\r\n                            <div className={styles.settingInfo}>\r\n                                <div className={styles.settingLabel}>Allow Messages</div>\r\n                                <div className={styles.settingDescription}>\r\n                                    Let people send you messages\r\n                                </div>\r\n                            </div>\r\n                            <div\r\n                                className={`${styles.toggle} ${allowMessages ? styles.active : ''}`}\r\n                                onClick={() => setAllowMessages(!allowMessages)}\r\n                            >\r\n                                <div className={styles.toggleKnob}></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className={styles.separator} />\r\n\r\n                    <div className={styles.section}>\r\n                        <h3 className={styles.sectionTitle}>Data & History</h3>\r\n                        <button className={styles.menuItem}>\r\n                            <div className={styles.menuItemRow}>\r\n                                <UserCheck size={18} />\r\n                                <span>Blocked Accounts</span>\r\n                            </div>\r\n                            <ChevronRight size={16} color=\"var(--foreground-muted)\" />\r\n                        </button>\r\n                        <button className={styles.menuItem}>\r\n                            <div className={styles.menuItemRow}>\r\n                                <Download size={18} />\r\n                                <span>Download Your Data</span>\r\n                            </div>\r\n                            <ChevronRight size={16} color=\"var(--foreground-muted)\" />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PrivacyModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\RightSidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[303,306],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[303,306],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[367,370],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[367,370],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1063,1066],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1063,1066],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'currentUser?.id'. Either include it or remove the dependency array. You can also replace multiple useState variables with useReducer if 'setSuggestions' needs the current value of 'currentUser.id'.","line":35,"column":8,"nodeType":"ArrayExpression","endLine":35,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [currentUser?.id]","fix":{"range":[1281,1283],"text":"[currentUser?.id]"}}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":44,"column":21,"nodeType":"JSXOpeningElement","endLine":48,"endColumn":23},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":69,"column":33,"nodeType":"JSXOpeningElement","endLine":73,"endColumn":35},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":91,"column":21,"nodeType":"JSXOpeningElement","endLine":95,"endColumn":23},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":96,"column":21,"nodeType":"JSXOpeningElement","endLine":100,"endColumn":23}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React from 'react';\r\nimport Link from 'next/link';\r\n// import { MOCK_USERS } from '@/lib/mockData';\r\nimport styles from './RightSidebar.module.css';\r\nimport { useState, useEffect } from 'react';\r\n\r\nconst RightSidebar = () => {\r\n    const [currentUser, setCurrentUser] = useState<any>(null);\r\n    const [suggestions, setSuggestions] = useState<any[]>([]);\r\n\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            try {\r\n                // Fetch Me\r\n                const meRes = await fetch('/api/users/me');\r\n                if (meRes.ok) {\r\n                    const meData = await meRes.json();\r\n                    setCurrentUser(meData);\r\n                }\r\n\r\n                // Fetch Suggestions (all users for now, filter out me)\r\n                const usersRes = await fetch('/api/users');\r\n                if (usersRes.ok) {\r\n                    const allUsers = await usersRes.json();\r\n                    // Simple logic: take first 5 that are not me\r\n                    setSuggestions(allUsers.filter((u: any) => u.id !== currentUser?.id).slice(0, 5));\r\n                }\r\n            } catch (err) {\r\n                console.error('RightSidebar fetch error', err);\r\n            }\r\n        };\r\n        fetchData();\r\n    }, []);\r\n\r\n    if (!currentUser) return null; // Or a skeleton\r\n\r\n    return (\r\n        <aside className={styles.rightSidebar}>\r\n            {/* Current User */}\r\n            <div className={styles.userProfile}>\r\n                <Link href=\"/profile\" className={styles.userInfo}>\r\n                    <img\r\n                        src={currentUser.avatar || \"https://i.pravatar.cc/150\"}\r\n                        alt={currentUser.username}\r\n                        className={styles.avatar}\r\n                    />\r\n                    <div className={styles.userDetails}>\r\n                        <div className={styles.username}>{currentUser.username}</div>\r\n                        <div className={styles.fullName}>{currentUser.fullName || currentUser.username}</div>\r\n                    </div>\r\n                </Link>\r\n                <button className={styles.switchBtn}>Switch</button>\r\n            </div>\r\n\r\n            {/* Suggestions Header */}\r\n            <div className={styles.suggestionsHeader}>\r\n                <div className={styles.suggestionsTitle}>Suggested for you</div>\r\n                <button className={styles.seeAllBtn}>See All</button>\r\n            </div>\r\n\r\n            {/* Suggestions List */}\r\n            <div className={styles.suggestionsList}>\r\n                {suggestions.map((user) => (\r\n                    <div key={user.id} className={styles.suggestionItem}>\r\n                        <div className={styles.suggestionUserInfo}>\r\n                            <Link href={`/${user.username}`}>\r\n                                <img\r\n                                    src={user.avatar || `https://i.pravatar.cc/150?u=${user.username}`}\r\n                                    alt={user.username}\r\n                                    className={styles.suggestionAvatar}\r\n                                />\r\n                            </Link>\r\n                            <div className={styles.suggestionDetails}>\r\n                                <Link href={`/${user.username}`} className={styles.suggestionUsername}>\r\n                                    {user.username}\r\n                                </Link>\r\n                                <div className={styles.suggestionMeta}>Suggested for you</div>\r\n                            </div>\r\n                        </div>\r\n                        <button className={styles.followBtn}>Follow</button>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* App Stores */}\r\n            <div className={styles.appStoreSection}>\r\n                <div className={styles.appStoreTitle}>Get the App</div>\r\n                <div className={styles.storeButtons}>\r\n                    <img\r\n                        src=\"https://upload.wikimedia.org/wikipedia/commons/3/3c/Download_on_the_App_Store_Badge.svg\"\r\n                        alt=\"Download on the App Store\"\r\n                        className={styles.storeBadge}\r\n                    />\r\n                    <img\r\n                        src=\"https://upload.wikimedia.org/wikipedia/commons/7/78/Google_Play_Store_badge_EN.svg\"\r\n                        alt=\"Get it on Google Play\"\r\n                        className={styles.storeBadge}\r\n                    />\r\n                </div>\r\n            </div>\r\n\r\n\r\n            {/* Tech Stack Info */}\r\n            <div className={styles.techInfo}>\r\n                <span className={styles.techLabel}>Databases</span>\r\n                PostgreSQL is used as the primary relational database for structured data like user profiles and comments, while Cassandra is used for highly distributed data like activity logs and analytics.\r\n            </div>\r\n\r\n        </aside>\r\n    );\r\n};\r\n\r\nexport default RightSidebar;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\SecurityModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\SettingsModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":42,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1536,1539],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1536,1539],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { X, Settings, Shield, Bell, Key, LogOut, ChevronRight, Moon, Sun, User } from 'lucide-react';\r\nimport styles from './SettingsModal.module.css';\r\nimport { useTheme } from '@/contexts/ThemeContext';\r\nimport PrivacyModal from './PrivacyModal';\r\nimport NotificationsModal from './NotificationsModal';\r\nimport SecurityModal from './SecurityModal';\r\nimport EditProfileModal from './EditProfileModal';\r\nimport { MOCK_USERS } from '@/lib/mockData';\r\n\r\ninterface SettingsModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onProfileUpdate?: (data: { username: string; fullName: string; bio: string; avatar: string }) => void;\r\n}\r\n\r\nconst SettingsModal: React.FC<SettingsModalProps> = ({ isOpen, onClose, onProfileUpdate }) => {\r\n    const { theme, toggleTheme } = useTheme();\r\n    const [isPrivacyOpen, setIsPrivacyOpen] = useState(false);\r\n    const [isNotificationsOpen, setIsNotificationsOpen] = useState(false);\r\n    const [isSecurityOpen, setIsSecurityOpen] = useState(false);\r\n    const [isEditProfileOpen, setIsEditProfileOpen] = useState(false);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const handlePrivacyClick = () => {\r\n        setIsPrivacyOpen(true);\r\n    };\r\n\r\n    const handleNotificationsClick = () => {\r\n        setIsNotificationsOpen(true);\r\n    };\r\n\r\n    const handleSecurityClick = () => {\r\n        setIsSecurityOpen(true);\r\n    };\r\n\r\n    const handleEditProfileClick = () => {\r\n        setIsEditProfileOpen(true);\r\n    };\r\n\r\n    const handleSaveProfile = (data: any) => {\r\n        if (onProfileUpdate) {\r\n            onProfileUpdate(data);\r\n        }\r\n        setIsEditProfileOpen(false);\r\n    };\r\n\r\n    const sections = [\r\n        {\r\n            title: 'Account',\r\n            items: [\r\n                { icon: User, label: 'Edit Profile', action: handleEditProfileClick },\r\n                { icon: Key, label: 'Password and Security', action: handleSecurityClick },\r\n                { icon: Bell, label: 'Notifications', action: handleNotificationsClick },\r\n            ]\r\n        },\r\n        {\r\n            title: 'Preferences',\r\n            items: [\r\n                {\r\n                    icon: theme === 'dark' ? Moon : Sun,\r\n                    label: 'Appearance',\r\n                    action: toggleTheme,\r\n                    value: theme === 'dark' ? 'Dark' : 'Light'\r\n                },\r\n                { icon: Shield, label: 'Privacy', action: handlePrivacyClick },\r\n            ]\r\n        }\r\n    ];\r\n\r\n    return (\r\n        <>\r\n            <div className={styles.overlay} onClick={onClose}>\r\n                <div className={styles.modal} onClick={e => e.stopPropagation()}>\r\n                    <div className={styles.header}>\r\n                        <div className={styles.title}>\r\n                            <Settings size={20} />\r\n                            <h2>Settings</h2>\r\n                        </div>\r\n                        <button className={styles.closeBtn} onClick={onClose}>\r\n                            <X size={24} />\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div style={{ paddingBottom: '16px' }}>\r\n                        {sections.map((section, idx) => (\r\n                            <div key={idx} className={styles.section}>\r\n                                <h3 className={styles.sectionTitle}>{section.title}</h3>\r\n                                {section.items.map((item, i) => (\r\n                                    <button key={i} className={styles.menuItem} onClick={item.action}>\r\n                                        <div className={styles.menuItemRow}>\r\n                                            <item.icon size={18} />\r\n                                            <span>{item.label}</span>\r\n                                        </div>\r\n                                        <div className={styles.menuItemRow}>\r\n                                            {item.value && <span style={{ color: 'var(--foreground-muted)', fontSize: '13px' }}>{item.value}</span>}\r\n                                            <ChevronRight size={16} color=\"var(--foreground-muted)\" />\r\n                                        </div>\r\n                                    </button>\r\n                                ))}\r\n                                {idx < sections.length - 1 && <div className={styles.separator} />}\r\n                            </div>\r\n                        ))}\r\n\r\n                        <div className={styles.separator} />\r\n\r\n                        <button className={`${styles.menuItem} ${styles.danger}`}>\r\n                            <div className={styles.menuItemRow}>\r\n                                <LogOut size={18} />\r\n                                <span>Log Out</span>\r\n                            </div>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <PrivacyModal\r\n                isOpen={isPrivacyOpen}\r\n                onClose={() => setIsPrivacyOpen(false)}\r\n            />\r\n\r\n            <NotificationsModal\r\n                isOpen={isNotificationsOpen}\r\n                onClose={() => setIsNotificationsOpen(false)}\r\n            />\r\n\r\n            <SecurityModal\r\n                isOpen={isSecurityOpen}\r\n                onClose={() => setIsSecurityOpen(false)}\r\n            />\r\n\r\n            <EditProfileModal\r\n                isOpen={isEditProfileOpen}\r\n                onClose={() => setIsEditProfileOpen(false)}\r\n                initialData={{\r\n                    username: MOCK_USERS[0].username,\r\n                    fullName: 'Aster Viewer',\r\n                    bio: MOCK_USERS[0].bio || '',\r\n                    avatar: MOCK_USERS[0].avatar\r\n                }}\r\n                onSave={handleSaveProfile}\r\n            />\r\n        </>\r\n    );\r\n};\r\n\r\nexport default SettingsModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\Sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\StoryBar.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[347,350],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[347,350],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[415,418],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[415,418],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[896,899],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[896,899],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[926,929],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[926,929],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":67,"column":25,"nodeType":"JSXOpeningElement","endLine":67,"endColumn":112},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":86,"column":29,"nodeType":"JSXOpeningElement","endLine":86,"endColumn":112}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport styles from './StoryBar.module.css';\r\nimport { Plus } from 'lucide-react';\r\n// import { MOCK_STORIES } from '@/lib/mockData';\r\nimport StoryViewer from './StoryViewer';\r\n\r\nconst StoryBar = () => {\r\n    const [stories, setStories] = useState<any[]>([]);\r\n    const [viewerStories, setViewerStories] = useState<any[]>([]);\r\n    const [selectedStoryIndex, setSelectedStoryIndex] = useState<number | null>(null);\r\n\r\n    React.useEffect(() => {\r\n        const fetchStories = async () => {\r\n            try {\r\n                const res = await fetch('/api/stories');\r\n                const data = await res.json();\r\n                if (Array.isArray(data)) {\r\n                    setStories(data);\r\n                    // Flatten for viewer\r\n                    const flat = data.flatMap((group: any) => group.stories.map((s: any) => ({ ...s, user: group.user })));\r\n                    setViewerStories(flat);\r\n                }\r\n            } catch (err) {\r\n                console.error('Failed to fetch stories', err);\r\n            }\r\n        };\r\n        fetchStories();\r\n    }, []);\r\n\r\n    const handleStoryClick = (userIndex: number) => {\r\n        // Find the index in the flat list where this user's stories start\r\n        if (!stories[userIndex]) return;\r\n        const firstStoryId = stories[userIndex].stories[0]?.id;\r\n        const flatIndex = viewerStories.findIndex(s => s.id === firstStoryId);\r\n        setSelectedStoryIndex(flatIndex >= 0 ? flatIndex : 0);\r\n    };\r\n\r\n    const containerVariants = {\r\n        hidden: { opacity: 0 },\r\n        show: {\r\n            opacity: 1,\r\n            transition: {\r\n                staggerChildren: 0.05\r\n            }\r\n        }\r\n    };\r\n\r\n    const itemVariants = {\r\n        hidden: { opacity: 0, x: -10 },\r\n        show: { opacity: 1, x: 0 }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <motion.div\r\n                className={styles.storyBar}\r\n                variants={containerVariants}\r\n                initial=\"hidden\"\r\n                animate=\"show\"\r\n            >\r\n                {/* Your Story */}\r\n                <motion.div className={styles.storyContainer} variants={itemVariants}>\r\n                    <div className={`${styles.storyCircle} ${styles.yourStory}`}>\r\n                        <img src=\"https://i.pravatar.cc/150?u=me\" alt=\"Your story\" className={styles.avatar} />\r\n                        <div className={styles.plusBadge}>\r\n                            <Plus size={12} strokeWidth={3} />\r\n                        </div>\r\n                    </div>\r\n                    <span className={styles.username}>Your story</span>\r\n                </motion.div>\r\n\r\n                {stories.map((group, index) => (\r\n                    <motion.div\r\n                        key={group.user.username}\r\n                        className={styles.storyContainer}\r\n                        variants={itemVariants}\r\n                        onClick={() => handleStoryClick(index)}\r\n                        whileHover={{ scale: 1.05 }}\r\n                        whileTap={{ scale: 0.95 }}\r\n                    >\r\n                        {/* Check if any story in group is unseen, for now assume all fresh */}\r\n                        <div className={`${styles.storyCircle} ${styles.hasNew}`}>\r\n                            <img src={group.user.avatar} alt={group.user.username} className={styles.avatar} />\r\n                        </div>\r\n                        <span className={styles.username}>{group.user.username}</span>\r\n                    </motion.div>\r\n                ))}\r\n            </motion.div>\r\n\r\n            {selectedStoryIndex !== null && viewerStories.length > 0 && (\r\n                <StoryViewer\r\n                    stories={viewerStories}\r\n                    initialStoryIndex={selectedStoryIndex}\r\n                    isOpen={selectedStoryIndex !== null}\r\n                    onClose={() => setSelectedStoryIndex(null)}\r\n                />\r\n            )}\r\n        </>\r\n    );\r\n};\r\n\r\nexport default StoryBar;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\StoryViewer.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":94,"column":25,"nodeType":"JSXOpeningElement","endLine":94,"endColumn":122}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { X, ChevronLeft, ChevronRight, Heart, Send, MoreHorizontal } from 'lucide-react';\r\nimport styles from './StoryViewer.module.css';\r\nimport { Story } from '@/lib/mockData';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\ninterface StoryViewerProps {\r\n    stories: Story[];\r\n    initialStoryIndex: number;\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nconst StoryViewer: React.FC<StoryViewerProps> = ({ stories, initialStoryIndex, isOpen, onClose }) => {\r\n    const [storyIndex, setStoryIndex] = useState(initialStoryIndex);\r\n    const [slideIndex, setSlideIndex] = useState(0);\r\n    const [progress, setProgress] = useState(0);\r\n\r\n    const currentStory = stories[storyIndex];\r\n    const currentSlide = currentStory.slides[slideIndex];\r\n\r\n    const nextSlide = useCallback(() => {\r\n        if (slideIndex < currentStory.slides.length - 1) {\r\n            setSlideIndex(slideIndex + 1);\r\n            setProgress(0);\r\n        } else if (storyIndex < stories.length - 1) {\r\n            setStoryIndex(storyIndex + 1);\r\n            setSlideIndex(0);\r\n            setProgress(0);\r\n        } else {\r\n            onClose();\r\n        }\r\n    }, [slideIndex, currentStory.slides.length, storyIndex, stories.length, onClose]);\r\n\r\n    const prevSlide = useCallback(() => {\r\n        if (slideIndex > 0) {\r\n            setSlideIndex(slideIndex - 1);\r\n            setProgress(0);\r\n        } else if (storyIndex > 0) {\r\n            setStoryIndex(storyIndex - 1);\r\n            setSlideIndex(stories[storyIndex - 1].slides.length - 1);\r\n            setProgress(0);\r\n        }\r\n    }, [slideIndex, storyIndex, stories]);\r\n\r\n    useEffect(() => {\r\n        if (!isOpen) return;\r\n\r\n        const duration = 5000; // 5 seconds per slide\r\n        const interval = 50; // Update progress every 50ms\r\n        const step = (interval / duration) * 100;\r\n\r\n        const timer = setInterval(() => {\r\n            setProgress(prev => {\r\n                if (prev >= 100) {\r\n                    nextSlide();\r\n                    return 0;\r\n                }\r\n                return prev + step;\r\n            });\r\n        }, interval);\r\n\r\n        return () => clearInterval(timer);\r\n    }, [isOpen, slideIndex, storyIndex, nextSlide]);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className={styles.overlay} onClick={onClose}>\r\n            <button className={styles.closeBtn} onClick={onClose}>\r\n                <X size={28} />\r\n            </button>\r\n\r\n            <div className={styles.viewerContainer} onClick={e => e.stopPropagation()}>\r\n                {/* Progress Bars */}\r\n                <div className={styles.progressContainer}>\r\n                    {currentStory.slides.map((_, idx) => (\r\n                        <div key={idx} className={styles.progressBar}>\r\n                            <div\r\n                                className={styles.progressFill}\r\n                                style={{\r\n                                    width: idx < slideIndex ? '100%' : idx === slideIndex ? `${progress}%` : '0%'\r\n                                }}\r\n                            />\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Header */}\r\n                <div className={styles.header}>\r\n                    <div className={styles.userInfo}>\r\n                        <img src={currentStory.user.avatar} alt={currentStory.user.username} className={styles.avatar} />\r\n                        <span className={styles.username}>{currentStory.user.username}</span>\r\n                        <span className={styles.time}>{currentSlide.time}</span>\r\n                    </div>\r\n                    <button className={styles.actionBtn}>\r\n                        <MoreHorizontal size={20} />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className={styles.storyContent}>\r\n                    <AnimatePresence mode=\"wait\">\r\n                        <motion.img\r\n                            key={currentSlide.id}\r\n                            src={currentSlide.image}\r\n                            alt=\"\"\r\n                            className={styles.storyImage}\r\n                            initial={{ opacity: 0, scale: 1.1 }}\r\n                            animate={{ opacity: 1, scale: 1 }}\r\n                            exit={{ opacity: 0, scale: 0.9 }}\r\n                            transition={{ duration: 0.3 }}\r\n                        />\r\n                    </AnimatePresence>\r\n\r\n                    {/* Nav Buttons */}\r\n                    {(storyIndex > 0 || slideIndex > 0) && (\r\n                        <button className={`${styles.navBtn} ${styles.prevBtn}`} onClick={prevSlide}>\r\n                            <ChevronLeft size={24} />\r\n                        </button>\r\n                    )}\r\n                    <button className={`${styles.navBtn} ${styles.nextBtn}`} onClick={nextSlide}>\r\n                        <ChevronRight size={24} />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Controls */}\r\n                <div className={styles.controls}>\r\n                    <input type=\"text\" placeholder={`Reply to ${currentStory.user.username}...`} className={styles.replyInput} />\r\n                    <button className={styles.actionBtn}>\r\n                        <Heart size={24} />\r\n                    </button>\r\n                    <button className={styles.actionBtn}>\r\n                        <Send size={24} />\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default StoryViewer;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\SuggestionsSidebar.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":25,"column":21,"nodeType":"JSXOpeningElement","endLine":25,"endColumn":80},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":51,"column":29,"nodeType":"JSXOpeningElement","endLine":51,"endColumn":74}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React from 'react';\r\nimport styles from './SuggestionsSidebar.module.css';\r\nimport { MOCK_USERS } from '@/lib/mockData';\r\nimport { motion } from 'framer-motion';\r\n\r\nconst SuggestionsSidebar = () => {\r\n    // Current user (mock)\r\n    const currentUser = MOCK_USERS[0];\r\n\r\n    // Suggest some users (excluding current)\r\n    const suggestions = MOCK_USERS.slice(1, 6);\r\n\r\n    return (\r\n        <motion.aside\r\n            className={styles.sidebar}\r\n            initial={{ opacity: 0, x: 20 }}\r\n            animate={{ opacity: 1, x: 0 }}\r\n            transition={{ duration: 0.8, ease: [0.16, 1, 0.3, 1] }}\r\n        >\r\n            {/* User Profile Snippet */}\r\n            <div className={styles.profileSection}>\r\n                <div className={styles.userAvatar}>\r\n                    <img src={currentUser.avatar} alt={currentUser.username} />\r\n                </div>\r\n                <div className={styles.userInfo}>\r\n                    <span className={styles.username}>{currentUser.username}</span>\r\n                    <span className={styles.fullName}>{currentUser.name}</span>\r\n                </div>\r\n                <button className={styles.switchBtn}>Switch</button>\r\n            </div>\r\n\r\n            {/* Suggestions Header */}\r\n            <div className={styles.suggestionsHeader}>\r\n                <span className={styles.headerTitle}>Suggested for you</span>\r\n                <button className={styles.seeAllBtn}>See All</button>\r\n            </div>\r\n\r\n            {/* Suggestions List */}\r\n            <div className={styles.suggestionsList}>\r\n                {suggestions.map((user, index) => (\r\n                    <motion.div\r\n                        key={user.id}\r\n                        className={styles.suggestionItem}\r\n                        initial={{ opacity: 0, x: 10 }}\r\n                        animate={{ opacity: 1, x: 0 }}\r\n                        transition={{ delay: index * 0.1 }}\r\n                    >\r\n                        <div className={styles.suggestionAvatar}>\r\n                            <img src={user.avatar} alt={user.username} />\r\n                        </div>\r\n                        <div className={styles.suggestionInfo}>\r\n                            <span className={styles.suggestionUsername}>{user.username}</span>\r\n                            <span className={styles.suggestionFollowedBy}>Suggested for you</span>\r\n                        </div>\r\n                        <button className={styles.followBtn}>Follow</button>\r\n                    </motion.div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Footer Links */}\r\n            <footer className={styles.footer}>\r\n                <nav className={styles.footerLinks}>\r\n                    <a href=\"#\">About</a>\r\n                    <a href=\"#\">Help</a>\r\n                    <a href=\"#\">Press</a>\r\n                    <a href=\"#\">API</a>\r\n                    <a href=\"#\">Jobs</a>\r\n                    <a href=\"#\">Privacy</a>\r\n                    <a href=\"#\">Terms</a>\r\n                    <a href=\"#\">Locations</a>\r\n                    <a href=\"#\">Language</a>\r\n                    <a href=\"#\">Meta Verified</a>\r\n                </nav>\r\n                <p className={styles.copyright}>┬⌐ 2026 VIEWER BY ASTER. <a href=\"/LICENSE\" className={styles.licenseLink}>MIT Licensed</a></p>\r\n            </footer>\r\n        </motion.aside>\r\n    );\r\n};\r\n\r\nexport default SuggestionsSidebar;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\components\\TopHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\contexts\\ThemeContext.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\contexts\\ThemeContext.tsx:23:13\n  21 |         const savedTheme = localStorage.getItem('theme') as Theme | null;\n  22 |         if (savedTheme) {\n> 23 |             setThemeState(savedTheme);\n     |             ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  24 |         }\n  25 |         setMounted(true);\n  26 |     }, []);","line":23,"column":13,"nodeType":null,"endLine":23,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { createContext, useContext, useEffect, useState } from 'react';\r\n\r\ntype Theme = 'dark' | 'light';\r\n\r\ninterface ThemeContextType {\r\n    theme: Theme;\r\n    toggleTheme: () => void;\r\n    setTheme: (theme: Theme) => void;\r\n}\r\n\r\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\r\n\r\nexport const ThemeProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const [theme, setThemeState] = useState<Theme>('dark');\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        // Get saved theme from localStorage or default to dark\r\n        const savedTheme = localStorage.getItem('theme') as Theme | null;\r\n        if (savedTheme) {\r\n            setThemeState(savedTheme);\r\n        }\r\n        setMounted(true);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (!mounted) return;\r\n\r\n        // Apply theme to document\r\n        if (theme === 'light') {\r\n            document.documentElement.setAttribute('data-theme', 'light');\r\n        } else {\r\n            document.documentElement.removeAttribute('data-theme');\r\n        }\r\n\r\n        // Save to localStorage\r\n        localStorage.setItem('theme', theme);\r\n    }, [theme, mounted]);\r\n\r\n    const toggleTheme = () => {\r\n        setThemeState(prev => prev === 'dark' ? 'light' : 'dark');\r\n    };\r\n\r\n    const setTheme = (newTheme: Theme) => {\r\n        setThemeState(newTheme);\r\n    };\r\n\r\n    return (\r\n        <ThemeContext.Provider value={{ theme, toggleTheme, setTheme }}>\r\n            {children}\r\n        </ThemeContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useTheme = () => {\r\n    const context = useContext(ThemeContext);\r\n    if (context === undefined) {\r\n        throw new Error('useTheme must be used within a ThemeProvider');\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\lib\\cassandra.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[742,745],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[742,745],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Client, auth } from 'cassandra-driver';\r\n\r\nconst CASSANDRA_CONTACT_POINTS = (process.env.CASSANDRA_CONTACT_POINTS || 'localhost').split(',');\r\nconst CASSANDRA_LOCAL_DATACENTER = process.env.CASSANDRA_LOCAL_DATACENTER || 'datacenter1';\r\nconst CASSANDRA_KEYSPACE = process.env.CASSANDRA_KEYSPACE || 'viewer_feed';\r\nconst CASSANDRA_USERNAME = process.env.CASSANDRA_USERNAME;\r\nconst CASSANDRA_PASSWORD = process.env.CASSANDRA_PASSWORD;\r\n\r\nlet client: Client | null = null;\r\nlet isConnected = false;\r\n\r\nexport function getCassandraClient() {\r\n    if (!client) {\r\n        // Only create client if credentials or contact points are explicitly provided\r\n        // Use a flag or check if we are in environment to run\r\n        const options: any = {\r\n            contactPoints: CASSANDRA_CONTACT_POINTS,\r\n            localDataCenter: CASSANDRA_LOCAL_DATACENTER,\r\n            keyspace: CASSANDRA_KEYSPACE,\r\n        };\r\n\r\n        if (CASSANDRA_USERNAME && CASSANDRA_PASSWORD) {\r\n            options.authProvider = new auth.PlainTextAuthProvider(CASSANDRA_USERNAME, CASSANDRA_PASSWORD);\r\n        }\r\n\r\n        // Add cloud config support (e.g. for Astra DB) if secure connect bundle provided\r\n        if (process.env.CASSANDRA_SCB_PATH) {\r\n            options.cloud = { secureConnectBundle: process.env.CASSANDRA_SCB_PATH };\r\n        }\r\n\r\n        client = new Client(options);\r\n    }\r\n    return client;\r\n}\r\n\r\nexport async function initCassandra() {\r\n    const client = getCassandraClient();\r\n    try {\r\n        await client.connect();\r\n        isConnected = true;\r\n        console.log('Connected to Cassandra');\r\n\r\n        // Define Keyspace if not using Cloud/Astra\r\n        if (!process.env.CASSANDRA_SCB_PATH) {\r\n            await client.execute(`\r\n                CREATE KEYSPACE IF NOT EXISTS ${CASSANDRA_KEYSPACE} \r\n                WITH replication = {'class': 'SimpleStrategy', 'replication_factor': '1' }\r\n            `);\r\n        }\r\n\r\n        // Define Tables for massive scale feed storage\r\n\r\n        // table: posts_by_user (for user profile feed)\r\n        // Partition Key: user_id (all posts for a user together)\r\n        // Clustering Key: created_at (sorted by time)\r\n        await client.execute(`\r\n            CREATE TABLE IF NOT EXISTS ${CASSANDRA_KEYSPACE}.posts_by_user (\r\n                user_id text,\r\n                post_id timeuuid,\r\n                caption text,\r\n                image_url text,\r\n                location text,\r\n                created_at timestamp,\r\n                likes_count counter,\r\n                comments_count counter,\r\n                PRIMARY KEY (user_id, created_at)\r\n            ) WITH CLUSTERING ORDER BY (created_at DESC);\r\n        `);\r\n\r\n        // table: news_feed (pre-computed feed for users)\r\n        // Partition Key: user_id (the user viewing the feed)\r\n        // Clustering Key: created_at (sorted by time)\r\n        await client.execute(`\r\n            CREATE TABLE IF NOT EXISTS ${CASSANDRA_KEYSPACE}.news_feed (\r\n                user_id text,\r\n                post_id timeuuid,\r\n                author_id text,\r\n                caption text,\r\n                image_url text,\r\n                created_at timestamp,\r\n                PRIMARY KEY (user_id, created_at)\r\n            ) WITH CLUSTERING ORDER BY (created_at DESC);\r\n        `);\r\n\r\n        // table: activity_metrics (for logging huge amounts of events)\r\n        // Partition Key: user_id\r\n        // Clustering Key: timestamp\r\n        await client.execute(`\r\n            CREATE TABLE IF NOT EXISTS ${CASSANDRA_KEYSPACE}.activity_metrics (\r\n                user_id text,\r\n                event_type text,\r\n                metadata text,\r\n                timestamp timestamp,\r\n                PRIMARY KEY (user_id, timestamp)\r\n            ) WITH CLUSTERING ORDER BY (timestamp DESC);\r\n        `);\r\n\r\n        console.log('Cassandra Schema Initialized');\r\n    } catch (err) {\r\n        console.error('Failed to initialize Cassandra:', err);\r\n        isConnected = false;\r\n    }\r\n}\r\n\r\nexport const isCassandraConnected = () => isConnected;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\lib\\feed-service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[662,665],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[662,665],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":45,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":45,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1444,1447],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1444,1447],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2042,2045],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2042,2045],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'results' is assigned a value but never used.","line":70,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":70,"endColumn":30},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":110,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4501,4504],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4501,4504],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":121,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4937,4940],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4937,4940],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":150,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6101,6104],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6101,6104],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import prisma from '@/lib/prisma';\r\nimport { getCassandraClient } from '@/lib/cassandra';\r\nimport { getOrSet } from '@/lib/redis';\r\n\r\nexport type FeedItem = {\r\n    id: string;\r\n    type: 'post' | 'shot';\r\n    caption: string | null;\r\n    image: string; // or video for shots\r\n    createdAt: Date;\r\n    user: {\r\n        username: string;\r\n        avatar: string | null;\r\n        fullName: string | null;\r\n    };\r\n    likesCount: number;\r\n    commentsCount: number;\r\n    isLiked?: boolean;\r\n    // ... other props\r\n};\r\n\r\nexport const FeedService = {\r\n    // Public: Get Feed (Cached or Fresh)\r\n    async generateFeed(userId: string, page = 1, limit = 20): Promise<any[]> {\r\n        const cacheKey = `feed:user:${userId}`;\r\n\r\n        // Cache the first page for 60 seconds (Simulated Pre-computation)\r\n        if (page === 1) {\r\n            const cached = await getOrSet(cacheKey, async () => {\r\n                return await FeedService._generateRun(userId, page, limit);\r\n            }, 60);\r\n            return cached;\r\n        }\r\n\r\n        return await FeedService._generateRun(userId, page, limit);\r\n    },\r\n\r\n    // Public: Trigger Pre-computation (e.g. from Cron)\r\n    async precomputeFeed(userId: string) {\r\n        await FeedService.generateFeed(userId, 1, 20); // Warms the cache\r\n        return { success: true };\r\n    },\r\n\r\n    // Internal: Actual generation logic\r\n    async _generateRun(userId: string, page = 1, limit = 20): Promise<any[]> {\r\n        const offset = (page - 1) * limit;\r\n\r\n        // 1. Get User's Social Graph (Who they follow)\r\n        const currentUser = await prisma.user.findUnique({\r\n            where: { id: userId },\r\n            include: { following: true }\r\n        });\r\n\r\n        if (!currentUser) return [];\r\n\r\n        const followingIds = currentUser.following.map(f => f.followingId);\r\n        const userIdsToFetch = [...followingIds, userId]; // Include self\r\n\r\n        // 2. Fetch Personal Content (Following + Self)\r\n        // Try Cassandra first for scalable timeline\r\n        let personalPosts: any[] = [];\r\n        const cassandra = getCassandraClient();\r\n\r\n        if (process.env.CASSANDRA_CONTACT_POINTS && cassandra) {\r\n            try {\r\n                // Simplified scatter-gather query\r\n                // In production, we'd use a dedicated timeline table pre-written on fanout\r\n                const query = `SELECT * FROM ${process.env.CASSANDRA_KEYSPACE || 'viewer_feed'}.posts_by_user WHERE user_id = ? LIMIT 20`;\r\n                const promises = userIdsToFetch.map(uid => cassandra.execute(query, [uid], { prepare: true }));\r\n                const results = await Promise.all(promises);\r\n\r\n                // Map Cassandra rows ... (simplified for this reliable service implementation)\r\n                // If this complex mapping is needed, we'd put it here.\r\n                // For simplicity/reliability in this edit, let's stick to the high-level flow and fallback to Prisma if complex.\r\n                // But let's assume we want the Prisma path for rich relations unless Cassandra is fully set up.\r\n            } catch (e) {\r\n                console.warn(\"Cassandra fetch failed\", e);\r\n            }\r\n        }\r\n\r\n        // Fallback/Default: Postgres (Prisma)\r\n        if (personalPosts.length === 0) {\r\n            personalPosts = await prisma.post.findMany({\r\n                where: { userId: { in: userIdsToFetch } },\r\n                include: {\r\n                    user: { select: { username: true, avatar: true, fullName: true } },\r\n                    likes: true,\r\n                    comments: { include: { user: { select: { username: true } } } },\r\n                },\r\n                orderBy: { createdAt: 'desc' },\r\n                take: 50 // Fetch recent pool\r\n            });\r\n        }\r\n\r\n        // 3. Fetch Suggested Content (Cached \"Global Hot\" Pool)\r\n        const suggestedPool = await getOrSet('feed:suggested_pool:v1', async () => {\r\n            return await prisma.post.findMany({\r\n                include: {\r\n                    user: { select: { username: true, avatar: true, fullName: true } },\r\n                    likes: true,\r\n                    comments: { include: { user: { select: { username: true } } } },\r\n                },\r\n                orderBy: { createdAt: 'desc' }, // Recent first\r\n                take: 100\r\n            });\r\n        }, 300); // 5 mins cache\r\n\r\n        // Filter suggested (remove followed users)\r\n        const suggestedPosts = suggestedPool\r\n            .filter((p: any) => !userIdsToFetch.includes(p.userId))\r\n            .slice(0, 20); // Take top 20 candidates\r\n\r\n        // 4. Ranking & Interleaving\r\n        const allContent = [...personalPosts, ...suggestedPosts];\r\n\r\n        // Remove duplicates\r\n        const uniqueContent = Array.from(new Map(allContent.map(p => [p.id, p])).values());\r\n\r\n        // Score Function\r\n        const now = new Date().getTime();\r\n        const scoreItem = (item: any) => {\r\n            const created = new Date(item.createdAt).getTime();\r\n            const hoursAgo = Math.max(0.1, (now - created) / (1000 * 60 * 60));\r\n\r\n            // Engagement\r\n            const likes = item.likes ? item.likes.length : 0;\r\n            const comments = item.comments ? item.comments.length : 0;\r\n            const engagement = likes + (comments * 2);\r\n\r\n            // Gravity Decay\r\n            // (Engagement + 1) / (Time + 2)^1.8\r\n            const score = (engagement + 1) / Math.pow(hoursAgo + 2, 1.8);\r\n\r\n            // Relationship Boost (1.5x for following)\r\n            const isFollowing = userIdsToFetch.includes(item.userId);\r\n            return score * (isFollowing ? 1.5 : 1.0);\r\n        };\r\n\r\n        // Sort by Score\r\n        const rankedFeed = uniqueContent.sort((a, b) => scoreItem(b) - scoreItem(a));\r\n\r\n        // Pagination\r\n        const pagedFeed = rankedFeed.slice(offset, offset + limit);\r\n\r\n        return pagedFeed.map(p => ({\r\n            ...p,\r\n            type: 'post',\r\n            likesCount: p.likes?.length || 0,\r\n            commentsCount: p.comments?.length || 0,\r\n            isLiked: p.likes?.some((l: any) => l.userId === userId)\r\n        }));\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\lib\\media-service.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\lib\\mockData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\lib\\prisma.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\lib\\queue.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[156,159],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[156,159],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[182,185],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[182,185],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[534,537],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[534,537],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":37,"column":79,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":82,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1081,1084],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1081,1084],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import amqp from 'amqplib';\r\n\r\nconst QUEUE_NAME = 'notifications';\r\nconst RABBITMQ_URL = process.env.RABBITMQ_URL || 'amqp://localhost';\r\n\r\nlet connection: any = null;\r\nlet channel: any = null;\r\n\r\nexport async function getChannel() {\r\n    if (channel) return channel;\r\n\r\n    try {\r\n        connection = await amqp.connect(RABBITMQ_URL);\r\n        channel = await connection.createChannel();\r\n        await channel.assertQueue(QUEUE_NAME, { durable: true });\r\n\r\n        // Handle connection errors\r\n        connection.on('error', (err: any) => {\r\n            console.error('RabbitMQ connection error', err);\r\n            channel = null;\r\n            connection = null;\r\n        });\r\n\r\n        connection.on('close', () => {\r\n            console.warn('RabbitMQ connection closed');\r\n            channel = null;\r\n            connection = null;\r\n        });\r\n\r\n        return channel;\r\n    } catch (error) {\r\n        console.error('Failed to connect to RabbitMQ:', error);\r\n        return null;\r\n    }\r\n}\r\n\r\nexport async function sendNotification(userId: string, type: string, payload: any) {\r\n    try {\r\n        const ch = await getChannel();\r\n        if (!ch) {\r\n            console.warn('RabbitMQ channel not available, skipping notification');\r\n            return;\r\n        }\r\n\r\n        const message = JSON.stringify({\r\n            userId,\r\n            type,\r\n            payload,\r\n            timestamp: new Date().toISOString()\r\n        });\r\n\r\n        ch.sendToQueue(QUEUE_NAME, Buffer.from(message), {\r\n            persistent: true\r\n        });\r\n\r\n        console.log(`Notification sent: ${type} for user ${userId}`);\r\n    } catch (error) {\r\n        console.error('Failed to send notification:', error);\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\lib\\redis.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\lib\\s3.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GetObjectCommand' is defined but never used.","line":1,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":54,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"GetObjectCommand"},"fix":{"range":[35,53],"text":""},"desc":"Remove unused variable \"GetObjectCommand\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { S3Client, PutObjectCommand, GetObjectCommand } from '@aws-sdk/client-s3';\r\nimport { getSignedUrl } from '@aws-sdk/s3-request-presigner';\r\n\r\nconst s3Client = new S3Client({\r\n    region: process.env.AWS_REGION || 'us-east-1',\r\n    credentials: {\r\n        accessKeyId: process.env.AWS_ACCESS_KEY_ID || '',\r\n        secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY || '',\r\n    },\r\n});\r\n\r\nconst BUCKET_NAME = process.env.AWS_S3_BUCKET_NAME || 'viewer-media';\r\n\r\n// Upload file to S3 and return the public URL\r\nexport async function uploadToS3(fileBuffer: Buffer, fileName: string, contentType: string): Promise<string> {\r\n    const key = `uploads/${Date.now()}-${fileName}`;\r\n\r\n    // Check if credentials exist, otherwise fallback or error\r\n    if (!process.env.AWS_ACCESS_KEY_ID || !process.env.AWS_SECRET_ACCESS_KEY) {\r\n        console.warn('AWS Credentials missing, cannot upload to S3.');\r\n        return '';\r\n    }\r\n\r\n    try {\r\n        const command = new PutObjectCommand({\r\n            Bucket: BUCKET_NAME,\r\n            Key: key,\r\n            Body: fileBuffer,\r\n            ContentType: contentType,\r\n            // ACL: 'public-read', // Deprecated in many new buckets, use Bucket Policy instead strictly\r\n        });\r\n\r\n        await s3Client.send(command);\r\n\r\n        // Return the CDN URL if configured, otherwise the standard S3 URL\r\n        if (process.env.CDN_DOMAIN) {\r\n            const cdnDomain = process.env.CDN_DOMAIN.replace(/\\/$/, ''); // Remove trailing slash\r\n            return `${cdnDomain}/${key}`;\r\n        }\r\n\r\n        return `https://${BUCKET_NAME}.s3.${process.env.AWS_REGION}.amazonaws.com/${key}`;\r\n    } catch (error) {\r\n        console.error('S3 Upload Error:', error);\r\n        throw new Error('Failed to upload file to S3');\r\n    }\r\n}\r\n\r\n// Generate a presigned URL for client-side uploads (Alternative strategy)\r\nexport async function getPresignedUploadUrl(fileName: string, contentType: string) {\r\n    const key = `uploads/${Date.now()}-${fileName}`;\r\n    const command = new PutObjectCommand({\r\n        Bucket: BUCKET_NAME,\r\n        Key: key,\r\n        ContentType: contentType,\r\n    });\r\n\r\n    const url = await getSignedUrl(s3Client, command, { expiresIn: 3600 });\r\n    return { url, key };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\lib\\user-service.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Follows' is defined but never used.","line":2,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":23,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Follows"},"fix":{"range":[49,58],"text":""},"desc":"Remove unused variable \"Follows\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'password' is assigned a value but never used.","line":95,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":95,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'id' is assigned a value but never used.","line":95,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":95,"endColumn":29},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2812,2815],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2812,2815],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import prisma from '@/lib/prisma';\r\nimport { User, Follows } from '@prisma/client';\r\n\r\n// Define clear types for User Service responses\r\nexport type UserProfile = {\r\n    id: string;\r\n    username: string;\r\n    fullName: string | null;\r\n    avatar: string | null;\r\n    bio: string | null;\r\n    website: string | null;\r\n    isVerified: boolean;\r\n    followersCount: number;\r\n    followingCount: number;\r\n    isFollowing?: boolean;\r\n};\r\n\r\n\r\nexport const UserService = {\r\n\r\n    // 1. Get Profile by Username\r\n    async getProfile(username: string, currentUserId?: string): Promise<UserProfile | null> {\r\n        const user = await prisma.user.findUnique({\r\n            where: { username },\r\n            include: {\r\n                _count: {\r\n                    select: {\r\n                        followedBy: true,\r\n                        following: true,\r\n                    }\r\n                },\r\n                followedBy: currentUserId ? {\r\n                    where: { followerId: currentUserId }\r\n                } : false\r\n            }\r\n        });\r\n\r\n        if (!user) return null;\r\n\r\n        return {\r\n            id: user.id,\r\n            username: user.username,\r\n            fullName: user.fullName,\r\n            avatar: user.avatar,\r\n            bio: user.bio,\r\n            website: user.website,\r\n            isVerified: user.isVerified,\r\n            followersCount: user._count.followedBy,\r\n            followingCount: user._count.following,\r\n            isFollowing: currentUserId ? user.followedBy.length > 0 : false\r\n        };\r\n    },\r\n\r\n    // 2. Follow User\r\n    async followUser(followerId: string, targetuserId: string) {\r\n        if (followerId === targetuserId) throw new Error(\"Cannot follow yourself\");\r\n\r\n        // Check if already following\r\n        const existing = await prisma.follows.findFirst({\r\n            where: {\r\n                followerId,\r\n                followingId: targetuserId\r\n            }\r\n        });\r\n\r\n        if (existing) return existing;\r\n\r\n        return await prisma.follows.create({\r\n            data: {\r\n                followerId,\r\n                followingId: targetuserId\r\n            }\r\n        });\r\n    },\r\n\r\n    // 3. Unfollow User\r\n    async unfollowUser(followerId: string, targetuserId: string) {\r\n        const existing = await prisma.follows.findFirst({\r\n            where: {\r\n                followerId,\r\n                followingId: targetuserId\r\n            }\r\n        });\r\n\r\n        if (!existing) return null;\r\n\r\n        return await prisma.follows.delete({\r\n            where: { id: existing.id }\r\n        });\r\n    },\r\n\r\n    // 4. Update Profile\r\n    async updateProfile(userId: string, data: Partial<User>) {\r\n        // Prevent sensitive updates here if needed (e.g. password)\r\n        const { password, id, ...safeData } = data as any;\r\n\r\n        return await prisma.user.update({\r\n            where: { id: userId },\r\n            data: safeData\r\n        });\r\n    },\r\n\r\n    // 5. Get Following List\r\n    async getFollowing(userId: string) {\r\n        return await prisma.follows.findMany({\r\n            where: { followerId: userId },\r\n            include: {\r\n                following: {\r\n                    select: {\r\n                        id: true,\r\n                        username: true,\r\n                        avatar: true,\r\n                        fullName: true\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\aster\\OneDrive\\Documents\\GitHub\\viewer-social\\src\\types\\css-modules.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
